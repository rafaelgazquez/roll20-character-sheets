<!-- Worker Scripts -->
<script type="text/worker">
	// The first time the sheet is opened, run all functions that calculate fields in case of any changes or updates
	on('sheet:opened', function() {
		calcAttributePointsSpent();
		calcEvasion();
		calcToughness();
		calcResolve();
		calcHitPoints();
		calcXPchanges();
		calcHeavy();
		calcBulky();
		calcSpeed();
		calcAgility();
		calcFortitude();
		calcMight();
		calcDeception();
		calcPresence();
		calcPersuasion();
		calcLearning();
		calcLogic();
		calcPerception();
		calcWill();
		calcAlteration();
		calcCreation();
		calcEnergy();
		calcEntropy();
		calcInfluence();
		calcMovement();
		calcPrescience();
		calcProtection();
		calcAllActionRolls();
	});

    // Function to determine dice number :: takes in the attribute score :: outputs the dice number
    function calcAttributeDiceNumber(value) {
        if(value*1 === 0 || value*1 <= 0) { return 0;
        } else if (value*1 === 1 || value*1 === 2 || value*1 === 3 || value*1 === 4) {  return 1;
        } else if (value*1 === 5 || value*1 === 6 || value*1 === 7) {  return 2;
        } else if (value*1 === 8 || value*1 === 9) {  return 3;
        } else if (value*1 >= 10) {  return 4;
        }
    };
    
    // Function to determine dice type :: takes in the attribute score :: outputs the dice type
    function calcAttributeDiceType(value) {
        if(value*1 === 0 || value*1 <= 0) { return "";
        } else if (value*1 === 1) {  return "d4!!";
        } else if (value*1 === 2 || value*1 === 5) {  return "d6!!";
        } else if (value*1 === 3 || value*1 === 6 || value*1 === 8 || value*1 >= 10) {  return "d8!!";
        } else if (value*1 === 4 || value*1 === 7 || value*1 === 9) {  return "d10!!";
        }
    };
    
    // Function to calculate total cost of attributes based on numbers put in, to be called by each attriburte on change
    function calcAttributePointsSpent() {
        getAttrs(["agility_cost", "fortitude_cost", "might_cost", "deception_cost", "presence_cost", "persuasion_cost", "learning_cost", "logic_cost", "perception_cost", "will_cost", "alteration_cost", "creation_cost", "energy_cost", "entropy_cost", "influence_cost", "movement_cost", "prescience_cost", "protection_cost"], function(values) {
            setAttrs({
                "attribute_points_spent": values.agility_cost*1 + values.fortitude_cost*1 + values.might_cost*1 + values.deception_cost*1 + values.presence_cost*1 + values.persuasion_cost*1 + values.learning_cost*1 + values.logic_cost*1 + values.perception_cost*1 + values.will_cost*1 + values.alteration_cost*1 + values.creation_cost*1 + values.energy_cost*1 + values.entropy_cost*1 + values.influence_cost*1 + values.movement_cost*1 + values.prescience_cost*1 + values.protection_cost*1
            });
        });
    };
    
    // Anytime Armor, Shield, Evasion_other, toughness_other changed, update toughness and evasion
    on("change:armor change:shield change:evasion_other change:toughness_other change:agility_substitution change:fortitude_substitution change:might_substitution", function() {
        calcEvasion();
        calcToughness();
    });
	
	// Function for determining Substitution Values
	function calcSubstitutionScore(subPrimary, subSecondary) {
        getAttrs(["might_score", "agility_score", "fortitude_score", "learning_score", "logic_score", "perception_score", "will_score", "deception_score", "persuasion_score", "presence_score", "alteration_score", "creation_score", "energy_score", "entropy_score", "influence_score", "movement_score", "prescience_score", "protection_score"], function(values) {
			var score = -1;
			var sub = "show";
			switch(subPrimary) {
				case 'Agility':
					score = values.agility_score*1;
					break;
				case 'Fortitude':
					score = values.fortitude_score*1;
					break;
				case 'Might':
					score = values.might_score*1;
					break;
				case 'Learning':
					score = values.learning_score*1;
					break;
				case 'Logic':
					score = values.logic_score*1;
					break;
				case 'Perception':
					score = values.perception_score*1;
					break;
				case 'Will':
					score = values.will_score*1;
					break;
				case 'Deception':
					score = values.deception_score*1;
					break;
				case 'Persuasion':
					score = values.persuasion_score*1;
					break;
				case 'Presence':
					score = values.presence_score*1;
					break;
				case 'Alteration':
					score = values.alteration_score*1;
					break;
				case 'Creation':
					score = values.creation_score*1;
					break;
				case 'Energy':
					score = values.energy_score*1;
					break;
				case 'Entropy':
					score = values.entropy_score*1;
					break;
				case 'Influence':
					score = values.influence_score*1;
					break;
				case 'Movement':
					score = values.movement_score*1;
					break;
				case 'Prescience':
					score = values.prescience_score*1;
					break;
				case 'Protection':
					score = values.protection_score*1;
					break;
				case 'None':
					score = -1;
					break;
				default:
					score = -1;
					break;
			}
			if(score < 0) {
				score = 0;
				sub = "hide"
			}
			switch(subSecondary) {
				case 'Agility':
					setAttrs({
						"agility_substitution": score*1,
						"agility_display_sub_flag": sub
					});
					calcAgility();
					calcOthers();
					break;
				case 'Fortitude':
					setAttrs({
						"fortitude_substitution": score*1,
						"fortitude_display_sub_flag": sub
					});
					calcFortitude();
					calcOthers();
					break;
				case 'Might':
					setAttrs({
						"might_substitution": score*1,
						"might_display_sub_flag": sub
					});
					calcMight();
					calcOthers();
					break;
				case 'Learning':
					setAttrs({
						"learning_substitution": score*1,
						"learning_display_sub_flag": sub
					});
					calcLearning();
					calcOthers();
					break;
				case 'Logic':
					setAttrs({
						"logic_substitution": score*1,
						"logic_display_sub_flag": sub
					});
					calcLogic();
					calcOthers();
					break;
				case 'Perception':
					setAttrs({
						"perception_substitution": score*1,
						"perception_display_sub_flag": sub
					});
					calcPerception();
					calcOthers();
					break;
				case 'Will':
					setAttrs({
						"will_substitution": score*1,
						"will_display_sub_flag": sub
					});
					calcWill();
					calcOthers();
					break;
				case 'Deception':
					setAttrs({
						"deception_substitution": score*1,
						"deception_display_sub_flag": sub
					});
					calcDeception();
					calcOthers();
					break;
				case 'Persuasion':
					setAttrs({
						"persuasion_substitution": score*1,
						"persuasion_display_sub_flag": sub
					});
					calcPersuasion();
					calcOthers();
					break;
				case 'Presence':
					setAttrs({
						"presence_substitution": score*1,
						"presence_display_sub_flag": sub
					});
					calcPresence();
					calcOthers();
					break;
				case 'Alteration':
					setAttrs({
						"alteration_substitution": score*1,
						"alteration_display_sub_flag": sub
					});
					calcAlteration();
					calcOthers();
					break;
				case 'Creation':
					setAttrs({
						"creation_substitution": score*1,
						"creation_display_sub_flag": sub
					});
					calcCreation();
					calcOthers();
					break;
				case 'Energy':
					setAttrs({
						"energy_substitution": score*1,
						"energy_display_sub_flag": sub
					});
					calcEnergy();
					calcOthers();
					break;
				case 'Entropy':
					setAttrs({
						"entropy_substitution": score*1,
						"entropy_display_sub_flag": sub
					});
					calcEntropy();
					calcOthers();
					break;
				case 'Influence':
					setAttrs({
						"influence_substitution": score*1,
						"influence_display_sub_flag": sub
					});
					calcInfluence();
					calcOthers();
					break;
				case 'Movement':
					setAttrs({
						"movement_substitution": score*1,
						"movement_display_sub_flag": sub
					});
					calcMovement();
					calcOthers();
					break;
				case 'Prescience':
					setAttrs({
						"prescience_substitution": score*1,
						"prescience_display_sub_flag": sub
					});
					calcPrescience();
					calcOthers();
					break;
				case 'Protection':
					setAttrs({
						"protection_substitution": score*1,
						"protection_display_sub_flag": sub
					});
					calcProtection();
					calcOthers();
					break;
				default:
					break;
			}
        });		
	};

    // Anytime Agility Substitution is selected
    on("change:agility_substitution_select", function() {
        calcAgilitySub();
    });
    // Function for Agility Substitution is selected
    function calcAgilitySub() {
        getAttrs(["agility_substitution_select"], function(values) {
            calcSubstitutionScore(values.agility_substitution_select, "Agility");
        });
        calcAgility();
    };

    // Anytime Fortitude Substitution is selected
    on("change:fortitude_substitution_select", function() {
        calcFortitudeSub();
    });
    // Anytime Fortitude Substitution is selected
    function calcFortitudeSub() {
        getAttrs(["fortitude_substitution_select"], function(values) {
            calcSubstitutionScore(values.fortitude_substitution_select, "Fortitude");
        });
        calcFortitude();
    };

    // Anytime Might Substitution is selected
    on("change:might_substitution_select", function() {
        calcMightSub();
    });
    // Anytime Might Substitution is selected
    function calcMightSub() {
        getAttrs(["might_substitution_select"], function(values) {
            calcSubstitutionScore(values.might_substitution_select, "Might");
        });
        calcMight();
    };

    // Anytime Deception Substitution is selected
    on("change:deception_substitution_select", function() {
        calcDeceptionSub();
    });
    // Anytime Deception Substitution is selected
    function calcDeceptionSub() {
        getAttrs(["deception_substitution_select"], function(values) {
            calcSubstitutionScore(values.deception_substitution_select, "Deception");
        });
        calcDeception();
    };

    // Anytime Presence Substitution is selected
    on("change:presence_substitution_select", function() {
        calcPresenceSub();
    });
    // Anytime Presence Substitution is selected
    function calcPresenceSub() {
        getAttrs(["presence_substitution_select"], function(values) {
            calcSubstitutionScore(values.presence_substitution_select, "Presence");
        });
        calcPresence();
    };

    // Anytime Persuasion Substitution is selected
    on("changepersuasiont_substitution_select", function() {
        calcPersuasionSub();
    });
    // Anytime Persuasion Substitution is selected
    function calcPersuasionSub() {
        getAttrs(["persuasion_substitution_select"], function(values) {
            calcSubstitutionScore(values.persuasion_substitution_select, "Persuasion");
        });
        calcPersuasion();
    };

    // Anytime Learning Substitution is selected
    on("change:learning_substitution_select", function() {
        calcLearningSub();
    });
    // Anytime Learning Substitution is selected
    function calcLearningSub() {
        getAttrs(["learning_substitution_select"], function(values) {
            calcSubstitutionScore(values.learning_substitution_select, "Learning");
        });
        calcLearning();
    };

    // Anytime Logic Substitution is selected
    on("change:logic_substitution_select", function() {
        calcLogicSub();
    });
    // Anytime Logic Substitution is selected
    function calcLogicSub() {
        getAttrs(["logic_substitution_select"], function(values) {
            calcSubstitutionScore(values.logic_substitution_select, "Logic");
        });
        calcLogic();
    };

    // Anytime Perception Substitution is selected
    on("change:perception_substitution_select", function() {
        calcPerceptionSub();
    });
    // Anytime Perception Substitution is selected
    function calcPerceptionSub() {
        getAttrs(["perception_substitution_select"], function(values) {
            calcSubstitutionScore(values.perception_substitution_select, "Perception");
        });
        calcPerception();
    };

    // Anytime Will Substitution is selected
    on("change:will_substitution_select", function() {
        calcWillSub();
    });
    // Anytime Will Substitution is selected
    function calcWillSub() {
        getAttrs(["will_substitution_select"], function(values) {
            calcSubstitutionScore(values.will_substitution_select, "Will");
        });
        calcWill();
    };

    // Anytime Alteration Substitution is selected
    on("change:alteration_substitution_select", function() {
        calcAlterationSub();
    });
    // Anytime Alteration Substitution is selected
    function calcAlterationSub() {
        getAttrs(["alteration_substitution_select"], function(values) {
            calcSubstitutionScore(values.alteration_substitution_select, "Alteration");
        });
        calcAlteration();
    };

    // Anytime Creation Substitution is selected
    on("change:creation_substitution_select", function() {
        calcCreationSub();
    });
    // Anytime Creation Substitution is selected
    function calcCreationSub() {
        getAttrs(["creation_substitution_select"], function(values) {
            calcSubstitutionScore(values.creation_substitution_select, "Creation");
        });
        calcCreation();
    };

    // Anytime Energy Substitution is selected
    on("change:energy_substitution_select", function() {
        calcEnergySub();
    });
    // Anytime Energy Substitution is selected
    function calcEnergySub() {
        getAttrs(["energy_substitution_select"], function(values) {
            calcSubstitutionScore(values.energy_substitution_select, "Energy");
        });
        calcEnergy();
    };

    // Anytime Entropy Substitution is selected
    on("change:entropy_substitution_select", function() {
        calcEntropySub();
    });
    // Anytime Entropy Substitution is selected
    function calcEntropySub() {
        getAttrs(["entropy_substitution_select"], function(values) {
            calcSubstitutionScore(values.entropy_substitution_select, "Entropy");
        });
        calcEntropy();
    };

    // Anytime Influence Substitution is selected
    on("change:influence_substitution_select", function() {
        calcInfluenceSub();
    });
    // Anytime Influence Substitution is selected
    function calcInfluenceSub() {
        getAttrs(["influence_substitution_select"], function(values) {
            calcSubstitutionScore(values.influence_substitution_select, "Influence");
        });
        calcInfluence();
    };

    // Anytime Movement Substitution is selected
    on("change:movement_substitution_select", function() {
        calcMovementSub();
    });
    // Anytime Movement Substitution is selected
    function calcMovementSub() {
        getAttrs(["movement_substitution_select"], function(values) {
            calcSubstitutionScore(values.movement_substitution_select, "Movement");
        });
        calcMovement();
    };

    // Anytime Prescience Substitution is selected
    on("change:prescience_substitution_select", function() {
        calcPrescienceSub();
    });
    // Anytime Prescience Substitution is selected
    function calcPrescienceSub() {
        getAttrs(["prescience_substitution_select"], function(values) {
            calcSubstitutionScore(values.prescience_substitution_select, "Prescience");
        });
        calcPrescience();
    };

    // Anytime Protection Substitution is selected
    on("change:protection_substitution_select", function() {
        calcProtectionSub();
    });
    // Anytime Protection Substitution is selected
    function calcProtectionSub() {
        getAttrs(["protection_substitution_select"], function(values) {
            calcSubstitutionScore(values.protection_substitution_select, "Protection");
        });
        calcProtection();
    };

	// Update All Attributes when any are changed (have to b/c of attribute substitution)
	function calcAttributes() {
		calcAgilitySub();
		calcFortitudeSub();
		calcMightSub();
		calcDeceptionSub();
		calcPresenceSub();
		calcPersuasionSub();
		calcLearningSub();
		calcLogicSub();
		calcPerceptionSub();
		calcWillSub();
		calcAlterationSub();
		calcCreationSub();
		calcEnergySub();
		calcEntropySub();
		calcInfluenceSub();
		calcMovementSub();
		calcPrescienceSub();
		calcProtectionSub();
		calcOthers();
	};
	
	function calcOthers() {
		calcEvasion();
		calcToughness();
		calcResolve();
		calcHeavy();
		calcHitPoints();
		calcAllActionRolls();
	};

    // Function to calculate Evasion, called when changes made to Armor, Shield, Agility, or evasion other
    function calcEvasion() {
        getAttrs(["agility_score", "agility_substitution", "might_score", "might_substitution", "armor", "evasion_other"], function(values) {
            var score = 0;
            if (values.agility_score*1 >= values.agility_substitution*1) {
                score = values.agility_score*1;
            } else {
                score = values.agility_substitution*1;
            }
            if (values.might_score*1 >= values.might_substitution*1) {
                score = score + values.might_score*1;
            } else {
                score = score + values.might_substitution*1;
            }
            setAttrs({
                "evasion": score + values.armor*1 + values.evasion_other*1 + 10
            });
        });
    };
    
    // Function to calculate Toughness, called when changes made to Armor, Shield, Fortitude, or toughness other
    function calcToughness() {
        getAttrs(["fortitude_score", "fortitude_substitution", "will_score", "will_substitution", "toughness_other"], function(values) {
            var score = 0;
            if (values.fortitude_score*1 >= values.fortitude_substitution*1) {
                score = values.fortitude_score*1;
            } else {
                score = values.fortitude_substitution*1;
            }
            if (values.will_score*1 >= values.will_substitution*1) {
                score += values.will_score*1;
            } else {
                score += values.will_substitution*1;
            }
            setAttrs({
                "toughness": score + values.toughness_other*1 + 10
            });
        });
    };
    
    // Anytime resolve_other changed, update resolve
    on("change:resolve_other", function() {
        calcResolve();
    });
    
    // Function to calculate Resolve, called when changes made to presence, will, or resolve other
    function calcResolve() {
        getAttrs(["presence_score", "presence_substitution", "will_score", "will_substitution", "resolve_other"], function(values) {
            var score = 0;
            if (values.presence_score*1 >= values.presence_substitution*1) {
                score = values.presence_score*1;
            } else {
                score = values.presence_substitution*1;
            }
            if (values.will_score*1 >= values.will_substitution*1) {
                score += values.will_score*1;
            } else {
                score += values.will_substitution*1;
            }
            setAttrs({
                "resolve": score + values.resolve_other*1 + 10
            });
        });
    };
	
    on("change:base_speed change:might_score change:might_substitution_heavy change:might_substitution change:item_1_heavy change:item_2_heavy change:item_3_heavy change:item_4_heavy change:item_5_heavy change:item_6_heavy change:item_7_heavy change:item_8_heavy change:item_9_heavy change:item_10_heavy change:item_11_heavy change:item_12_heavy change:item_13_heavy change:item_14_heavy change:item_15_heavy change:item_16_heavy change:item_17_heavy change:item_18_heavy change:item_19_heavy change:item_20_heavy", function() {
        calcHeavy();
    });

    // Function to determine Heavy items
    function calcHeavy() {
        getAttrs(["base_speed", "might_score", "might_substitution", "might_substitution_heavy", "item_1_heavy", "item_2_heavy", "item_3_heavy", "item_4_heavy", "item_5_heavy", "item_6_heavy", "item_7_heavy", "item_8_heavy", "item_9_heavy", "item_10_heavy", "item_11_heavy", "item_12_heavy", "item_13_heavy", "item_14_heavy", "item_15_heavy", "item_16_heavy", "item_17_heavy", "item_18_heavy", "item_19_heavy", "item_20_heavy"], function(values) {
            var heavy_speed = values.base_speed*1;
            var score = 0;
            if(values.might_substitution_heavy === "on") {
                if(values.might_score*1 > values.might_substitution*1) {
                    score = values.might_score*1;
                } else {
                    score = values.might_substitution*1;
                }
            } else {
                score = values.might_score*1;
            }
            var heavy_total = 0;
            if(values.item_1_heavy === "heavy") {   heavy_total += 1;   }
            if(values.item_2_heavy === "heavy") {   heavy_total += 1;   }
            if(values.item_3_heavy === "heavy") {   heavy_total += 1;   }
            if(values.item_4_heavy === "heavy") {   heavy_total += 1;   }
            if(values.item_5_heavy === "heavy") {   heavy_total += 1;   }
            if(values.item_6_heavy === "heavy") {   heavy_total += 1;   }
            if(values.item_7_heavy === "heavy") {   heavy_total += 1;   }
            if(values.item_8_heavy === "heavy") {   heavy_total += 1;   }
            if(values.item_9_heavy === "heavy") {   heavy_total += 1;   }
            if(values.item_10_heavy === "heavy") {  heavy_total += 1;   }
            if(values.item_11_heavy === "heavy") {  heavy_total += 1;   }
            if(values.item_12_heavy === "heavy") {  heavy_total += 1;   }
            if(values.item_13_heavy === "heavy") {  heavy_total += 1;   }
            if(values.item_14_heavy === "heavy") {  heavy_total += 1;   }
            if(values.item_15_heavy === "heavy") {  heavy_total += 1;   }
            if(values.item_16_heavy === "heavy") {  heavy_total += 1;   }
            if(values.item_17_heavy === "heavy") {  heavy_total += 1;   }
            if(values.item_18_heavy === "heavy") {  heavy_total += 1;   }
            if(values.item_19_heavy === "heavy") {  heavy_total += 1;   }
            if(values.item_20_heavy === "heavy") {  heavy_total += 1;   }
            if(heavy_total == (score+1)) {  heavy_speed = Math.ceil(heavy_speed/2); }
            if(heavy_total > (score+1)) {   heavy_speed = 0;    }
            setAttrs({
                "item_heavy_result": heavy_speed
            });
        });
    };

    on("change:base_speed change:item_1_bulky change:item_2_bulky change:item_3_bulky change:item_4_bulky change:item_5_bulky change:item_6_bulky change:item_7_bulky change:item_8_bulky change:item_9_bulky change:item_10_bulky change:item_11_bulky change:item_12_bulky change:item_13_bulky change:item_14_bulky change:item_15_bulky change:item_16_bulky change:item_17_bulky change:item_18_bulky change:item_19_bulky change:item_20_bulky", function() {
        calcBulky();
    });

    // Function to determine bulky items
    function calcBulky() {
        getAttrs(["base_speed", "item_1_bulky", "item_2_bulky", "item_3_bulky", "item_4_bulky", "item_5_bulky", "item_6_bulky", "item_7_bulky", "item_8_bulky", "item_9_bulky", "item_10_bulky", "item_11_bulky", "item_12_bulky", "item_13_bulky", "item_14_bulky", "item_15_bulky", "item_16_bulky", "item_17_bulky", "item_18_bulky", "item_19_bulky", "item_20_bulky"], function(values) {
            var bulky_speed = values.base_speed*1;
            var bulky_total = 0;
            if(values.item_1_bulky === "bulky") {   bulky_total += 1;   }
            if(values.item_2_bulky === "bulky") {   bulky_total += 1;   }
            if(values.item_3_bulky === "bulky") {   bulky_total += 1;   }
            if(values.item_4_bulky === "bulky") {   bulky_total += 1;   }
            if(values.item_5_bulky === "bulky") {   bulky_total += 1;   }
            if(values.item_6_bulky === "bulky") {   bulky_total += 1;   }
            if(values.item_7_bulky === "bulky") {   bulky_total += 1;   }
            if(values.item_8_bulky === "bulky") {   bulky_total += 1;   }
            if(values.item_9_bulky === "bulky") {   bulky_total += 1;   }
            if(values.item_10_bulky === "bulky") {  bulky_total += 1;   }
            if(values.item_11_bulky === "bulky") {  bulky_total += 1;   }
            if(values.item_12_bulky === "bulky") {  bulky_total += 1;   }
            if(values.item_13_bulky === "bulky") {  bulky_total += 1;   }
            if(values.item_14_bulky === "bulky") {  bulky_total += 1;   }
            if(values.item_15_bulky === "bulky") {  bulky_total += 1;   }
            if(values.item_16_bulky === "bulky") {  bulky_total += 1;   }
            if(values.item_17_bulky === "bulky") {  bulky_total += 1;   }
            if(values.item_18_bulky === "bulky") {  bulky_total += 1;   }
            if(values.item_19_bulky === "bulky") {  bulky_total += 1;   }
            if(values.item_20_bulky === "bulky") {  bulky_total += 1;   }
            if(bulky_total == 2) {  bulky_speed = 5;    }
            if(bulky_total > 2) {   bulky_speed = 0;    }
            setAttrs({
                "item_bulky_result": bulky_speed
            });
        });
    };

    on("change:base_speed change:armor_penalty change:armor_training change:item_heavy_result change:item_bulky_result", function() {
        calcSpeed();
    });

    // Function to calculate Speed based on armor & equipment
    function calcSpeed() {
        getAttrs(["armor_penalty", "armor_training", "item_heavy_result", "item_bulky_result", "base_speed"], function(values) {
            var armorAdjust = 0;
            var newSpeed = values.base_speed*1;
            if(values.armor_penalty*1 > values.armor_training*1) {
                newSpeed = newSpeed - values.armor_penalty*1 + values.armor_training*1;
            }
            if(newSpeed > values.item_heavy_result*1) {
                newSpeed = values.item_heavy_result*1;
            }
            if(newSpeed > values.item_bulky_result*1) {
                newSpeed = values.item_bulky_result*1;
            }
            setAttrs({
                "speed": newSpeed
            });
        });
    };

    // If lethal damage changed, recalculate max HP
    on("change:lethal_damage change:hit_point_feats change:hit_point_other change:fortitude_substitution change:fortitude_score change:presence_score change:will_score", function() {
        calcHitPoints();
    });
    
    // Function to calc HIt points, called when changes to fortitude, presence or will
    function calcHitPoints() {
        getAttrs(["fortitude_score", "fortitude_substitution", "presence_score", "presence_substitution", "will_score", "will_substitution", "lethal_damage", "hit_point_feats", "hit_point_other"], function(values) {
            var score = 0;
            if(values.fortitude_score*1 >= values.fortitude_substitution*1) {
                score = values.fortitude_score*1;
            } else {
                score = values.fortitude_substitution*1;
            }
            if (values.presence_score*1 >= values.presence_substitution*1) {
                score += values.presence_score*1;
            } else {
                score += values.presence_substitution*1;
            }
            if (values.will_score*1 >= values.will_substitution*1) {
                score += values.will_score*1;
            } else {
                score += values.will_substitution*1;
            }
            setAttrs({
                "hit_point_max": 2*(score) + 10 - values.lethal_damage*1 + values.hit_point_feats*1 + values.hit_point_other*1
            });
        });
    };
	
    // Anytime XP is updated, recalculate Attribute Points and Feat Points and Level
    on("change:xp", function() {
		calcXPchanges();
    });

	// Function to run when XP is changed
	function calcXPchanges() {
        getAttrs(["xp"], function(values) {
            setAttrs({
                "level": Math.floor(values.xp/3) + 1,
                "attribute_points": values.xp*3 + 40,
                "feat_total_points": values.xp*1 + 6
            });
        });
	};
    
    // Anytime Agility score is changed, update cost and dice
    on("change:agility_score change:agility_dice_d20 change:agility_cost_modifier change:agility_dice_modifier", function() {
        calcAttributes();
    });
	
	// Function for calculating everything to do with Agility
	function calcAgility() {
        getAttrs(["agility_score", "agility_substitution", "agility_dice_d20", "agility_cost_modifier", "agility_dice_modifier"], function(values) {
            var score = values.agility_score*1 + values.agility_dice_modifier*1;
            var scoreCost = values.agility_score*1 + values.agility_cost_modifier*1;
            var number = calcAttributeDiceNumber(score);
            var type = calcAttributeDiceType(score);
            var dice = number + type;
			var roll = "";
			var rollInitiative = "";
			var display = 0;
			if(values.agility_score*1 >= values.agility_substitution*1) {
				display = values.agility_score*1;
			} else {
				display = values.agility_substitution*1;
			}
			if(score === 0) {
				roll = "[[?{Do you have Advantage or Disadvantage?|Neither,1d20!!|Advantage,2d20!!kh1|Disadvantage,2d20!!kl1}]]";
				rollInitiative = "[[?{Do you have Advantage or Disadvantage?|Neither,1d20!!|Advantage,2d20!!kh1|Disadvantage,2d20!!kl1}&{tracker}]]";
			} else {
				roll = "[[" + values.agility_dice_d20 + " + [[" + number + "+?{# of Advantage/Disadvantage Dice|0}]]" + type + "k?{Do you have Advantage or Disadvantage?|Neither,h|Advantage,h|Disadvantage,l}" + number + "]]";
				rollInitiative = "[[" + values.agility_dice_d20 + " + [[" + number + "+?{# of Advantage/Disadvantage Dice|0}]]" + type + "k?{Do you have Advantage or Disadvantage?|Neither,h|Advantage,h|Disadvantage,l}" + number + "&{tracker}]]";
			}
            setAttrs({
                "agility_cost": (scoreCost*1 * (scoreCost*1 + 1))/2,
                "agility_dice_roll": roll,
                "agility_dice": dice,
                "agility_initiative": rollInitiative,
				"agility_display": display
            });
            calcAttributePointsSpent();     // call to recalculate total costs, needs to be after new cost is set in setAttrs
        });
	};
    
    // Anytime fortitude score is changed, update cost and dice
    on("change:fortitude_score change:fortitude_dice_d20 change:fortitude_cost_modifier change:fortitude_dice_modifier", function() {
        calcAttributes();
    });
	
	// Function for calculating everything to do with Fortitude
	function calcFortitude() {
        getAttrs(["fortitude_score", "fortitude_substitution", "fortitude_dice_d20", "fortitude_cost_modifier", "fortitude_dice_modifier"], function(values) {
            var score = values.fortitude_score*1 + values.fortitude_dice_modifier*1;
            var scoreCost = values.fortitude_score*1 + values.fortitude_cost_modifier*1;
            var number = calcAttributeDiceNumber(score);
            var type = calcAttributeDiceType(score);
            var dice = number + type;
			var roll = "";
			var display = 0;
			if(values.fortitude_score*1 >= values.fortitude_substitution*1) {
				display = values.fortitude_score*1;
			} else {
				display = values.fortitude_substitution*1;
			}
			if(score === 0) {
				roll = "[[?{Do you have Advantage or Disadvantage?|Neither,1d20!!|Advantage,2d20!!kh1|Disadvantage,2d20!!kl1}]]";
			} else {
				roll = "[[" + values.fortitude_dice_d20 + " + [[" + number + "+?{# of Advantage/Disadvantage Dice|0}]]" + type + "k?{Do you have Advantage or Disadvantage?|Neither,h|Advantage,h|Disadvantage,l}" + number + "]]";
			}
            setAttrs({
                "fortitude_cost": (scoreCost*1 * (scoreCost*1 + 1))/2,
                "fortitude_dice_roll": roll,
                "fortitude_dice": dice,
				"fortitude_display": display
            });
            calcAttributePointsSpent();     // call to recalculate total costs, needs to be after new cost is set in setAttrs
        });
	};
    
    // Anytime might score is changed, update cost and dice
    on("change:might_score change:might_dice_d20 change:might_cost_modifier change:might_dice_modifier", function() {
        calcAttributes();
    });
	
	// Function for calculating everything to do with Might
	function calcMight() {
        getAttrs(["might_score", "might_substitution", "might_dice_d20", "might_cost_modifier", "might_dice_modifier"], function(values) {
            var score = values.might_score*1 + values.might_dice_modifier*1;
            var scoreCost = values.might_score*1 + values.might_cost_modifier*1;
            var number = calcAttributeDiceNumber(score);
            var type = calcAttributeDiceType(score);
            var dice = number + type;
			var roll = "";
			var display = 0;
			if(values.might_score*1 >= values.might_substitution*1) {
				display = values.might_score*1;
			} else {
				display = values.might_substitution*1;
			}
			if(score === 0) {
				roll = "[[?{Do you have Advantage or Disadvantage?|Neither,1d20!!|Advantage,2d20!!kh1|Disadvantage,2d20!!kl1}]]";
			} else {
				roll = "[[" + values.might_dice_d20 + " + [[" + number + "+?{# of Advantage/Disadvantage Dice|0}]]" + type + "k?{Do you have Advantage or Disadvantage?|Neither,h|Advantage,h|Disadvantage,l}" + number + "]]";
			}
            setAttrs({
                "might_cost": (scoreCost*1 * (scoreCost*1 + 1))/2,
                "might_dice_roll": roll,
                "might_dice": dice,
				"might_display": display
            });
            calcAttributePointsSpent();     // call to recalculate total costs, needs to be after new cost is set in setAttrs
        });
	};
    
    // Anytime deception score is changed, update cost and dice
    on("change:deception_score change:deception_dice_d20 change:deception_cost_modifier change:deception_dice_modifier", function() {
        calcAttributes();
    });
	
	// Function for calculating everything to do with Deception
	function calcDeception() {
        getAttrs(["deception_score", "deception_dice_d20", "deception_cost_modifier", "deception_dice_modifier"], function(values) {
            var score = values.deception_score*1 + values.deception_dice_modifier*1;
            var scoreCost = values.deception_score*1 + values.deception_cost_modifier*1;
            var number = calcAttributeDiceNumber(score);
            var type = calcAttributeDiceType(score);
            var dice = number + type;
			var roll = "";
			if(score === 0) {
				roll = "[[?{Do you have Advantage or Disadvantage?|Neither,1d20!!|Advantage,2d20!!kh1|Disadvantage,2d20!!kl1}]]";
			} else {
				roll = "[[" + values.deception_dice_d20 + " + [[" + number + "+?{# of Advantage/Disadvantage Dice|0}]]" + type + "k?{Do you have Advantage or Disadvantage?|Neither,h|Advantage,h|Disadvantage,l}" + number + "]]";
			}
            setAttrs({
                "deception_cost": (scoreCost*1 * (scoreCost*1 + 1))/2,
                "deception_dice_roll": roll,
                "deception_dice": dice
            });
            calcAttributePointsSpent();     // call to recalculate total costs, needs to be after new cost is set in setAttrs
        });
	};
	
    // Anytime presence score is changed, update cost and dice
    on("change:presence_score change:presence_dice_d20 change:presence_cost_modifier change:presence_dice_modifier", function() {
        calcAttributes();
    });
	
	// Function for calculating everything to do with Presence
	function calcPresence() {
        getAttrs(["presence_score", "presence_substitution", "presence_dice_d20", "presence_cost_modifier", "presence_dice_modifier"], function(values) {
            var score = values.presence_score*1 + values.presence_dice_modifier*1;
            var scoreCost = values.presence_score*1 + values.presence_cost_modifier*1;
            var number = calcAttributeDiceNumber(score);
            var type = calcAttributeDiceType(score);
            var dice = number + type;
			var roll = "";
			var display = 0;
			if(values.presence_score*1 >= values.presence_substitution*1) {
				display = values.presence_score*1;
			} else {
				display = values.presence_substitution*1;
			}
			if(score === 0) {
				roll = "[[?{Do you have Advantage or Disadvantage?|Neither,1d20!!|Advantage,2d20!!kh1|Disadvantage,2d20!!kl1}]]";
			} else {
				roll = "[[" + values.presence_dice_d20 + " + [[" + number + "+?{# of Advantage/Disadvantage Dice|0}]]" + type + "k?{Do you have Advantage or Disadvantage?|Neither,h|Advantage,h|Disadvantage,l}" + number + "]]";
			}
            setAttrs({
                "presence_cost": (scoreCost*1 * (scoreCost*1 + 1))/2,
                "presence_dice_roll": roll,
                "presence_dice": dice,
				"presence_display": display
            });
            calcAttributePointsSpent();     // call to recalculate total costs, needs to be after new cost is set in setAttrs
        });
	};
    
    // Anytime persuasion score is changed, update cost and dice
    on("change:persuasion_score change:persuasion_dice_d20 change:persuasion_cost_modifier change:persuasion_dice_modifier", function() {
        calcAttributes();
    });
	
	// Function for calculating everything to do with Persuasion
	function calcPersuasion() {
        getAttrs(["persuasion_score", "persuasion_dice_d20", "persuasion_cost_modifier", "persuasion_dice_modifier"], function(values) {
            var score = values.persuasion_score*1 + values.persuasion_dice_modifier*1;
            var scoreCost = values.persuasion_score*1 + values.persuasion_cost_modifier*1;
            var number = calcAttributeDiceNumber(score);
            var type = calcAttributeDiceType(score);
            var dice = number + type;
			var roll = "";
			if(score === 0) {
				roll = "[[?{Do you have Advantage or Disadvantage?|Neither,1d20!!|Advantage,2d20!!kh1|Disadvantage,2d20!!kl1}]]";
			} else {
				roll = "[[" + values.persuasion_dice_d20 + " + [[" + number + "+?{# of Advantage/Disadvantage Dice|0}]]" + type + "k?{Do you have Advantage or Disadvantage?|Neither,h|Advantage,h|Disadvantage,l}" + number + "]]";
			}
            setAttrs({
                "persuasion_cost": (scoreCost*1 * (scoreCost*1 + 1))/2,
                "persuasion_dice_roll": roll,
                "persuasion_dice": dice
            });
            calcAttributePointsSpent();     // call to recalculate total costs, needs to be after new cost is set in setAttrs
        });
	};
    
    // Anytime learning score is changed, update cost and dice
    on("change:learning_score change:learning_dice_d20 change:learning_cost_modifier change:learning_dice_modifier", function() {
        calcAttributes();
    });
	
	// Function for calculating everything to do with Learning
	function calcLearning() {
        getAttrs(["learning_score", "learning_dice_d20", "learning_cost_modifier", "learning_dice_modifier"], function(values) {
            var score = values.learning_score*1 + values.learning_dice_modifier*1;
            var scoreCost = values.learning_score*1 + values.learning_cost_modifier*1;
            var number = calcAttributeDiceNumber(score);
            var type = calcAttributeDiceType(score);
            var dice = number + type;
			var roll = "";
			if(score === 0) {
				roll = "[[?{Do you have Advantage or Disadvantage?|Neither,1d20!!|Advantage,2d20!!kh1|Disadvantage,2d20!!kl1}]]";
			} else {
				roll = "[[" + values.learning_dice_d20 + " + [[" + number + "+?{# of Advantage/Disadvantage Dice|0}]]" + type + "k?{Do you have Advantage or Disadvantage?|Neither,h|Advantage,h|Disadvantage,l}" + number + "]]";
			}
            setAttrs({
                "learning_cost": (scoreCost*1 * (scoreCost*1 + 1))/2,
                "learning_dice_roll": roll,
                "learning_dice": dice
            });
            calcAttributePointsSpent();     // call to recalculate total costs, needs to be after new cost is set in setAttrs
        });
	};
	
    // Anytime logic score is changed, update cost and dice
    on("change:logic_score change:logic_dice_d20 change:logic_cost_modifier change:logic_dice_modifier", function() {
        calcAttributes();
    });
	
	// Function for calculating everything to do with Logic
	function calcLogic() {
        getAttrs(["logic_score", "logic_dice_d20", "logic_cost_modifier", "logic_dice_modifier"], function(values) {
            var score = values.logic_score*1 + values.logic_dice_modifier*1;
            var scoreCost = values.logic_score*1 + values.logic_cost_modifier*1;
            var number = calcAttributeDiceNumber(score);
            var type = calcAttributeDiceType(score);
            var dice = number + type;
			var roll = "";
			if(score === 0) {
				roll = "[[?{Do you have Advantage or Disadvantage?|Neither,1d20!!|Advantage,2d20!!kh1|Disadvantage,2d20!!kl1}]]";
			} else {
				roll = "[[" + values.logic_dice_d20 + " + [[" + number + "+?{# of Advantage/Disadvantage Dice|0}]]" + type + "k?{Do you have Advantage or Disadvantage?|Neither,h|Advantage,h|Disadvantage,l}" + number + "]]";
			}
            setAttrs({
                "logic_cost": (scoreCost*1 * (scoreCost*1 + 1))/2,
                "logic_dice_roll": roll,
                "logic_dice": dice
            });
            calcAttributePointsSpent();     // call to recalculate total costs, needs to be after new cost is set in setAttrs
        });
	};
    
    // Anytime perception score is changed, update cost and dice
    on("change:perception_score change:perception_dice_d20 change:perception_cost_modifier change:perception_dice_modifier", function() {
        calcAttributes();
    });
	
	// Function for calculating everything to do with Perception
	function calcPerception() {
        getAttrs(["perception_score", "perception_dice_d20", "perception_cost_modifier", "perception_dice_modifier"], function(values) {
            var score = values.perception_score*1 + values.perception_dice_modifier*1;
            var scoreCost = values.perception_score*1 + values.perception_cost_modifier*1;
            var number = calcAttributeDiceNumber(score);
            var type = calcAttributeDiceType(score);
            var dice = number + type;
			var roll = "";
			if(score === 0) {
				roll = "[[?{Do you have Advantage or Disadvantage?|Neither,1d20!!|Advantage,2d20!!kh1|Disadvantage,2d20!!kl1}]]";
			} else {
				roll = "[[" + values.perception_dice_d20 + " + [[" + number + "+?{# of Advantage/Disadvantage Dice|0}]]" + type + "k?{Do you have Advantage or Disadvantage?|Neither,h|Advantage,h|Disadvantage,l}" + number + "]]";
			}
            setAttrs({
                "perception_cost": (scoreCost*1 * (scoreCost*1 + 1))/2,
                "perception_dice_roll": roll,
                "perception_dice": dice
            });
            calcAttributePointsSpent();     // call to recalculate total costs, needs to be after new cost is set in setAttrs
        });
	};
	
    // Anytime will score is changed, update cost and dice
    on("change:will_score change:will_dice_d20 change:will_cost_modifier change:will_dice_modifier", function() {
        calcAttributes();
    });
	
	// Function for calculating everything to do with Will
	function calcWill() {
        getAttrs(["will_score", "will_substitution", "will_dice_d20", "will_cost_modifier", "will_dice_modifier"], function(values) {
            var score = values.will_score*1 + values.will_dice_modifier*1;
            var scoreCost = values.will_score*1 + values.will_cost_modifier*1;
            var number = calcAttributeDiceNumber(score);
            var type = calcAttributeDiceType(score);
            var dice = number + type;
			var roll = "";
			var display = 0;
			if(values.will_score*1 >= values.will_substitution*1) {
				display = values.will_score*1;
			} else {
				display = values.will_substitution*1;
			}
			if(score === 0) {
				roll = "[[?{Do you have Advantage or Disadvantage?|Neither,1d20!!|Advantage,2d20!!kh1|Disadvantage,2d20!!kl1}]]";
			} else {
				roll = "[[" + values.will_dice_d20 + " + [[" + number + "+?{# of Advantage/Disadvantage Dice|0}]]" + type + "k?{Do you have Advantage or Disadvantage?|Neither,h|Advantage,h|Disadvantage,l}" + number + "]]";
			}
            setAttrs({
                "will_cost": (scoreCost*1 * (scoreCost*1 + 1))/2,
                "will_dice_roll": roll,
                "will_dice": dice,
				"will_display": display
            });
            calcAttributePointsSpent();     // call to recalculate total costs, needs to be after new cost is set in setAttrs
        });
	};
	
    // Anytime alteration score is changed, update cost and dice
    on("change:alteration_score change:alteration_dice_d20 change:alteration_cost_modifier change:alteration_dice_modifier", function() {
        calcAttributes();
    });
	
	// Function for calculating everything to do with Alteration
	function calcAlteration() {
        getAttrs(["alteration_score", "alteration_dice_d20", "alteration_cost_modifier", "alteration_dice_modifier"], function(values) {
            var score = values.alteration_score*1 + values.alteration_dice_modifier*1;
            var scoreCost = values.alteration_score*1 + values.alteration_cost_modifier*1;
            var number = calcAttributeDiceNumber(score);
            var type = calcAttributeDiceType(score);
            var dice = number + type;
			var roll = "";
			if(score === 0) {
				roll = "[[?{Do you have Advantage or Disadvantage?|Neither,1d20!!|Advantage,2d20!!kh1|Disadvantage,2d20!!kl1}]]";
			} else {
				roll = "[[" + values.alteration_dice_d20 + " + [[" + number + "+?{# of Advantage/Disadvantage Dice|0}]]" + type + "k?{Do you have Advantage or Disadvantage?|Neither,h|Advantage,h|Disadvantage,l}" + number + "]]";
			}
            setAttrs({
                "alteration_cost": (scoreCost*1 * (scoreCost*1 + 1))/2,
                "alteration_dice_roll": roll,
                "alteration_dice": dice
            });
            calcAttributePointsSpent();     // call to recalculate total costs, needs to be after new cost is set in setAttrs
        });
	};
	
    // Anytime creation score is changed, update cost and dice
    on("change:creation_score change:creation_dice_d20 change:creation_cost_modifier change:creation_dice_modifier", function() {
        calcAttributes();
    });
	
	// Function for calculating everything to do with Creation
	function calcCreation() {
        getAttrs(["creation_score", "creation_dice_d20", "creation_cost_modifier", "creation_dice_modifier"], function(values) {
            var score = values.creation_score*1 + values.creation_dice_modifier*1;
            var scoreCost = values.creation_score*1 + values.creation_cost_modifier*1;
            var number = calcAttributeDiceNumber(score);
            var type = calcAttributeDiceType(score);
            var dice = number + type;
			var roll = "";
			if(score === 0) {
				roll = "[[?{Do you have Advantage or Disadvantage?|Neither,1d20!!|Advantage,2d20!!kh1|Disadvantage,2d20!!kl1}]]";
			} else {
				roll = "[[" + values.creation_dice_d20 + " + [[" + number + "+?{# of Advantage/Disadvantage Dice|0}]]" + type + "k?{Do you have Advantage or Disadvantage?|Neither,h|Advantage,h|Disadvantage,l}" + number + "]]";
			}
            setAttrs({
                "creation_cost": (scoreCost*1 * (scoreCost*1 + 1))/2,
                "creation_dice_roll": roll,
                "creation_dice": dice
            });
            calcAttributePointsSpent();     // call to recalculate total costs, needs to be after new cost is set in setAttrs
        });
	};
	
    // Anytime energy score is changed, update cost and dice
    on("change:energy_score change:energy_dice_d20 change:energy_cost_modifier change:energy_dice_modifier", function() {
        calcAttributes();
    });
	
	// Function for calculating everything to do with Energy
	function calcEnergy() {
        getAttrs(["energy_score", "energy_dice_d20", "energy_cost_modifier", "energy_dice_modifier"], function(values) {
            var score = values.energy_score*1 + values.energy_dice_modifier*1;
            var scoreCost = values.energy_score*1 + values.energy_cost_modifier*1;
            var number = calcAttributeDiceNumber(score);
            var type = calcAttributeDiceType(score);
            var dice = number + type;
			var roll = "";
			if(score === 0) {
				roll = "[[?{Do you have Advantage or Disadvantage?|Neither,1d20!!|Advantage,2d20!!kh1|Disadvantage,2d20!!kl1}]]";
			} else {
				roll = "[[" + values.energy_dice_d20 + " + [[" + number + "+?{# of Advantage/Disadvantage Dice|0}]]" + type + "k?{Do you have Advantage or Disadvantage?|Neither,h|Advantage,h|Disadvantage,l}" + number + "]]";
			}
            setAttrs({
                "energy_cost": (scoreCost*1 * (scoreCost*1 + 1))/2,
                "energy_dice_roll": roll,
                "energy_dice": dice
            });
            calcAttributePointsSpent();     // call to recalculate total costs, needs to be after new cost is set in setAttrs
        });
	};
	
    // Anytime entropy score is changed, update cost and dice
    on("change:entropy_score change:entropy_dice_d20 change:entropy_cost_modifier change:entropy_dice_modifier", function() {
        calcAttributes();
    });
	
	// Function for calculating everything to do with Entropy
	function calcEntropy() {
        getAttrs(["entropy_score", "entropy_dice_d20", "entropy_cost_modifier", "entropy_dice_modifier"], function(values) {
            var score = values.entropy_score*1 + values.entropy_dice_modifier*1;
            var scoreCost = values.entropy_score*1 + values.entropy_cost_modifier*1;
            var number = calcAttributeDiceNumber(score);
            var type = calcAttributeDiceType(score);
            var dice = number + type;
			var roll = "";
			if(score === 0) {
				roll = "[[?{Do you have Advantage or Disadvantage?|Neither,1d20!!|Advantage,2d20!!kh1|Disadvantage,2d20!!kl1}]]";
			} else {
				roll = "[[" + values.entropy_dice_d20 + " + [[" + number + "+?{# of Advantage/Disadvantage Dice|0}]]" + type + "k?{Do you have Advantage or Disadvantage?|Neither,h|Advantage,h|Disadvantage,l}" + number + "]]";
			}
            setAttrs({
                "entropy_cost": (scoreCost*1 * (scoreCost*1 + 1))/2,
                "entropy_dice_roll": roll,
                "entropy_dice": dice
            });
            calcAttributePointsSpent();     // call to recalculate total costs, needs to be after new cost is set in setAttrs
        });
	};
	
    // Anytime influence score is changed, update cost and dice
    on("change:influence_score change:influence_dice_d20 change:influence_cost_modifier change:influence_dice_modifier", function() {
        calcAttributes();
    });
	
	// Function for calculating everything to do with Influence
	function calcInfluence() {
        getAttrs(["influence_score", "influence_dice_d20", "influence_cost_modifier", "influence_dice_modifier"], function(values) {
            var score = values.influence_score*1 + values.influence_dice_modifier*1;
            var scoreCost = values.influence_score*1 + values.influence_cost_modifier*1;
            var number = calcAttributeDiceNumber(score);
            var type = calcAttributeDiceType(score);
            var dice = number + type;
			var roll = "";
			if(score === 0) {
				roll = "[[?{Do you have Advantage or Disadvantage?|Neither,1d20!!|Advantage,2d20!!kh1|Disadvantage,2d20!!kl1}]]";
			} else {
				roll = "[[" + values.influence_dice_d20 + " + [[" + number + "+?{# of Advantage/Disadvantage Dice|0}]]" + type + "k?{Do you have Advantage or Disadvantage?|Neither,h|Advantage,h|Disadvantage,l}" + number + "]]";
			}
            setAttrs({
                "influence_cost": (scoreCost*1 * (scoreCost*1 + 1))/2,
                "influence_dice_roll": roll,
                "influence_dice": dice
            });
            calcAttributePointsSpent();     // call to recalculate total costs, needs to be after new cost is set in setAttrs
        });
	};

    // Anytime movement score is changed, update cost and dice
    on("change:movement_score change:movement_dice_d20 change:movement_cost_modifier change:movement_dice_modifier", function() {
        calcAttributes();
    });
	
	// Function for calculating everything to do with Movement
	function calcMovement() {
        getAttrs(["movement_score", "movement_dice_d20", "movement_cost_modifier", "movement_dice_modifier"], function(values) {
            var score = values.movement_score*1 + values.movement_dice_modifier*1;
            var scoreCost = values.movement_score*1 + values.movement_cost_modifier*1;
            var number = calcAttributeDiceNumber(score);
            var type = calcAttributeDiceType(score);
            var dice = number + type;
			var roll = "";
			if(score === 0) {
				roll = "[[?{Do you have Advantage or Disadvantage?|Neither,1d20!!|Advantage,2d20!!kh1|Disadvantage,2d20!!kl1}]]";
			} else {
				roll = "[[" + values.movement_dice_d20 + " + [[" + number + "+?{# of Advantage/Disadvantage Dice|0}]]" + type + "k?{Do you have Advantage or Disadvantage?|Neither,h|Advantage,h|Disadvantage,l}" + number + "]]";
			}
            setAttrs({
                "movement_cost": (scoreCost*1 * (scoreCost*1 + 1))/2,
                "movement_dice_roll": roll,
                "movement_dice": dice
            });
            calcAttributePointsSpent();     // call to recalculate total costs, needs to be after new cost is set in setAttrs
        });
	};

	// Anytime prescience score is changed, update cost and dice
    on("change:prescience_score change:prescience_dice_d20 change:prescience_cost_modifier change:prescience_dice_modifier", function() {
        calcAttributes();
    });
	
	// Function for calculating everything to do with Protection
	function calcPrescience() {
        getAttrs(["prescience_score", "prescience_dice_d20", "prescience_cost_modifier", "prescience_dice_modifier"], function(values) {
            var score = values.prescience_score*1 + values.prescience_dice_modifier*1;
            var scoreCost = values.prescience_score*1 + values.prescience_cost_modifier*1;
            var number = calcAttributeDiceNumber(score);
            var type = calcAttributeDiceType(score);
            var dice = number + type;
			var roll = "";
			if(score === 0) {
				roll = "[[?{Do you have Advantage or Disadvantage?|Neither,1d20!!|Advantage,2d20!!kh1|Disadvantage,2d20!!kl1}]]";
			} else {
				roll = "[[" + values.prescience_dice_d20 + " + [[" + number + "+?{# of Advantage/Disadvantage Dice|0}]]" + type + "k?{Do you have Advantage or Disadvantage?|Neither,h|Advantage,h|Disadvantage,l}" + number + "]]";
			}
            setAttrs({
                "prescience_cost": (scoreCost*1 * (scoreCost*1 + 1))/2,
                "prescience_dice_roll": roll,
                "prescience_dice": dice
            });
            calcAttributePointsSpent();     // call to recalculate total costs, needs to be after new cost is set in setAttrs
        });
	};

	// Anytime protection score is changed, update cost and dice
    on("change:protection_score change:protection_dice_d20 change:protection_cost_modifier change:protection_dice_modifier", function() {
        calcAttributes();
    });
	
	// Function for calculating everything to do with Protection
	function calcProtection() {
        getAttrs(["protection_score", "protection_dice_d20", "protection_cost_modifier", "protection_dice_modifier"], function(values) {
            var score = values.protection_score*1 + values.protection_dice_modifier*1;
            var scoreCost = values.protection_score*1 + values.protection_cost_modifier*1;
            var number = calcAttributeDiceNumber(score);
            var type = calcAttributeDiceType(score);
            var dice = number + type;
			var roll = "";
			if(score === 0) {
				roll = "[[?{Do you have Advantage or Disadvantage?|Neither,1d20!!|Advantage,2d20!!kh1|Disadvantage,2d20!!kl1}]]";
			} else {
				roll = "[[" + values.protection_dice_d20 + " + [[" + number + "+?{# of Advantage/Disadvantage Dice|0}]]" + type + "k?{Do you have Advantage or Disadvantage?|Neither,h|Advantage,h|Disadvantage,l}" + number + "]]";
			}
            setAttrs({
                "protection_cost": (scoreCost*1 * (scoreCost*1 + 1))/2,
                "protection_dice_roll": roll,
                "protection_dice": dice
            });
            calcAttributePointsSpent();     // call to recalculate total costs, needs to be after new cost is set in setAttrs
        });
	};
	
	// Show/Hide settings area
        // Function call to simplifiy coding for showing/hiding settings
    function showHide(value) {
        if(value === "on") {    return "show";  // If the checkbox is CHECKED then show the section
        } else {    return "hide";  }           // If the checkbox is UNchecked then hide the section
    };
        // Repeating sections show/hide settings
    on("change:output_character", function() {
        getAttrs(["output_character"], function(values) {
            setAttrs({
                "display_character_flag": showHide(values.output_character)
            });
        });
    });
    on("change:output_goalsbeliefs", function() {
        getAttrs(["output_goalsbeliefs"], function(values) {
            setAttrs({
                "display_goalsbeliefs_flag": showHide(values.output_goalsbeliefs)
            });
        });
    });
    on("change:output_attributes", function() {
        getAttrs(["output_attributes"], function(values) {
            setAttrs({
                "display_attributes_flag": showHide(values.output_attributes)
            });
        });
    });
    on("change:output_defenses", function() {
        getAttrs(["output_defenses"], function(values) {
            setAttrs({
                "display_defenses_flag": showHide(values.output_defenses)
            });
        });
    });
    on("change:output_healthspeed", function() {
        getAttrs(["output_healthspeed"], function(values) {
            setAttrs({
                "display_healthspeed_flag": showHide(values.output_healthspeed)
            });
        });
    });
    on("change:output_sanity", function() {
        getAttrs(["output_sanity"], function(values) {
            setAttrs({
                "display_sanity_flag": showHide(values.output_sanity)
            });
        });
    });
    on("change:output_favoredactions", function() {
        getAttrs(["output_favoredactions"], function(values) {
            setAttrs({
                "display_favoredactions_flag": showHide(values.output_favoredactions)
            });
        });
    });
    on("change:output_otheractions", function() {
        getAttrs(["output_otheractions"], function(values) {
            setAttrs({
                "display_otheractions_flag": showHide(values.output_otheractions)
            });
        });
    });
    on("change:output_feats", function() {
        getAttrs(["output_feats"], function(values) {
            setAttrs({
                "display_feats_flag": showHide(values.output_feats)
            });
        });
    });
    on("change:output_perksflaws", function() {
        getAttrs(["output_perksflaws"], function(values) {
            setAttrs({
                "display_perksflaws_flag": showHide(values.output_perksflaws)
            });
        });
    });
    on("change:output_inventory", function() {
        getAttrs(["output_inventory"], function(values) {
            setAttrs({
                "display_inventory_flag": showHide(values.output_inventory)
            });
        });
    });
    on("change:output_otherinventory", function() {
        getAttrs(["output_otherinventory"], function(values) {
            setAttrs({
                "display_otherinventory_flag": showHide(values.output_otherinventory)
            });
        });
    });
    on("change:output_sanity", function() {
        getAttrs(["output_sanity"], function(values) {
            setAttrs({
                "display_sanity_flag": showHide(values.output_sanity)
            });
        });
    });

    on("change:agility_settings_flag", function() {
        getAttrs(["agility_settings_flag"], function(values) {
            setAttrs({
                "agility_display_settings_flag": showHide(values.agility_settings_flag)
            });
        });
    });
    on("change:fortitude_settings_flag", function() {
        getAttrs(["fortitude_settings_flag"], function(values) {
            setAttrs({
                "fortitude_display_settings_flag": showHide(values.fortitude_settings_flag)
            });
        });
    });
    on("change:might_settings_flag", function() {
        getAttrs(["might_settings_flag"], function(values) {
            setAttrs({
                "might_display_settings_flag": showHide(values.might_settings_flag)
            });
        });
    });
    on("change:learning_settings_flag", function() {
        getAttrs(["learning_settings_flag"], function(values) {
            setAttrs({
                "learning_display_settings_flag": showHide(values.learning_settings_flag)
            });
        });
    });
    on("change:logic_settings_flag", function() {
        getAttrs(["logic_settings_flag"], function(values) {
            setAttrs({
                "logic_display_settings_flag": showHide(values.logic_settings_flag)
            });
        });
    });
    on("change:perception_settings_flag", function() {
        getAttrs(["perception_settings_flag"], function(values) {
            setAttrs({
                "perception_display_settings_flag": showHide(values.perception_settings_flag)
            });
        });
    });
    on("change:will_settings_flag", function() {
        getAttrs(["will_settings_flag"], function(values) {
            setAttrs({
                "will_display_settings_flag": showHide(values.will_settings_flag)
            });
        });
    });
    on("change:deception_settings_flag", function() {
        getAttrs(["deception_settings_flag"], function(values) {
            setAttrs({
                "deception_display_settings_flag": showHide(values.deception_settings_flag)
            });
        });
    });
    on("change:persuasion_settings_flag", function() {
        getAttrs(["persuasion_settings_flag"], function(values) {
            setAttrs({
                "persuasion_display_settings_flag": showHide(values.persuasion_settings_flag)
            });
        });
    });
    on("change:presence_settings_flag", function() {
        getAttrs(["presence_settings_flag"], function(values) {
            setAttrs({
                "presence_display_settings_flag": showHide(values.presence_settings_flag)
            });
        });
    });
    on("change:alteration_settings_flag", function() {
        getAttrs(["alteration_settings_flag"], function(values) {
            setAttrs({
                "alteration_display_settings_flag": showHide(values.alteration_settings_flag)
            });
        });
    });
    on("change:creation_settings_flag", function() {
        getAttrs(["creation_settings_flag"], function(values) {
            setAttrs({
                "creation_display_settings_flag": showHide(values.creation_settings_flag)
            });
        });
    });
    on("change:energy_settings_flag", function() {
        getAttrs(["energy_settings_flag"], function(values) {
            setAttrs({
                "energy_display_settings_flag": showHide(values.energy_settings_flag)
            });
        });
    });
    on("change:entropy_settings_flag", function() {
        getAttrs(["entropy_settings_flag"], function(values) {
            setAttrs({
                "entropy_display_settings_flag": showHide(values.entropy_settings_flag)
            });
        });
    });
    on("change:influence_settings_flag", function() {
        getAttrs(["influence_settings_flag"], function(values) {
            setAttrs({
                "influence_display_settings_flag": showHide(values.influence_settings_flag)
            });
        });
    });
    on("change:movement_settings_flag", function() {
        getAttrs(["movement_settings_flag"], function(values) {
            setAttrs({
                "movement_display_settings_flag": showHide(values.movement_settings_flag)
            });
        });
    });
    on("change:prescience_settings_flag", function() {
        getAttrs(["prescience_settings_flag"], function(values) {
            setAttrs({
                "prescience_display_settings_flag": showHide(values.prescience_settings_flag)
            });
        });
    });
    on("change:protection_settings_flag", function() {
        getAttrs(["protection_settings_flag"], function(values) {
            setAttrs({
                "protection_display_settings_flag": showHide(values.protection_settings_flag)
            });
        });
    });
    
    on("change:repeating_actions:settingsflag", function() {
        getAttrs(["repeating_actions_settingsFlag"], function(values) {
            setAttrs({
                "repeating_actions_displaySettingsFlag": showHide(values.repeating_actions_settingsFlag)
            });
        });
    });
    on("change:repeating_otheractions:settingsflag", function() {
        getAttrs(["repeating_otheractions_settingsFlag"], function(values) {
            setAttrs({
                "repeating_otheractions_displaySettingsFlag": showHide(values.repeating_otheractions_settingsFlag)
            });
        });
    });
    on("change:repeating_featsLeft:settingsflag", function() {
        getAttrs(["repeating_featsLeft_settingsFlag"], function(values) {
            setAttrs({
                "repeating_featsLeft_displaySettingsFlag": showHide(values.repeating_featsLeft_settingsFlag)
            });
        });
    });
    on("change:repeating_featsRight:settingsflag", function() {
        getAttrs(["repeating_featsRight_settingsFlag"], function(values) {
            setAttrs({
                "repeating_featsRight_displaySettingsFlag": showHide(values.repeating_featsRight_settingsFlag)
            });
        });
    });
        // Perks
    on("change:repeating_perks:settingsflag", function() {
        getAttrs(["repeating_perks_settingsFlag"], function(values) {
            setAttrs({
                "repeating_perks_displaySettingsFlag": showHide(values.repeating_perks_settingsFlag)
            });
        });
    });
    on("change:repeating_perksRight:settingsflag", function() {
        getAttrs(["repeating_perksRight_settingsFlag"], function(values) {
            setAttrs({
                "repeating_perksRight_displaySettingsFlag": showHide(values.repeating_perksRight_settingsFlag)
            });
        });
    });
        // Flaws
    on("change:repeating_flaws:settingsflag", function() {
        getAttrs(["repeating_flaws_settingsFlag"], function(values) {
            setAttrs({
                "repeating_flaws_displaySettingsFlag": showHide(values.repeating_flaws_settingsFlag)
            });
        });
    });
    on("change:repeating_flawsRight:settingsflag", function() {
        getAttrs(["repeating_flawsRight_settingsFlag"], function(values) {
            setAttrs({
                "repeating_flawsRight_displaySettingsFlag": showHide(values.repeating_flawsRight_settingsFlag)
            });
        });
    });

    function calcAllActionRolls () {
        calcFavoredActionRolls();
        calcOtherActionRolls();
    };
	// Function for calculating rolls for Actions
    function calcFavoredActionRolls () {
        getSectionIDs("repeating_actions", function(actionsArray) {
         if(actionsArray.length > 0) {
            _.each(actionsArray, function(currentID, i) {
                getAttrs(["repeating_actions_" + currentID + "_action_attribute", "repeating_actions_" + currentID + "_dice_d20", "repeating_actions_" + currentID + "_dice_modifier", "repeating_actions_" + currentID + "_use_power_level", "repeating_actions_" + currentID + "_power_level", "repeating_actions_" + currentID + "_power_level_max", "agility_score", "agility_dice_modifier", "fortitude_score", "fortitude_dice_modifier", "might_score", "might_dice_modifier", "learning_score", "learning_dice_modifier", "logic_score", "logic_dice_modifier", "perception_score", "perception_dice_modifier", "will_score", "will_dice_modifier", "deception_score", "deception_dice_modifier", "persuasion_score", "persuasion_dice_modifier", "presence_score", "presence_dice_modifier", "alteration_score", "alteration_dice_modifier", "creation_score", "creation_dice_modifier", "energy_score", "energy_dice_modifier", "entropy_score", "entropy_dice_modifier", "influence_score", "influence_dice_modifier", "movement_score", "movement_dice_modifier", "prescience_score", "prescience_dice_modifier", "protection_score", "protection_dice_modifier"], function(v) {
                    var update = {};
                    var score = 0;
                    if(v["repeating_actions_" + currentID + "_action_attribute"] === "Agility") {
                        score = v.agility_score*1 + v.agility_dice_modifier*1;
                    } else if(v["repeating_actions_" + currentID + "_action_attribute"] === "Fortitude") {
                        score = v.fortitude_score*1 + v.fortitude_dice_modifier*1;
                    } else if(v["repeating_actions_" + currentID + "_action_attribute"] === "Might") {
                        score = v.might_score*1 + v.might_dice_modifier*1;
                    } else if(v["repeating_actions_" + currentID + "_action_attribute"] === "Learning") {
                        score = v.learning_score*1 + v.learning_dice_modifier*1;
                    } else if(v["repeating_actions_" + currentID + "_action_attribute"] === "Logic") {
                        score = v.logic_score*1 + v.logic_dice_modifier*1;
                    } else if(v["repeating_actions_" + currentID + "_action_attribute"] === "Perception") {
                        score = v.perception_score*1 + v.perception_dice_modifier*1;
                    } else if(v["repeating_actions_" + currentID + "_action_attribute"] === "Will") {
                        score = v.will_score*1 + v.will_dice_modifier*1;
                    } else if(v["repeating_actions_" + currentID + "_action_attribute"] === "Deception") {
                        score = v.deception_score*1 + v.deception_dice_modifier*1;
                    } else if(v["repeating_actions_" + currentID + "_action_attribute"] === "Persuasion") {
                        score = v.persuasion_score*1 + v.persuasion_dice_modifier*1;
                    } else if(v["repeating_actions_" + currentID + "_action_attribute"] === "Presence") {
                        score = v.presence_score*1 + v.presence_dice_modifier*1;
                    } else if(v["repeating_actions_" + currentID + "_action_attribute"] === "Alteration") {
                        score = v.alteration_score*1 + v.alteration_dice_modifier*1;
                    } else if(v["repeating_actions_" + currentID + "_action_attribute"] === "Creation") {
                        score = v.creation_score*1 + v.creation_dice_modifier*1;
                    } else if(v["repeating_actions_" + currentID + "_action_attribute"] === "Energy") {
                        score = v.energy_score*1 + v.energy_dice_modifier*1;
                    } else if(v["repeating_actions_" + currentID + "_action_attribute"] === "Entropy") {
                        score = v.entropy_score*1 + v.entropy_dice_modifier*1;
                    } else if(v["repeating_actions_" + currentID + "_action_attribute"] === "Influence") {
                        score = v.influence_score*1 + v.influence_dice_modifier*1;
                    } else if(v["repeating_actions_" + currentID + "_action_attribute"] === "Movement") {
                        score = v.movement_score*1 + v.movement_dice_modifier*1;
                    } else if(v["repeating_actions_" + currentID + "_action_attribute"] === "Prescience") {
                        score = v.prescience_score*1 + v.prescience_dice_modifier*1;
                    } else if(v["repeating_actions_" + currentID + "_action_attribute"] === "Protection") {
                        score = v.protection_score*1 + v.protection_dice_modifier*1;
                    }
                    if(isNaN(v["repeating_actions_" + currentID + "_dice_modifier"])) {
                        update["repeating_actions_" + currentID + "_dice_modifier"] = 0;
                    } else {
                        score = score*1 + v["repeating_actions_" + currentID + "_dice_modifier"]*1;
                    }
                    var number = calcAttributeDiceNumber(score);
                    var type = calcAttributeDiceType(score);
                    var roll = "";
        			if(score === 0) {
        				roll = "[[?{Do you have Advantage or Disadvantage?|Neither,1d20!!|Advantage,2d20!!kh1|Disadvantage,2d20!!kl1}]]";
        			} else {
        			    if(isNaN(v["repeating_actions_" + currentID + "_dice_d20"])) {
            				roll = "[[1d20!! + [[" + number + "+?{# of Advantage/Disadvantage Dice|0}]]" + type + "k?{Do you have Advantage or Disadvantage?|Neither,h|Advantage,h|Disadvantage,l}" + number + "]]";
        			    } else {
            				roll = "[[" + v["repeating_actions_" + currentID + "_dice_d20"] + " + [[" + number + "+?{# of Advantage/Disadvantage Dice|0}]]" + type + "k?{Do you have Advantage or Disadvantage?|Neither,h|Advantage,h|Disadvantage,l}" + number + "]]";
        			    }
        			}
                    if(v["repeating_actions_" + currentID + "_use_power_level"] === "Yes") {
                        update["repeating_actions_" + currentID + "_power_target"] = "[[10 + " + v["repeating_actions_" + currentID + "_power_level"]*2 + "]]";
                        update["repeating_actions_" + currentID + "_power_target_max"] = "[[10 + " + v["repeating_actions_" + currentID + "_power_level_max"]*2 + "]]";
                    } else {
                        update["repeating_actions_" + currentID + "_power_target"] = "";
                    }
        			update["repeating_actions_" + currentID + "_dice_roll"] = roll;
        			setAttrs(update);
                });
            });
         }
        });
    };
	// Function for calculating rolls for Actions
    function calcOtherActionRolls () {
        getSectionIDs("repeating_otheractions", function(actionsArray) {
         if(actionsArray.length > 0) {
            _.each(actionsArray, function(currentID, i) {
                getAttrs(["repeating_otheractions_" + currentID + "_action_attribute", "repeating_otheractions_" + currentID + "_dice_d20", "repeating_otheractions_" + currentID + "_dice_modifier", "repeating_otheractions_" + currentID + "_use_power_level", "repeating_otheractions_" + currentID + "_power_level", "repeating_otheractions_" + currentID + "_power_level_max", "agility_score", "agility_dice_modifier", "fortitude_score", "fortitude_dice_modifier", "might_score", "might_dice_modifier", "learning_score", "learning_dice_modifier", "logic_score", "logic_dice_modifier", "perception_score", "perception_dice_modifier", "will_score", "will_dice_modifier", "deception_score", "deception_dice_modifier", "persuasion_score", "persuasion_dice_modifier", "presence_score", "presence_dice_modifier", "alteration_score", "alteration_dice_modifier", "creation_score", "creation_dice_modifier", "energy_score", "energy_dice_modifier", "entropy_score", "entropy_dice_modifier", "influence_score", "influence_dice_modifier", "movement_score", "movement_dice_modifier", "prescience_score", "prescience_dice_modifier", "protection_score", "protection_dice_modifier"], function(v) {
                    var updateother = {};
                    var score = 0;
                    if(v["repeating_otheractions_" + currentID + "_action_attribute"] === "Agility") {
                        score = v.agility_score*1 + v.agility_dice_modifier*1;
                    } else if(v["repeating_otheractions_" + currentID + "_action_attribute"] === "Fortitude") {
                        score = v.fortitude_score*1 + v.fortitude_dice_modifier*1;
                    } else if(v["repeating_otheractions_" + currentID + "_action_attribute"] === "Might") {
                        score = v.might_score*1 + v.might_dice_modifier*1;
                    } else if(v["repeating_otheractions_" + currentID + "_action_attribute"] === "Learning") {
                        score = v.learning_score*1 + v.learning_dice_modifier*1;
                    } else if(v["repeating_otheractions_" + currentID + "_action_attribute"] === "Logic") {
                        score = v.logic_score*1 + v.logic_dice_modifier*1;
                    } else if(v["repeating_otheractions_" + currentID + "_action_attribute"] === "Perception") {
                        score = v.perception_score*1 + v.perception_dice_modifier*1;
                    } else if(v["repeating_otheractions_" + currentID + "_action_attribute"] === "Will") {
                        score = v.will_score*1 + v.will_dice_modifier*1;
                    } else if(v["repeating_otheractions_" + currentID + "_action_attribute"] === "Deception") {
                        score = v.deception_score*1 + v.deception_dice_modifier*1;
                    } else if(v["repeating_otheractions_" + currentID + "_action_attribute"] === "Persuasion") {
                        score = v.persuasion_score*1 + v.persuasion_dice_modifier*1;
                    } else if(v["repeating_otheractions_" + currentID + "_action_attribute"] === "Presence") {
                        score = v.presence_score*1 + v.presence_dice_modifier*1;
                    } else if(v["repeating_otheractions_" + currentID + "_action_attribute"] === "Alteration") {
                        score = v.alteration_score*1 + v.alteration_dice_modifier*1;
                    } else if(v["repeating_otheractions_" + currentID + "_action_attribute"] === "Creation") {
                        score = v.creation_score*1 + v.creation_dice_modifier*1;
                    } else if(v["repeating_otheractions_" + currentID + "_action_attribute"] === "Energy") {
                        score = v.energy_score*1 + v.energy_dice_modifier*1;
                    } else if(v["repeating_otheractions_" + currentID + "_action_attribute"] === "Entropy") {
                        score = v.entropy_score*1 + v.entropy_dice_modifier*1;
                    } else if(v["repeating_otheractions_" + currentID + "_action_attribute"] === "Influence") {
                        score = v.influence_score*1 + v.influence_dice_modifier*1;
                    } else if(v["repeating_otheractions_" + currentID + "_action_attribute"] === "Movement") {
                        score = v.movement_score*1 + v.movement_dice_modifier*1;
                    } else if(v["repeating_otheractions_" + currentID + "_action_attribute"] === "Prescience") {
                        score = v.prescience_score*1 + v.prescience_dice_modifier*1;
                    } else if(v["repeating_otheractions_" + currentID + "_action_attribute"] === "Protection") {
                        score = v.protection_score*1 + v.protection_dice_modifier*1;
                    }
                    if(isNaN(v["repeating_otheractions_" + currentID + "_dice_modifier"])) {
                        update["repeating_otheractions_" + currentID + "_dice_modifier"] = 0;
                    } else {
                        score = score*1 + v["repeating_otheractions_" + currentID + "_dice_modifier"]*1;
                    }
                    var number = calcAttributeDiceNumber(score);
                    var type = calcAttributeDiceType(score);
                    var roll = "";
        			if(score === 0) {
        				roll = "[[?{Do you have Advantage or Disadvantage?|Neither,1d20!!|Advantage,2d20!!kh1|Disadvantage,2d20!!kl1}]]";
        			} else {
        			    if(isNaN(v["repeating_otheractions_" + currentID + "_dice_d20"])) {
            				roll = "[[1d20!! + [[" + number + "+?{# of Advantage/Disadvantage Dice|0}]]" + type + "k?{Do you have Advantage or Disadvantage?|Neither,h|Advantage,h|Disadvantage,l}" + number + "]]";
        			    } else {
            				roll = "[[" + v["repeating_otheractions_" + currentID + "_dice_d20"] + " + [[" + number + "+?{# of Advantage/Disadvantage Dice|0}]]" + type + "k?{Do you have Advantage or Disadvantage?|Neither,h|Advantage,h|Disadvantage,l}" + number + "]]";
        			    }
        			}
                    if(v["repeating_otheractions_" + currentID + "_use_power_level"] === "Yes") {
                        updateother["repeating_otheractions_" + currentID + "_power_target"] = "[[10 + " + v["repeating_otheractions_" + currentID + "_power_level"]*2 + "]]";
                        updateother["repeating_otheractions_" + currentID + "_power_target_max"] = "[[10 + " + v["repeating_otheractions_" + currentID + "_power_level_max"]*2 + "]]";
                    } else {
                        updateother["repeating_otheractions_" + currentID + "_power_target"] = "";
                    }
        			updateother["repeating_otheractions_" + currentID + "_dice_roll"] = roll;
        			setAttrs(updateother);
                });
            });
         }
        });    
	};
	
	// On Change for Use Power Level in actions
    on("change:repeating_otheractions:use_power_level change:repeating_otheractions:power_level change:repeating_otheractions:power_level_max", function() {
        getAttrs(["repeating_otheractions_use_power_level", "repeating_otheractions_power_level", "repeating_otheractions_power_level_max"], function(values) {
            if(values.repeating_otheractions_use_power_level === "Yes") {
                setAttrs({
                    "repeating_otheractions_power_target": "[[10 + " + values.repeating_otheractions_power_level*2 + "]]",
                    "repeating_otheractions_power_target_max": "[[10 + " + values.repeating_otheractions_power_level_max*2 + "]]"
                });
            } else {
               setAttrs({
                    "repeating_otheractions_power_target": ""
                });
            }
        });
    });
	// On Change for Use Power Level in actions
    on("change:repeating_actions:use_power_level change:repeating_actions:power_level change:repeating_actions:power_level_max", function() {
        getAttrs(["repeating_actions_use_power_level", "repeating_actions_power_level", "repeating_actions_power_level_max"], function(values) {
            if(values.repeating_actions_use_power_level === "Yes") {
                setAttrs({
                    "repeating_actions_power_target": "[[10 + " + values.repeating_actions_power_level*2 + "]]",
                    "repeating_actions_power_target_max": "[[10 + " + values.repeating_actions_power_level_max*2 + "]]"
                });
            } else {
                setAttrs({
                    "repeating_actions_power_target": ""
                });
            }
        });
    });
	// On Change for calculating rolls for Actions
    on("change:repeating_actions:action_attribute change:repeating_actions:dice_d20 change:repeating_actions:dice_modifier", function() {
        getAttrs(["repeating_actions_action_attribute", "repeating_actions_dice_d20", "repeating_actions_dice_modifier", "agility_score", "agility_dice_modifier", "fortitude_score", "fortitude_dice_modifier", "might_score", "might_dice_modifier", "learning_score", "learning_dice_modifier", "logic_score", "logic_dice_modifier", "perception_score", "perception_dice_modifier", "will_score", "will_dice_modifier", "deception_score", "deception_dice_modifier", "persuasion_score", "persuasion_dice_modifier", "presence_score", "presence_dice_modifier", "alteration_score", "alteration_dice_modifier", "creation_score", "creation_dice_modifier", "energy_score", "energy_dice_modifier", "entropy_score", "entropy_dice_modifier", "influence_score", "influence_dice_modifier", "movement_score", "movement_dice_modifier", "prescience_score", "prescience_dice_modifier", "protection_score", "protection_dice_modifier"], function(values) {
            var score = 0;
            if(values.repeating_actions_action_attribute === "Agility") {
                score = values.agility_score*1 + values.agility_dice_modifier*1;
            } else if(values.repeating_actions_action_attribute === "Fortitude") {
                score = values.fortitude_score*1 + values.fortitude_dice_modifier*1;
            } else if(values.repeating_actions_action_attribute === "Might") {
                score = values.might_score*1 + values.might_dice_modifier*1;
            } else if(values.repeating_actions_action_attribute === "Learning") {
                score = values.learning_score*1 + values.learning_dice_modifier*1;
            } else if(values.repeating_actions_action_attribute === "Logic") {
                score = values.logic_score*1 + values.logic_dice_modifier*1;
            } else if(values.repeating_actions_action_attribute === "Perception") {
                score = values.perception_score*1 + values.perception_dice_modifier*1;
            } else if(values.repeating_actions_action_attribute === "Will") {
                score = values.will_score*1 + values.will_dice_modifier*1;
            } else if(values.repeating_actions_action_attribute === "Deception") {
                score = values.deception_score*1 + values.deception_dice_modifier*1;
            } else if(values.repeating_actions_action_attribute === "Persuasion") {
                score = values.persuasion_score*1 + values.persuasion_dice_modifier*1;
            } else if(values.repeating_actions_action_attribute === "Presence") {
                score = values.presence_score*1 + values.presence_dice_modifier*1;
            } else if(values.repeating_actions_action_attribute === "Alteration") {
                score = values.alteration_score*1 + values.alteration_dice_modifier*1;
            } else if(values.repeating_actions_action_attribute === "Creation") {
                score = values.creation_score*1 + values.creation_dice_modifier*1;
            } else if(values.repeating_actions_action_attribute === "Energy") {
                score = values.energy_score*1 + values.energy_dice_modifier*1;
            } else if(values.repeating_actions_action_attribute === "Entropy") {
                score = values.entropy_score*1 + values.entropy_dice_modifier*1;
            } else if(values.repeating_actions_action_attribute === "Influence") {
                score = values.influence_score*1 + values.influence_dice_modifier*1;
            } else if(values.repeating_actions_action_attribute === "Movement") {
                score = values.movement_score*1 + values.movement_dice_modifier*1;
            } else if(values.repeating_actions_action_attribute === "Prescience") {
                score = values.prescience_score*1 + values.prescience_dice_modifier*1;
            } else if(values.repeating_actions_action_attribute === "Protection") {
                score = values.protection_score*1 + values.protection_dice_modifier*1;
            }
            if(isNaN(values.repeating_actions_dice_modifier)) {
                setAttrs({  "repeating_actions_dice_modifier": 0    });
            } else {
                score = score*1 + values.repeating_actions_dice_modifier*1;
            }
            var number = calcAttributeDiceNumber(score);
            var type = calcAttributeDiceType(score);
			var roll = "";
			if(score === 0) {
				roll = "[[?{Do you have Advantage or Disadvantage?|Neither,1d20!!|Advantage,2d20!!kh1|Disadvantage,2d20!!kl1}]]";
			} else {
			    if(isNaN(values.repeating_actions_dice_d20)) {
    				roll = "[[1d20!! + [[" + number + "+?{# of Advantage/Disadvantage Dice|0}]]" + type + "k?{Do you have Advantage or Disadvantage?|Neither,h|Advantage,h|Disadvantage,l}" + number + "]]";
			    } else {
    				roll = "[[" + values.repeating_actions_dice_d20 + " + [[" + number + "+?{# of Advantage/Disadvantage Dice|0}]]" + type + "k?{Do you have Advantage or Disadvantage?|Neither,h|Advantage,h|Disadvantage,l}" + number + "]]";
			    }
			}
            setAttrs({
                "repeating_actions_dice_roll": roll
            });
        });
    });
	// On Change for calculating rolls for Actions
    on("change:repeating_otheractions:action_attribute change:repeating_otheractions:dice_d20 change:repeating_otheractions:dice_modifier", function() {
        getAttrs(["repeating_otheractions_action_attribute", "repeating_otheractions_dice_d20", "repeating_otheractions_dice_modifier", "agility_score", "agility_dice_modifier", "fortitude_score", "fortitude_dice_modifier", "might_score", "might_dice_modifier", "learning_score", "learning_dice_modifier", "logic_score", "logic_dice_modifier", "perception_score", "perception_dice_modifier", "will_score", "will_dice_modifier", "deception_score", "deception_dice_modifier", "persuasion_score", "persuasion_dice_modifier", "presence_score", "presence_dice_modifier", "alteration_score", "alteration_dice_modifier", "creation_score", "creation_dice_modifier", "energy_score", "energy_dice_modifier", "entropy_score", "entropy_dice_modifier", "influence_score", "influence_dice_modifier", "movement_score", "movement_dice_modifier", "prescience_score", "prescience_dice_modifier", "protection_score", "protection_dice_modifier"], function(values) {
            var score = 0;
            if(values.repeating_otheractions_action_attribute === "Agility") {
                score = values.agility_score*1 + values.agility_dice_modifier*1;
            } else if(values.repeating_otheractions_action_attribute === "Fortitude") {
                score = values.fortitude_score*1 + values.fortitude_dice_modifier*1;
            } else if(values.repeating_otheractions_action_attribute === "Might") {
                score = values.might_score*1 + values.might_dice_modifier*1;
            } else if(values.repeating_otheractions_action_attribute === "Learning") {
                score = values.learning_score*1 + values.learning_dice_modifier*1;
            } else if(values.repeating_otheractions_action_attribute === "Logic") {
                score = values.logic_score*1 + values.logic_dice_modifier*1;
            } else if(values.repeating_otheractions_action_attribute === "Perception") {
                score = values.perception_score*1 + values.perception_dice_modifier*1;
            } else if(values.repeating_otheractions_action_attribute === "Will") {
                score = values.will_score*1 + values.will_dice_modifier*1;
            } else if(values.repeating_otheractions_action_attribute === "Deception") {
                score = values.deception_score*1 + values.deception_dice_modifier*1;
            } else if(values.repeating_otheractions_action_attribute === "Persuasion") {
                score = values.persuasion_score*1 + values.persuasion_dice_modifier*1;
            } else if(values.repeating_otheractions_action_attribute === "Presence") {
                score = values.presence_score*1 + values.presence_dice_modifier*1;
            } else if(values.repeating_otheractions_action_attribute === "Alteration") {
                score = values.alteration_score*1 + values.alteration_dice_modifier*1;
            } else if(values.repeating_otheractions_action_attribute === "Creation") {
                score = values.creation_score*1 + values.creation_dice_modifier*1;
            } else if(values.repeating_otheractions_action_attribute === "Energy") {
                score = values.energy_score*1 + values.energy_dice_modifier*1;
            } else if(values.repeating_otheractions_action_attribute === "Entropy") {
                score = values.entropy_score*1 + values.entropy_dice_modifier*1;
            } else if(values.repeating_otheractions_action_attribute === "Influence") {
                score = values.influence_score*1 + values.influence_dice_modifier*1;
            } else if(values.repeating_otheractions_action_attribute === "Movement") {
                score = values.movement_score*1 + values.movement_dice_modifier*1;
            } else if(values.repeating_otheractions_action_attribute === "Prescience") {
                score = values.prescience_score*1 + values.prescience_dice_modifier*1;
            } else if(values.repeating_otheractions_action_attribute === "Protection") {
                score = values.protection_score*1 + values.protection_dice_modifier*1;
            }
            if(isNaN(values.repeating_otheractions_dice_modifier)) {
                setAttrs({  "repeating_otheractions_dice_modifier": 0    });
            } else {
                score = score*1 + values.repeating_otheractions_dice_modifier*1;
            }
            var number = calcAttributeDiceNumber(score);
            var type = calcAttributeDiceType(score);
			var roll = "";
			if(score === 0) {
				roll = "[[?{Do you have Advantage or Disadvantage?|Neither,1d20!!|Advantage,2d20!!kh1|Disadvantage,2d20!!kl1}]]";
			} else {
			    if(isNaN(values.repeating_otheractions_dice_d20)) {
    				roll = "[[1d20!! + [[" + number + "+?{# of Advantage/Disadvantage Dice|0}]]" + type + "k?{Do you have Advantage or Disadvantage?|Neither,h|Advantage,h|Disadvantage,l}" + number + "]]";
			    } else {
    				roll = "[[" + values.repeating_otheractions_dice_d20 + " + [[" + number + "+?{# of Advantage/Disadvantage Dice|0}]]" + type + "k?{Do you have Advantage or Disadvantage?|Neither,h|Advantage,h|Disadvantage,l}" + number + "]]";
			    }
			}
            setAttrs({
                "repeating_otheractions_dice_roll": roll
            });
        });
    });
    // Calculate the total of Feat Points spent with special code from The Aaron (below)
    on("change:repeating_featsLeft", function() {
        TAS.repeatingSimpleSum('featsLeft','feat_left_cost','featLeft_points_spent')
    });
    on("change:repeating_featsRight", function() {
        TAS.repeatingSimpleSum('featsRight','feat_right_cost','featRight_points_spent')
    });
/* ---- BEGIN: TheAaronSheet.js ---- */
// Github:   https://github.com/shdwjk/TheAaronSheet/blob/master/TheAaronSheet.js
// By:       The Aaron, Arcane Scriptomancer
// Contact:  https://app.roll20.net/users/104025/the-aaron

var TAS = TAS || (function(){
    'use strict';

    var version = '0.2.4',
        lastUpdate = 1457098091,

        loggingSettings = {
            debug: {
                key:     'debug',
                title:   'DEBUG',
                color: {
                    bgLabel: '#7732A2',
                    label:   '#F2EF40',
                    bgText:  '#FFFEB7',
                    text:    '#7732A2'
                }
            },
            error: {
                key:     'error',
                title:   'Error',
                color: {
                    bgLabel: '#C11713',
                    label:   'white',
                    bgText:  '#C11713',
                    text:    'white'
                }
            },
            warn: {
                key:     'warn',
                title:   'Warning',
                color: {
                    bgLabel: '#F29140',
                    label:   'white',
                    bgText:  '#FFD8B7',
                    text:    'black'
                }
            },
            info: {
                key:     'info',
                title:   'Info',
                color: {
                    bgLabel: '#413FA9',
                    label:   'white',
                    bgText:  '#B3B2EB',
                    text:    'black'
                }
            },
            notice: {
                key:     'notice',
                title:   'Notice',
                color: {
                    bgLabel: '#33C133',
                    label:   'white',
                    bgText:  '#ADF1AD',
                    text:    'black'
                }
            },
            log: {
                key:     'log',
                title:   'Log',
                color: {
                    bgLabel: '#f2f240',
                    label:   'black',
                    bgText:  '#ffff90',
                    text:    'black'
                }
            },
            callstack: {
                key:     'TAS',
                title:   'function',
                color: {
                    bgLabel: '#413FA9',
                    label:   'white',
                    bgText:  '#B3B2EB',
                    text:    'black'
                }
            },
            callstack_async: {
                key:     'TAS',
                title:   'ASYNC CALL',
                color: {
                    bgLabel: '#413FA9',
                    label:   'white',
                    bgText:  '#413FA9',
                    text:    'white'
                }
            },
            TAS: {
                key:     'TAS',
                title:   'TAS',
                color: {
                    bgLabel: 'grey',
                    label:   'black;background:linear-gradient(#304352,#d7d2cc,#d7d2cc,#d7d2cc,#304352)',
                    bgText:  'grey',
                    text:    'black;background:linear-gradient(#304352,#d7d2cc,#d7d2cc,#d7d2cc,#304352)'
                }
            }
        },


        config = {
            debugMode: false,
            logging: {
                log: true,
                notice: true,
                info: true,
                warn: true,
                error: true,
                debug: false
            }
        },

        callstackRegistry = [],
		queuedUpdates = {}, //< Used for delaying saves till the last momment.

    complexType = function(o){
        switch(typeof o){
            case 'string':
                return 'string';
            case 'boolean':
                return 'boolean';
            case 'number':
                return (_.isNaN(o) ? 'NaN' : (o.toString().match(/\./) ? 'decimal' : 'integer'));
            case 'function':
                return 'function: '+(o.name ? o.name+'()' : '(anonymous)');
            case 'object':
                return (_.isArray(o) ? 'array' : (_.isArguments(o) ? 'arguments' : ( _.isNull(o) ? 'null' : 'object')));
            default:
                return typeof o;
        }
    },

	dataLogger = function(primaryLogger,secondaryLogger,data){
        _.each(data,function(m){
            var type = complexType(m);
            switch(type){
                case 'string':
                    primaryLogger(m);
                    break;
                case 'undefined':
                case 'null':
                case 'NaN':
                    primaryLogger('['+type+']');
                    break;
                case 'number':
                case 'not a number':
                case 'integer':
                case 'decimal':
                case 'boolean':
                    primaryLogger('['+type+']: '+m);
                    break;
                default:
                    primaryLogger('['+type+']:=========================================');
                    secondaryLogger(m);
                    primaryLogger('=========================================================');
                    break;
            }
        });
	},


    colorLog = function(options){
        var coloredLoggerFunction,
            key = options.key,
            label = options.title || 'TAS',
            lBGColor = (options.color && options.color.bgLabel) || 'blue',
            lTxtColor = (options.color && options.color.label) || 'white',
            mBGColor = (options.color && options.color.bgText) || 'blue',
            mTxtColor = (options.color && options.color.text) || 'white';

        coloredLoggerFunction = function(message){
            console.log(
                '%c '+label+': %c '+message + ' ',
                'background-color: '+lBGColor+';color: '+lTxtColor+'; font-weight:bold;',
                'background-color: '+mBGColor+';color: '+mTxtColor+';'
            ); 
        };
        return function(){
            if('TAS'===key || config.logging[key]){
               dataLogger(coloredLoggerFunction,function(m){console.log(m);},_.toArray(arguments)); 
            }
        };
    },

    logDebug  = colorLog(loggingSettings.debug),
    logError  = colorLog(loggingSettings.error),
    logWarn   = colorLog(loggingSettings.warn),
    logInfo   = colorLog(loggingSettings.info),
    logNotice = colorLog(loggingSettings.notice),
    logLog    = colorLog(loggingSettings.log),
    log       = colorLog(loggingSettings.TAS),
    logCS     = colorLog(loggingSettings.callstack),
    logCSA    = colorLog(loggingSettings.callstack_async),

    registerCallstack = function(callstack,label){
        var idx=_.findIndex(callstackRegistry,function(o){
            return (_.difference(o.stack,callstack).length === _.difference(callstack,o.stack).length) &&
                _.difference(o.stack,callstack).length === 0 &&
                o.label === label;
        });
        if(-1 === idx){
            idx=callstackRegistry.length;
            callstackRegistry.push({
                stack: callstack,
                label: label
            });
        }
        return idx;
    },

    setConfigOption = function(options){
        var newconf =_.defaults(options,config);
        newconf.logging=_.defaults(
            (options && options.logging)||{},
            config.logging
        );
        config=newconf;
    },
    
    debugMode = function(){
        config.logging.debug=true;
        config.debugMode = true;
    },

    getCallstack = function(){
        var e = new Error('dummy'),
            stack = _.map(_.rest(e.stack.replace(/^[^\(]+?[\n$]/gm, '')
            .replace(/^\s+at\s+/gm, '')
            .replace(/^Object.<anonymous>\s*\(/gm, '{anonymous}()@')
            .split('\n')),function(l){
                return l.replace(/\s+.*$/,'');
            });
        return stack;
    },
    logCallstackSub = function(cs){
        var matches, csa;
        _.find(cs,function(line){
            matches = line.match(/TAS_CALLSTACK_(\d+)/);
            if(matches){
               csa=callstackRegistry[matches[1]];
               logCSA( '===================='+(csa.label ? '> '+csa.label+' <' : '')+'====================');
               logCallstackSub(csa.stack);
               return true;
            } 
            logCS(line);
            return false;
        });
    },
    logCallstack = function(){
        var cs;
        if(config.debugMode){
            cs = getCallstack();
            cs.shift();
            log('==============================> CALLSTACK <==============================');
            logCallstackSub(cs);
            log('=========================================================================');
        }
    },


    wrapCallback = function (label, callback, context){
        var callstack;
        if('function' === typeof label){
            context=callback;
            callback=label;
            label=undefined;
        }
        if(!config.debugMode){
            return (function(cb,ctx){
                return function(){
                    cb.apply(ctx||{},arguments);
                };
            }(callback,context));
        }
        
        callstack = getCallstack();
        callstack.shift();
        
        return (function(cb,ctx,cs,lbl){
            var ctxref=registerCallstack(cs,lbl);

            /*jshint -W054 */
            return new Function('cb','ctx','TASlog',
                "return function TAS_CALLSTACK_"+ctxref+"(){"+
                    "TASlog('Entering: '+(cb.name||'(anonymous function)'));"+
                    "cb.apply(ctx||{},arguments);"+
                    "TASlog('Exiting: '+(cb.name||'(anonymous function)'));"+
                "};")(cb,ctx,log);
            /*jshint +W054 */
        }(callback,context,callstack,label));
    },


    prepareUpdate = function( attribute, value ){
        queuedUpdates[attribute]=value;
    },

    applyQueuedUpdates = function() {
      setAttrs(queuedUpdates);
      queuedUpdates = {};
    },

	namesFromArgs = function(args,base){
        return _.chain(args)
            .reduce(function(memo,attr){
                if('string' === typeof attr) {
                    memo.push(attr);
                } else if(_.isArray(args) || _.isArguments(args)){
                    memo = namesFromArgs(attr,memo);
                }
                return memo;
            },(_.isArray(base) && base) || [])
            .uniq()
            .value();
	},

	addId = function(obj,value){
		Object.defineProperty(obj,'id',{
			value: value,
			writeable: false,
			enumerable: false
		});
	},

	addProp = function(obj,prop,value,fullname){
		(function(){
            var pname=(_.contains(['S','F','I','D'],prop) ? '_'+prop : prop),
			    full_pname = fullname || prop,
                pvalue=value;

            _.each(['S','I','F'],function(p){
                if( !_.has(obj,p)){
                    Object.defineProperty(obj, p, {
                        value: {},
                        enumerable: false,
                        readonly: true
                    });
                }
            });
            if( !_.has(obj,'D')){
                Object.defineProperty(obj, 'D', {
                    value: _.reduce(_.range(10),function(m,d){
                            Object.defineProperty(m, d, {
                                value: {},
                                enumerable: true,
                                readonly: true
                            });
                            return m;
                        },{}),
                    enumerable: false,
                    readonly: true
                });
            }


            // Raw value
			Object.defineProperty(obj, pname, {
                enumerable: true,
				set: function(v){
                    if(v!==pvalue) {
                        pvalue=v;
                        prepareUpdate(full_pname,v);
                    }
				},
				get: function(){
					return pvalue;
				}
			});
            
            // string value
			Object.defineProperty(obj.S, pname, {
                enumerable: true,
				set: function(v){
                    var val=v.toString();
                    if(val !== pvalue) {
                        pvalue=val;
                        prepareUpdate(full_pname,val);
                    }
				},
				get: function(){
					return pvalue.toString();
				}
			});

            // int value
			Object.defineProperty(obj.I, pname, {
                enumerable: true,
				set: function(v){
                    var val=parseInt(v,10) || 0;
                    if(val !== pvalue){
                        pvalue=val;
                        prepareUpdate(full_pname,val);
                    }
				},
				get: function(){
					return parseInt(pvalue,10) || 0;
				}
			});

            // float value
			Object.defineProperty(obj.F, pname, {
                enumerable: true,
				set: function(v){
                    var val=parseFloat(v) || 0;
                    if(val !== pvalue) {
                        pvalue=val;
                        prepareUpdate(full_pname,val);
                    }
				},
				get: function(){
					return parseFloat(pvalue) || 0;
				}
			});
            _.each(_.range(10),function(d){
                Object.defineProperty(obj.D[d], pname, {
                    enumerable: true,
                    set: function(v){
                        var val=(parseFloat(v) || 0).toFixed(d);
                        if(val !== pvalue){
                            pvalue=val;
                            prepareUpdate(full_pname,val);
                        }
                    },
                    get: function(){
                        return (parseFloat(pvalue) || 0).toFixed(d);
                    }
                });
            });

		}());
	},
	
	repeating = function( section ) {
		return (function(s){
			var sectionName = s,
				attrNames = [],
				fieldNames = [],
				operations = [],
                after = [],
			
			repAttrs = function TAS_Repeating_Attrs(){
				attrNames = namesFromArgs(arguments,attrNames);
				return this;
			},
			repFields = function TAS_Repeating_Fields(){
				fieldNames = namesFromArgs(arguments,fieldNames);
				return this;
			},
			repReduce = function TAS_Repeating_Reduce(func, initial, final, context) { 
				operations.push({
                    type: 'reduce',
                    func: (func && _.isFunction(func) && func) || _.noop,
                    memo: (_.isUndefined(initial) && 0) || initial,
                    final: (final && _.isFunction(final) && final) || _.noop,
                    context: context || {}
                });
				return this;
			},
			repMap = function TAS_Repeating_Map(func, final, context) {
				operations.push({
                    type: 'map',
                    func: (func && _.isFunction(func) && func) || _.noop,
                    final: (final && _.isFunction(final) && final) || _.noop,
                    context: context || {}
                });
				return this;
			},
            repEach = function TAS_Repeating_Each(func, final, context) {
				operations.push({
                    type: 'each',
                    func: (func && _.isFunction(func) && func) || _.noop,
                    final: (final && _.isFunction(final) && final) || _.noop,
                    context: context || {}
                });
				return this;
            },
            repTap = function TAS_Repeating_Tap(final, context) {
				operations.push({
                    type: 'tap',
                    final: (final && _.isFunction(final) && final) || _.noop,
                    context: context || {}
                });
				return this;
            },
            repAfter = function TAS_Repeating_After(callback,context) {
				after.push({
                    callback: (callback && _.isFunction(callback) && callback) || _.noop,
                    context: context || {}
                });
				return this;
            },
			repExecute = function TAS_Repeating_Execute(callback,context){
				var rowSet = {},
					attrSet = {},
					fieldIds = [],
					fullFieldNames = [];

                repAfter(callback,context);

				// call each operation per row.
				// call each operation's final
				getSectionIDs("repeating_"+sectionName,function(ids){
					fieldIds = ids;
					fullFieldNames = _.reduce(fieldIds,function(memo,id){
						return memo.concat(_.map(fieldNames,function(name){
							return 'repeating_'+sectionName+'_'+id+'_'+name;  
						}));
					},[]);
					getAttrs( _.uniq(attrNames.concat(fullFieldNames)), function(values){
						_.each(attrNames,function(aname){
							if(values.hasOwnProperty(aname)){
								addProp(attrSet,aname,values[aname]);
							}
						});

						rowSet = _.reduce(fieldIds,function(memo,id){
							var r={};
							addId(r,id);
							_.each(fieldNames,function(name){
								var fn = 'repeating_'+sectionName+'_'+id+'_'+name;  
								addProp(r,name,values[fn],fn);
							});

							memo[id]=r;

							return memo;
						},{});

                        _.each(operations,function(op){
                            var res;
                            switch(op.type){
                                case 'tap':
                                    _.bind(op.final,op.context,rowSet,attrSet)();
                                    break;

                                case 'each':
                                    _.each(rowSet,function(r){
                                        _.bind(op.func,op.context,r,attrSet,r.id,rowSet)();
                                    });
                                    _.bind(op.final,op.context,rowSet,attrSet)();
                                    break;

                                case 'map':
                                    res = _.map(rowSet,function(r){
                                        return _.bind(op.func,op.context,r,attrSet,r.id,rowSet)();
                                    });
                                    _.bind(op.final,op.context,res,rowSet,attrSet)();
                                    break;

                                case 'reduce':
                                    res = op.memo;
                                    _.each(rowSet,function(r){
                                        res = _.bind(op.func,op.context,res,r,attrSet,r.id,rowSet)();
                                    });
                                    _.bind(op.final,op.context,res,rowSet,attrSet)();
                                    break;
                            }
                        });

                        // finalize attrs
                        applyQueuedUpdates();
                        _.each(after,function(op){
                            _.bind(op.callback,op.context)();
                        });
					});
				});
			};
				
			return {
				attrs: repAttrs,
				attr: repAttrs,

				column: repFields,
				columns: repFields,
				field: repFields,
				fields: repFields,

				reduce: repReduce,
				inject: repReduce,
				foldl: repReduce,

				map: repMap,
				collect: repMap,

				each: repEach,
                forEach: repEach,

                tap: repTap,
                'do': repTap,

				after: repAfter,
				last: repAfter,
				done: repAfter,

				execute: repExecute,
				go: repExecute,
				run: repExecute
			};
		}(section));
	},


    repeatingSimpleSum = function(section, field, destination){
        repeating(section)
            .attr(destination)
            .field(field)
            .reduce(function(m,r){
                return m + (r.F[field]);
            },0,function(t,r,a){
                a.S[destination]=t;
            })
            .execute();
    };

	console.log('%c•.¸¸.•*´¨`*•.¸¸.•*´¨`*•.¸  The Aaron Sheet  v'+version+'  ¸.•*´¨`*•.¸¸.•*´¨`*•.¸¸.•','background: linear-gradient(to right,green,white,white,green); color:black;text-shadow: 0 0 8px white;');
	console.log('%c•.¸¸.•*´¨`*•.¸¸.•*´¨`*•.¸  Last update: '+(new Date(lastUpdate*1000))+'  ¸.•*´¨`*•.¸¸.•*´¨`*•.¸¸.•','background: linear-gradient(to right,green,white,white,green); color:black;text-shadow: 0 0 8px white;');


    return {
        /* Repeating Sections */
        repeatingSimpleSum: repeatingSimpleSum,
		repeating: repeating,

        /* Configuration */
        config: setConfigOption,

        /* Debugging */
        callback: wrapCallback,
        callstack: logCallstack,
        debugMode: debugMode,
        _fn: wrapCallback,

        /* Logging */
        debug: logDebug,
        error: logError,
        warn: logWarn,
        info: logInfo,
        notice: logNotice,
        log: logLog
    };
}());

/* ---- END: TheAaronSheet.js ---- */
</script>
<!-- End Worker Scripts -->
<!-- Main body of Character Sheet -->
<div class="container">     <!-- defines the width/height & behavior of the page -->
    <div class="row width100 padBottom">
        <div class="column textSmall textRight padRight">Added Goals, Beliefs, & Instincts :: Added "Non-Essential" Inventory & Notes :: 2017.03.10 <span class="bold">Version 1.7.9 </span> <input class="settings" type="checkbox" name="attr_sheet_settings_flag" value="hide" /><span>y</span></div>
    </div>
    <div class="row width100">
        <div class="column sliders inlineBlock textSmall bold">Character Info</div>
        <div class="column sliders inlineBlock textSmall bold">Goals & Beliefs</div>
        <div class="column sliders inlineBlock textSmall bold">Attributes</div>
        <div class="column sliders inlineBlock textSmall bold">Defenses</div>
        <div class="column sliders inlineBlock textSmall bold">Health & Speed</div>
        <div class="column sliders inlineBlock textSmall bold">Sanity</div>
        <div class="column sliders inlineBlock textSmall bold">Favored Actions</div>
        <div class="column sliders inlineBlock textSmall bold">Other Actions</div>
        <div class="column sliders inlineBlock textSmall bold">Feats</div>
        <div class="column sliders inlineBlock textSmall bold">Perks & Flaws</div>
        <div class="column sliders inlineBlock textSmall bold">Inventory</div>
        <div class="column sliders inlineBlock textSmall bold">Other Inv/Notes</div>
    </div>
    <div class="row width100">
        <div class="column sliders inlineBlock">
            <div class="checkboxSlider"><input type="checkbox" class="checkboxSliderInvis" name="attr_output_character" checked="checked" value="on" /><label></label></div>   
        </div>
        <div class="column sliders inlineBlock">
            <div class="checkboxSlider"><input type="checkbox" class="checkboxSliderInvis" name="attr_output_goalsbeliefs" value="on" /><label></label></div>   
        </div>
        <div class="column sliders inlineBlock">
            <div class="checkboxSlider"><input type="checkbox" class="checkboxSliderInvis" name="attr_output_attributes" checked="checked" value="on" /><label></label></div>   
        </div>
        <div class="column sliders inlineBlock">
            <div class="checkboxSlider"><input type="checkbox" class="checkboxSliderInvis" name="attr_output_defenses" checked="checked" value="on" /><label></label></div>   
        </div>
        <div class="column sliders inlineBlock">
            <div class="checkboxSlider"><input type="checkbox" class="checkboxSliderInvis" name="attr_output_healthspeed" checked="checked" value="on" /><label></label></div>   
        </div>
        <div class="column sliders inlineBlock">
            <div class="checkboxSlider"><input type="checkbox" class="checkboxSliderInvis" name="attr_output_sanity" value="on" /><label></label></div>   
        </div>
        <div class="column sliders inlineBlock">
            <div class="checkboxSlider"><input type="checkbox" class="checkboxSliderInvis" name="attr_output_favoredactions" checked="checked" value="on" /><label></label></div>   
        </div>
        <div class="column sliders inlineBlock">
            <div class="checkboxSlider"><input type="checkbox" class="checkboxSliderInvis" name="attr_output_otheractions" checked="checked" value="on" /><label></label></div>   
        </div>
        <div class="column sliders inlineBlock">
            <div class="checkboxSlider"><input type="checkbox" class="checkboxSliderInvis" name="attr_output_feats" checked="checked" value="on" /><label></label></div>   
        </div>
        <div class="column sliders inlineBlock">
            <div class="checkboxSlider"><input type="checkbox" class="checkboxSliderInvis" name="attr_output_perksflaws" checked="checked" value="on" /><label></label></div>   
        </div>
        <div class="column sliders inlineBlock">
            <div class="checkboxSlider"><input type="checkbox" class="checkboxSliderInvis" name="attr_output_inventory" checked="checked" value="on" /><label></label></div>   
        </div>
        <div class="column sliders inlineBlock">
            <div class="checkboxSlider"><input type="checkbox" class="checkboxSliderInvis" name="attr_output_otherinventory" value="on" /><label></label></div>   
        </div>
    </div>
 <!-- section for basic Character information -->
    <input type="hidden" class="display_character_flag" name="attr_display_character_flag" value="show" />
    <div class="row width825 marginBottom displayCharacter">
        <div class="width1of3 inlineBlock">      <!-- Left Third of 2/3 rows for info (Name & Player) -->
            <div class="column width100 textCenter bold vertBottom">Character Name</div>
            <div class="column width100 textCenter inputName"><input type="text" name="attr_character_name" /></div>
            <div class="column width100 textCenter bold vertBottom">Player Name</div>
            <div class="column width100 textCenter inputName"><input type="text" name="attr_player_name" /></div>
        </div>
        <div class="width1of3 inlineBlock">      <!-- Middle Third of 2/3 rows for info (Archetype, Level, XP) -->
            <div class="column width100 textCenter bold vertBottom">Archetype</div>
            <div class="column width100 textCenter inputName"><input type="text" name="attr_archetype" /></div>
            <div class="column width1of3 inlineBlock textCenter bold vertBottom">Size</div>
            <div class="width1of3 inlineBlock">
                <div class="column width50 inlineBlock textCenter bold vertBottom">Level</div>
                <div class="column width50 inlineBlock textCenter bold vertBottom">XP</div>
            </div>
            <div class="column width1of3 inlineBlock textCenter bold vertBottom">Legend Points</div>
            <div class="column width1of3 inlineBlock textCenter inputName"><input type="text" name="attr_size" /></div>
            <div class="width1of3 inlineBlock">
                <div class="column width50 inlineBlock textCenter inputNumber30"><input type="number" name="attr_level" value=1 /></div>
                <div class="column width50 inlineBlock textCenter inputLevel"><input type="number" name="attr_xp" value=0 /></div>
            </div>
            <div class="column width1of3 inlineBlock textCenter inputNumber60"><input type="number" name="attr_legend_points" value=0 /></div>
        </div>
        <div class="width1of3 inlineBlock">      <!-- Right Third of 2/3 rows for info (Open Legend Logo) -->
            <div class="column width100 textCenter vertBottom"><img src="http://www.openlegendrpg.com/assets/img/open_legend_lg_logo.png" alt="Open Legend Open source roleplaying game" /></div>
        </div>
        <div class="width100">                   <!-- Bottom 1/3 of rows for Description of Character -->
            <div class="column width100 textLeft bold vertBottom">Description</div>
            <div class="row padBottom">
                <div class="column width100 inlineBlock textCenter vertTop resizeVert"><textarea class="width100 height50" name="attr_description"></textarea></div>
            </div>
        </div>
    </div>
 <!-- end of basic Character Information -->
 <!-- section for Goals and Beliefs information -->
    <input type="hidden" class="display_goalsbeliefs_flag" name="attr_display_goalsbeliefs_flag" value="show" />
    <div class="row marginBottom displayGoalsBeliefs">
        <div class="column bold textLarge">Character's Goals, Beliefs, and Instincts</div>
        <div class="column italic">Use this section to give you ideas to help drive your character's actions.</div>
<!-- How to Earn KP -->
        <div class="padBottom">
            <div class="column third inlineBlock vertTop">
                <div class="actionsTop padTop">
                    <div class="textCenter textLarger bold">Goals</div>
                    <div class="width90 textLarge italic textCenter inlineBlock">Include how you will know it has been accomplished.</div>
                </div>
                <div class="column actionsMiddle padTop">
                    <div class="height10"></div> <!-- Spacer -->
                    <fieldset class="repeating_goals">
                        <textarea class="resizeNone height75 width85" name="attr_goal"></textarea>
                    </fieldset>
                </div>
                <div class="actionsBottom"></div>
            </div>
            <div class="column third inlineBlock vertTop">
                <div class="actionsTop padTop">
                    <div class="textCenter textLarger bold">Beliefs</div>
                    <div class="width90 textLarge italic textCenter inlineBlock">What you believe AND what you will do about that!</div>
                </div>
                <div class="column actionsMiddle padTop">
                    <div class="height10"></div> <!-- Spacer -->
                    <fieldset class="repeating_beliefs">
                        <textarea class="resizeNone height75 width85" name="attr_belief"></textarea>
                    </fieldset>
                </div>
                <div class="actionsBottom"></div>
            </div>
            <div class="column third inlineBlock vertTop">
                <div class="actionsTop padTop">
                    <div class="textCenter textLarger bold">Instincts</div>
                    <div class="width90 textLarge italic textCenter inlineBlock">"If/Then", "Always", "Never" (usually tied to skills or gear)</div>
                </div>
                <div class="column actionsMiddle padTop">
                    <div class="height10"></div> <!-- Spacer -->
                    <fieldset class="repeating_instincts">
                        <textarea class="resizeNone height75 width85" name="attr_instinct"></textarea>
                    </fieldset>
                </div>
                <div class="actionsBottom"></div>
            </div>
        </div>
    </div>
 <!-- end section for Goals and Beliefs information -->
    <div class="row">
 <!-- Left Column for Attributes -->
   <!-- Attributes are setup so that clicking the name of the attribute will roll it -->
    <input type="hidden" class="display_attributes_flag" name="attr_display_attributes_flag" value="show" />
    <div class="third inlineBlock vertTop displayAttributes">
        <div class="attributes padTop">
            <div class="width100 height5"></div>
            <div class="column width100 textLargest bold">Attributes</div>
        </div>
        <div class="row padBottom">
            <div class="column width30 inlineBlock textCenter vertBottom bold">Total Points</div>   <!-- Track how many points you have TO spend -->
            <div class="column width20 inlineBlock textCenter vertBottom inputNumber60"><input type="number" name="attr_attribute_points" value=0 /></div>
            <div class="column width30 inlineBlock textCenter vertBottom bold">Points Spent</div>   <!-- Track how many points you HAVE spent -->
            <div class="column width20 inlineBlock textCenter vertBottom inputNumber60"><input type="number" name="attr_attribute_points_spent" value=0 /></div>
        </div>
    <!-- Physical Attributes -->
        <div class="column width100 textLeft bold textLarger gray">PHYSICAL</div>
      <!-- Header Area -->
        <div class="row width100">
            <div class="column width45 inlineBlock textSmall textLeft bold italic">Click name to Roll</div>
            <div class="width55 inlineBlock">
                <div class="column width1of3 inlineBlock textCenter bold italic">Score</div>
                <div class="column width1of3 inlineBlock textCenter bold italic">Cost</div>
                <div class="column width1of3 inlineBlock textCenter bold italic">Dice</div>
            </div>
        </div>
      <!-- Agility -->
        <div class="row width100">
            <div class="width6 inlineBlock vertBottom"><input class="settings" type="checkbox" name="attr_agility_settings_flag" value="on" /><span>y</span></div>
            <input type="hidden" class="agility_display_sub_flag" name="attr_agility_display_sub_flag" value="hide" />
            <div class="column width39 inlineBlock textLeft textLarge bold italic attributeButton sub">
                <button type="roll" value="&{template:openLegend} {{title= Agility Roll}} {{subTitle= @{character_name}}} {{roll= @{agility_dice_roll}}}">Agility</button>
            </div>
            <div class="width55 inlineBlock">
                <div class="column width1of3 inlineBlock textCenter inputNumber"><input type="number" name="attr_agility_score" value=0 /></div>
                <div class="column width1of3 inlineBlock textCenter inputNumber"><input type="number" name="attr_show_agility_cost" value="@{agility_cost}" disabled="disabled" /></div>
                <input type="hidden" name="attr_agility_dice_roll" value=0 />     <!-- hidden value of the roll button string -->
                <div class="column width1of3 inlineBlock textCenter inputDice"><input type="text" style="text-align: center;" name="attr_agility_dice" value=0 /></div>
            </div>
            <input type="hidden" class="agility_display_settings_flag" name="attr_agility_display_settings_flag" value="hide" />
            <div class="width100 displaySettings padBottom">
                <div class="column width95 inlineBlock boxShadow textSmall">Dodge attacks, move with stealth, perform acrobatics, shoot a bow, pick a pocket</div>
                <div class="column width75 inlineBlock">Attribute Dice Bonus/Penalty:</div>
                <div class="column width25 inlineBlock inputNumber30"><input type="number" name="attr_agility_dice_modifier" value=0 /></div>
                <div class="column width75 inlineBlock">Increase/Decrease cost in levels:</div>
                <div class="column width25 inlineBlock inputNumber30"><input type="number" name="attr_agility_cost_modifier" value=0 /></div>
                <div class="column width60 inlineBlock">Your d20 (non-combat rolls):</div>
                <div class="column width40 inlineBlock inputSelect">
                    <select name="attr_agility_dice_d20">
                        <option value="1d20!!" selected="selected">Normal</option>
                        <option value="2d20!!kh1">Advantage</option>
                        <option value="2d20!!kl1">Disadvantage</option>
                    </select>
                </div>
                <div class="column width60 inlineBlock">Attribute Substitution:</div>
                <div class="column width40 inlineBlock inputSelect">
                    <select name="attr_agility_substitution_select">
                        <option value="None" selected="selected">None</option>
                        <option value="Fortitude">Fortitude</option>
                        <option value="Might">Might</option>
                        <option value="Learning">Learning</option>
                        <option value="Logic">Logic</option>
                        <option value="Perception">Perception</option>
                        <option value="Will">Will</option>
                        <option value="Deception">Deception</option>
                        <option value="Persuasion">Persuasion</option>
                        <option value="Presence">Presence</option>
                        <option value="Alteration">Alteration</option>
                        <option value="Creation">Creation</option>
                        <option value="Energy">Energy</option>
                        <option value="Entropy">Entropy</option>
                        <option value="Influence">Influence</option>
                        <option value="Movement">Movement</option>
                        <option value="Prescience">Prescience</option>
                        <option value="Protection">Protection</option>
                    </select>
                </div>
                <input type="hidden" name="attr_agility_substitution" value=0 />
                <div class="column width100 bold italic">For Tier II of Attribute Substituation</div>
				<div class="column width100 italic">In the ACTIONS SECTION, select the substituted attribute instead of Agility.</div>
            </div>
        </div>
      <!-- Fortitude -->
        <div class="row width100">
            <div class="width6 inlineBlock vertBottom"><input class="settings" type="checkbox" name="attr_fortitude_settings_flag" value="on" /><span>y</span></div>
            <input type="hidden" class="agility_display_sub_flag" name="attr_fortitude_display_sub_flag" value="hide" />
            <div class="column width39 inlineBlock textLeft textLarge bold italic attributeButton sub">
                <button type="roll" value="&{template:openLegend} {{title= Fortitude Roll}} {{subTitle= @{character_name}}} {{roll= @{fortitude_dice_roll}}}">Fortitude</button>
            </div>
            <div class="width55 inlineBlock">
                <div class="column width1of3 inlineBlock textCenter inputNumber"><input type="number" name="attr_fortitude_score" value=0 /></div>
                <div class="column width1of3 inlineBlock textCenter inputNumber"><input type="number" name="attr_show_fortitude_cost" value="@{fortitude_cost}" disabled="disabled" /></div>
                <input type="hidden" name="attr_fortitude_dice_roll" value=0 />     <!-- hidden value of the roll button string -->
                <div class="column width1of3 inlineBlock textCenter inputDice"><input type="text" style="text-align: center;" name="attr_fortitude_dice" value=0 /></div>
            </div>
            <input type="hidden" class="fortitude_display_settings_flag" name="attr_fortitude_display_settings_flag" value="hide" />
            <div class="width100 displaySettings padBottom">
                <div class="column width95 inlineBlock boxShadow textSmall">Resist poison, shrug off pain, exert yourself physically, wear heavy armor</div>
                <div class="column width75 inlineBlock">Attribute Dice Bonus/Penalty:</div>
                <div class="column width25 inlineBlock inputNumber30"><input type="number" name="attr_fortitude_dice_modifier" value=0 /></div>
                <div class="column width75 inlineBlock">Increase/Decrease cost in levels:</div>
                <div class="column width25 inlineBlock inputNumber30"><input type="number" name="attr_fortitude_cost_modifier" value=0 /></div>
                <div class="column width60 inlineBlock">Your d20 (non-combat rolls):</div>
                <div class="column width40 inlineBlock inputSelect">
                    <select name="attr_fortitude_dice_d20">
                        <option value="1d20!!" selected="selected">Normal</option>
                        <option value="2d20!!kh1">Advantage</option>
                        <option value="2d20!!kl1">Disadvantage</option>
                    </select>
                </div>
                <div class="column width60 inlineBlock">Attribute Substitution:</div>
                <div class="column width40 inlineBlock inputSelect">
                    <select name="attr_fortitude_substitution_select">
                        <option value="None" selected="selected">None</option>
                        <option value="Agility">Agility</option>
                        <option value="Might">Might</option>
                        <option value="Learning">Learning</option>
                        <option value="Logic">Logic</option>
                        <option value="Perception">Perception</option>
                        <option value="Will">Will</option>
                        <option value="Deception">Deception</option>
                        <option value="Persuasion">Persuasion</option>
                        <option value="Presence">Presence</option>
                        <option value="Alteration">Alteration</option>
                        <option value="Creation">Creation</option>
                        <option value="Energy">Energy</option>
                        <option value="Entropy">Entropy</option>
                        <option value="Influence">Influence</option>
                        <option value="Movement">Movement</option>
                        <option value="Prescience">Prescience</option>
                        <option value="Protection">Protection</option>
                    </select>
                </div>
                <input type="hidden" name="attr_fortitude_substitution" value=0 />
                <div class="column width100 bold italic">For Tier II of Attribute Substituation</div>
				<div class="column width100 italic">In the ACTIONS SECTION(s), select the substituted attribute instead of Fortitude.</div>
            </div>
        </div>
      <!-- Might -->
        <div class="row width100">
            <div class="width6 inlineBlock vertBottom"><input class="settings" type="checkbox" name="attr_might_settings_flag" value="on" /><span>y</span></div>
            <input type="hidden" class="agility_display_sub_flag" name="attr_might_display_sub_flag" value="hide" />
            <div class="column width39 inlineBlock textLeft textLarge bold italic attributeButton sub">
                <button type="roll" value="&{template:openLegend} {{title= Might Roll}} {{subTitle= @{character_name}}} {{roll= @{might_dice_roll}}}">Might</button>
            </div>
            <div class="width55 inlineBlock">
                <div class="column width1of3 inlineBlock textCenter inputNumber"><input type="number" name="attr_might_score" value=0 /></div>
                <div class="column width1of3 inlineBlock textCenter inputNumber"><input type="number" name="attr_show_might_cost" value="@{might_cost}" disabled="disabled" /></div>
                <input type="hidden" name="attr_might_dice_roll" value=0 />     <!-- hidden value of the roll button string -->
                <div class="column width1of3 inlineBlock textCenter inputDice"><input type="text" style="text-align: center;" name="attr_might_dice" value=0 /></div>
            </div>
            <input type="hidden" class="might_display_settings_flag" name="attr_might_display_settings_flag" value="hide" />
            <div class="width100 displaySettings padBottom">
                <div class="column width95 inlineBlock boxShadow textSmall">Shake off attacks, swing a maul, jump over a chasm, break down a door, wrestle a foe to submission</div>
                <div class="column width75 inlineBlock">Attribute Dice Bonus/Penalty:</div>
                <div class="column width25 inlineBlock inputNumber30"><input type="number" name="attr_might_dice_modifier" value=0 /></div>
                <div class="column width75 inlineBlock">Increase/Decrease cost in levels:</div>
                <div class="column width25 inlineBlock inputNumber30"><input type="number" name="attr_might_cost_modifier" value=0 /></div>
                <div class="column width60 inlineBlock">Your d20 (non-combat rolls):</div>
                <div class="column width40 inlineBlock inputSelect">
                    <select name="attr_might_dice_d20">
                        <option value="1d20!!" selected="selected">Normal</option>
                        <option value="2d20!!kh1">Advantage</option>
                        <option value="2d20!!kl1">Disadvantage</option>
                    </select>
                </div>
                <div class="column width60 inlineBlock">Attribute Substitution:</div>
                <div class="column width40 inlineBlock inputSelect">
                    <select name="attr_might_substitution_select">
                        <option value="None" selected="selected">None</option>
                        <option value="Agility">Agility</option>
                        <option value="Fortitude">Fortitude</option>
                        <option value="Learning">Learning</option>
                        <option value="Logic">Logic</option>
                        <option value="Perception">Perception</option>
                        <option value="Will">Will</option>
                        <option value="Deception">Deception</option>
                        <option value="Persuasion">Persuasion</option>
                        <option value="Presence">Presence</option>
                        <option value="Alteration">Alteration</option>
                        <option value="Creation">Creation</option>
                        <option value="Energy">Energy</option>
                        <option value="Entropy">Entropy</option>
                        <option value="Influence">Influence</option>
                        <option value="Movement">Movement</option>
                        <option value="Prescience">Prescience</option>
                        <option value="Protection">Protection</option>
                    </select>
                </div>
                <input type="hidden" name="attr_might_substitution" value=0 />
                <div class="column width90 inlineBlock">Substitution affects Max Heavy Carry</div>
                <div class="column width10 inlineBlock"><input type="checkbox" class="checks25" name="attr_might_substitution_heavy" /></div>
                <div class="column width100 bold italic">For Tier II of Attribute Substituation</div>
				<div class="column width100 italic">In the ACTIONS SECTION, select the substituted attribute instead of Might.</div>
            </div>
        </div>
    <!-- end of physical attributes -->
    <!-- Social Attributes -->
        <div class="column width100 textLeft bold textLarger gray">SOCIAL</div>
      <!-- Header Area -->
        <div class="row width100">
            <div class="column width45 inlineBlock textSmall textLeft bold italic">Click name to Roll</div>
            <div class="width55 inlineBlock">
                <div class="column width1of3 inlineBlock textCenter bold italic">Score</div>
                <div class="column width1of3 inlineBlock textCenter bold italic">Cost</div>
                <div class="column width1of3 inlineBlock textCenter bold italic">Dice</div>
            </div>
        </div>
      <!-- Deception -->
        <div class="row width100">
            <div class="width6 inlineBlock vertBottom"><input class="settings" type="checkbox" name="attr_deception_settings_flag" value="on" /><span>y</span></div>
            <input type="hidden" class="deception_display_sub_flag" name="attr_deception_display_sub_flag" value="hide" />
            <div class="column width39 inlineBlock textLeft textLarge bold italic attributeButton sub">
                <button type="roll" value="&{template:openLegend} {{title= Deception Roll}} {{subTitle= @{character_name}}} {{roll= @{deception_dice_roll}}}">Deception</button>
            </div>
            <div class="width55 inlineBlock">
                <div class="column width1of3 inlineBlock textCenter inputNumber"><input type="number" name="attr_deception_score" value=0 /></div>
                <div class="column width1of3 inlineBlock textCenter inputNumber"><input type="number" name="attr_show_deception_cost" value="@{deception_cost}" disabled="disabled" /></div>
                <input type="hidden" name="attr_deception_dice_roll" value=0 />     <!-- hidden value of the roll button string -->
                <div class="column width1of3 inlineBlock textCenter inputDice"><input type="text" style="text-align: center;" name="attr_deception_dice" value=0 /></div>
            </div>
            <input type="hidden" class="deception_display_settings_flag" name="attr_deception_display_settings_flag" value="hide" />
            <div class="width100 displaySettings padBottom">
                <div class="column width95 inlineBlock boxShadow textSmall">Tell a lie, bluff at cards, disguise yourself, spread rumors, swindle a sucker</div>
                <div class="column width75 inlineBlock">Attribute Dice Bonus/Penalty:</div>
                <div class="column width25 inlineBlock inputNumber30"><input type="number" name="attr_deception_dice_modifier" value=0 /></div>
                <div class="column width75 inlineBlock">Increase/Decrease cost in levels:</div>
                <div class="column width25 inlineBlock inputNumber30"><input type="number" name="attr_deception_cost_modifier" value=0 /></div>
                <div class="column width60 inlineBlock">Your d20 (non-combat rolls):</div>
                <div class="column width40 inlineBlock inputSelect">
                    <select name="attr_deception_dice_d20">
                        <option value="1d20!!" selected="selected">Normal</option>
                        <option value="2d20!!kh1">Advantage</option>
                        <option value="2d20!!kl1">Disadvantage</option>
                    </select>
                </div>
                <div class="column width60 inlineBlock">Attribute Substitution:</div>
                <div class="column width40 inlineBlock inputSelect">
                    <select name="attr_deception_substitution_select">
                        <option value="None" selected="selected">None</option>
                        <option value="Agility">Agility</option>
                        <option value="Fortitude">Fortitude</option>
                        <option value="Might">Might</option>
                        <option value="Learning">Learning</option>
                        <option value="Logic">Logic</option>
                        <option value="Perception">Perception</option>
                        <option value="Will">Will</option>
                        <option value="Persuasion">Persuasion</option>
                        <option value="Presence">Presence</option>
                        <option value="Alteration">Alteration</option>
                        <option value="Creation">Creation</option>
                        <option value="Energy">Energy</option>
                        <option value="Entropy">Entropy</option>
                        <option value="Influence">Influence</option>
                        <option value="Movement">Movement</option>
                        <option value="Prescience">Prescience</option>
                        <option value="Protection">Protection</option>
                    </select>
                </div>
                <input type="hidden" name="attr_deception_substitution" value=0 />
                <div class="column width100 bold italic">For Tier II of Attribute Substituation</div>
				<div class="column width100 italic">In the ACTIONS SECTION(s), select the substituted attribute instead of Fortitude.</div>
            </div>
        </div>
      <!-- Presence -->
        <div class="row width100">
            <div class="width6 inlineBlock vertBottom"><input class="settings" type="checkbox" name="attr_presence_settings_flag" value="on" /><span>y</span></div>
            <input type="hidden" class="presence_display_sub_flag" name="attr_presence_display_sub_flag" value="hide" />
            <div class="column width39 inlineBlock textLeft textLarge bold italic attributeButton sub">
                <button type="roll" value="&{template:openLegend} {{title= Presence Roll}} {{subTitle= @{character_name}}} {{roll= @{presence_dice_roll}}}">Presence</button>
            </div>
            <div class="width55 inlineBlock">
                <div class="column width1of3 inlineBlock textCenter inputNumber"><input type="number" name="attr_presence_score" value=0 /></div>
                <div class="column width1of3 inlineBlock textCenter inputNumber"><input type="number" name="attr_show_presence_cost" value="@{presence_cost}" disabled="disabled" /></div>
                <input type="hidden" name="attr_presence_dice_roll" value=0 />     <!-- hidden value of the roll button string -->
                <div class="column width1of3 inlineBlock textCenter inputDice"><input type="text" style="text-align: center;" name="attr_presence_dice" value=0 /></div>
            </div>
            <input type="hidden" class="presence_display_settings_flag" name="attr_presence_display_settings_flag" value="hide" />
            <div class="width100 displaySettings padBottom">
                <div class="column width95 inlineBlock boxShadow textSmall">Give a speech, sing a song, inspire an army, exert your force of personality, have luck smile upon you</div>
                <div class="column width75 inlineBlock">Attribute Dice Bonus/Penalty:</div>
                <div class="column width25 inlineBlock inputNumber30"><input type="number" name="attr_presence_dice_modifier" value=0 /></div>
                <div class="column width75 inlineBlock">Increase/Decrease cost in levels:</div>
                <div class="column width25 inlineBlock inputNumber30"><input type="number" name="attr_presence_cost_modifier" value=0 /></div>
                <div class="column width60 inlineBlock">Your d20 (non-combat rolls):</div>
                <div class="column width40 inlineBlock inputSelect">
                    <select name="attr_presence_dice_d20">
                        <option value="1d20!!" selected="selected">Normal</option>
                        <option value="2d20!!kh1">Advantage</option>
                        <option value="2d20!!kl1">Disadvantage</option>
                    </select>
                </div>
                <div class="column width60 inlineBlock">Attribute Substitution:</div>
                <div class="column width40 inlineBlock inputSelect">
                    <select name="attr_presence_substitution_select">
                        <option value="None" selected="selected">None</option>
                        <option value="Agility">Agility</option>
                        <option value="Fortitude">Fortitude</option>
                        <option value="Might">Might</option>
                        <option value="Learning">Learning</option>
                        <option value="Logic">Logic</option>
                        <option value="Perception">Perception</option>
                        <option value="Will">Will</option>
                        <option value="Deception">Deception</option>
                        <option value="Persuasion">Persuasion</option>
                        <option value="Alteration">Alteration</option>
                        <option value="Creation">Creation</option>
                        <option value="Energy">Energy</option>
                        <option value="Entropy">Entropy</option>
                        <option value="Influence">Influence</option>
                        <option value="Movement">Movement</option>
                        <option value="Prescience">Prescience</option>
                        <option value="Protection">Protection</option>
                    </select>
                </div>
                <input type="hidden" name="attr_presence_substitution" value=0 />
                <div class="column width100 bold italic">For Tier II of Attribute Substituation</div>
				<div class="column width100 italic">In the ACTIONS SECTION(s), select the substituted attribute instead of Fortitude.</div>
            </div>
        </div>
      <!-- Persuasion -->
        <div class="row width100">
            <div class="width6 inlineBlock vertBottom"><input class="settings" type="checkbox" name="attr_persuasion_settings_flag" value="on" /><span>y</span></div>
            <input type="hidden" class="persuasion_display_sub_flag" name="attr_persuasion_display_sub_flag" value="hide" />
            <div class="column width39 inlineBlock textLeft textLarge bold italic attributeButton sub">
                <button type="roll" value="&{template:openLegend} {{title= Persuasion Roll}} {{subTitle= @{character_name}}} {{roll= @{persuasion_dice_roll}}}">Persuasion</button>
            </div>
            <div class="width55 inlineBlock">
                <div class="column width1of3 inlineBlock textCenter inputNumber"><input type="number" name="attr_persuasion_score" value=0 /></div>
                <div class="column width1of3 inlineBlock textCenter inputNumber"><input type="number" name="attr_show_persuasion_cost" value="@{persuasion_cost}" disabled="disabled" /></div>
                <input type="hidden" name="attr_persuasion_dice_roll" value=0 />     <!-- hidden value of the roll button string -->
                <div class="column width1of3 inlineBlock textCenter inputDice"><input type="text" style="text-align: center;" name="attr_persuasion_dice" value=0 /></div>
            </div>
            <input type="hidden" class="persuasion_display_settings_flag" name="attr_persuasion_display_settings_flag" value="hide" />
            <div class="width100 displaySettings padBottom">
                <div class="column width95 inlineBlock boxShadow textSmall">Negotiate a deal, convince someone, haggle a good price, pry information</div>
                <div class="column width75 inlineBlock">Attribute Dice Bonus/Penalty:</div>
                <div class="column width25 inlineBlock inputNumber30"><input type="number" name="attr_persuasion_dice_modifier" value=0 /></div>
                <div class="column width75 inlineBlock">Increase/Decrease cost in levels:</div>
                <div class="column width25 inlineBlock inputNumber30"><input type="number" name="attr_persuasion_cost_modifier" value=0 /></div>
                <div class="column width60 inlineBlock">Your d20 (non-combat rolls):</div>
                <div class="column width40 inlineBlock inputSelect">
                    <select name="attr_persuasion_dice_d20">
                        <option value="1d20!!" selected="selected">Normal</option>
                        <option value="2d20!!kh1">Advantage</option>
                        <option value="2d20!!kl1">Disadvantage</option>
                    </select>
                </div>
                <div class="column width60 inlineBlock">Attribute Substitution:</div>
                <div class="column width40 inlineBlock inputSelect">
                    <select name="attr_persuasion_substitution_select">
                        <option value="None" selected="selected">None</option>
                        <option value="Agility">Agility</option>
                        <option value="Fortitude">Fortitude</option>
                        <option value="Might">Might</option>
                        <option value="Learning">Learning</option>
                        <option value="Logic">Logic</option>
                        <option value="Perception">Perception</option>
                        <option value="Will">Will</option>
                        <option value="Deception">Deception</option>
                        <option value="Presence">Presence</option>
                        <option value="Alteration">Alteration</option>
                        <option value="Creation">Creation</option>
                        <option value="Energy">Energy</option>
                        <option value="Entropy">Entropy</option>
                        <option value="Influence">Influence</option>
                        <option value="Movement">Movement</option>
                        <option value="Prescience">Prescience</option>
                        <option value="Protection">Protection</option>
                    </select>
                </div>
                <input type="hidden" name="attr_persuasion_substitution" value=0 />
                <div class="column width100 bold italic">For Tier II of Attribute Substituation</div>
				<div class="column width100 italic">In the ACTIONS SECTION(s), select the substituted attribute instead of Fortitude.</div>
            </div>
        </div>
    <!-- end of Social attributes -->
    <!-- Mental Attributes -->
        <div class="column width100 textLeft bold textLarger gray">MENTAL</div>
      <!-- Header Area -->
        <div class="row width100">
            <div class="column width45 inlineBlock textSmall textLeft bold italic">Click name to Roll</div>
            <div class="width55 inlineBlock">
                <div class="column width1of3 inlineBlock textCenter bold italic">Score</div>
                <div class="column width1of3 inlineBlock textCenter bold italic">Cost</div>
                <div class="column width1of3 inlineBlock textCenter bold italic">Dice</div>
            </div>
        </div>
      <!-- Learning -->
        <div class="row width100">
            <div class="width6 inlineBlock vertBottom"><input class="settings" type="checkbox" name="attr_learning_settings_flag" value="on" /><span>y</span></div>
            <input type="hidden" class="learning_display_sub_flag" name="attr_learning_display_sub_flag" value="hide" />
            <div class="column width39 inlineBlock textLeft textLarge bold italic attributeButton sub">
                <button type="roll" value="&{template:openLegend} {{title= Learning Roll}} {{subTitle= @{character_name}}} {{roll= @{learning_dice_roll}}}">Learning</button>
            </div>
            <div class="width55 inlineBlock">
                <div class="column width1of3 inlineBlock textCenter inputNumber"><input type="number" name="attr_learning_score" value=0 /></div>
                <div class="column width1of3 inlineBlock textCenter inputNumber"><input type="number" name="attr_show_learning_cost" value="@{learning_cost}" disabled="disabled" /></div>
                <input type="hidden" name="attr_learning_dice_roll" value=0 />     <!-- hidden value of the roll button string -->
                <div class="column width1of3 inlineBlock textCenter inputDice"><input type="text" style="text-align: center;" name="attr_learning_dice" value=0 /></div>
            </div>
            <input type="hidden" class="learning_display_settings_flag" name="attr_learning_display_settings_flag" value="hide" />
            <div class="width100 displaySettings padBottom">
                <div class="column width95 inlineBlock boxShadow textSmall">Recall facts about history, arcane magic, the natural world, etc.</div>
                <div class="column width75 inlineBlock">Attribute Dice Bonus/Penalty:</div>
                <div class="column width25 inlineBlock inputNumber30"><input type="number" name="attr_learning_dice_modifier" value=0 /></div>
                <div class="column width75 inlineBlock">Increase/Decrease cost in levels:</div>
                <div class="column width25 inlineBlock inputNumber30"><input type="number" name="attr_learning_cost_modifier" value=0 /></div>
                <div class="column width60 inlineBlock">Your d20 (non-combat rolls):</div>
                <div class="column width40 inlineBlock inputSelect">
                    <select name="attr_learning_dice_d20">
                        <option value="1d20!!" selected="selected">Normal</option>
                        <option value="2d20!!kh1">Advantage</option>
                        <option value="2d20!!kl1">Disadvantage</option>
                    </select>
                </div>
                <div class="column width60 inlineBlock">Attribute Substitution:</div>
                <div class="column width40 inlineBlock inputSelect">
                    <select name="attr_learning_substitution_select">
                        <option value="None" selected="selected">None</option>
                        <option value="Agility">Agility</option>
                        <option value="Fortitude">Fortitude</option>
                        <option value="Might">Might</option>
                        <option value="Logic">Logic</option>
                        <option value="Perception">Perception</option>
                        <option value="Will">Will</option>
                        <option value="Deception">Deception</option>
                        <option value="Persuasion">Persuasion</option>
                        <option value="Presence">Presence</option>
                        <option value="Alteration">Alteration</option>
                        <option value="Creation">Creation</option>
                        <option value="Energy">Energy</option>
                        <option value="Entropy">Entropy</option>
                        <option value="Influence">Influence</option>
                        <option value="Movement">Movement</option>
                        <option value="Prescience">Prescience</option>
                        <option value="Protection">Protection</option>
                    </select>
                </div>
                <input type="hidden" name="attr_learning_substitution" value=0 />
                <div class="column width100 bold italic">For Tier II of Attribute Substituation</div>
				<div class="column width100 italic">In the ACTIONS SECTION(s), select the substituted attribute instead of Fortitude.</div>
            </div>
        </div>
      <!-- Logic -->
        <div class="row width100">
            <div class="width6 inlineBlock vertBottom"><input class="settings" type="checkbox" name="attr_logic_settings_flag" value="on" /><span>y</span></div>
            <input type="hidden" class="logic_display_sub_flag" name="attr_logic_display_sub_flag" value="hide" />
            <div class="column width39 inlineBlock textLeft textLarge bold italic attributeButton sub">
                <button type="roll" value="&{template:openLegend} {{title= Logic Roll}} {{subTitle= @{character_name}}} {{roll= @{logic_dice_roll}}}">Logic</button>
            </div>
            <div class="width55 inlineBlock">
                <div class="column width1of3 inlineBlock textCenter inputNumber"><input type="number" name="attr_logic_score" value=0 /></div>
                <div class="column width1of3 inlineBlock textCenter inputNumber"><input type="number" name="attr_show_logic_cost" value="@{logic_cost}" disabled="disabled" /></div>
                <input type="hidden" name="attr_logic_dice_roll" value=0 />     <!-- hidden value of the roll button string -->
                <div class="column width1of3 inlineBlock textCenter inputDice"><input type="text" style="text-align: center;" name="attr_logic_dice" value=0 /></div>
            </div>
            <input type="hidden" class="logic_display_settings_flag" name="attr_logic_display_settings_flag" value="hide" />
            <div class="width100 displaySettings padBottom">
                <div class="column width95 inlineBlock boxShadow textSmall">Solve riddles, decipher a code, improvise a tool, understand the enemy’s strategy, find a loophole</div>
                <div class="column width75 inlineBlock">Attribute Dice Bonus/Penalty:</div>
                <div class="column width25 inlineBlock inputNumber30"><input type="number" name="attr_logic_dice_modifier" value=0 /></div>
                <div class="column width75 inlineBlock">Increase/Decrease cost in levels:</div>
                <div class="column width25 inlineBlock inputNumber30"><input type="number" name="attr_logic_cost_modifier" value=0 /></div>
                <div class="column width60 inlineBlock">Your d20 (non-combat rolls):</div>
                <div class="column width40 inlineBlock inputSelect">
                    <select name="attr_logic_dice_d20">
                        <option value="1d20!!" selected="selected">Normal</option>
                        <option value="2d20!!kh1">Advantage</option>
                        <option value="2d20!!kl1">Disadvantage</option>
                    </select>
                </div>
                <div class="column width60 inlineBlock">Attribute Substitution:</div>
                <div class="column width40 inlineBlock inputSelect">
                    <select name="attr_logic_substitution_select">
                        <option value="None" selected="selected">None</option>
                        <option value="Agility">Agility</option>
                        <option value="Fortitude">Fortitude</option>
                        <option value="Might">Might</option>
                        <option value="Learning">Learning</option>
                        <option value="Perception">Perception</option>
                        <option value="Will">Will</option>
                        <option value="Deception">Deception</option>
                        <option value="Persuasion">Persuasion</option>
                        <option value="Presence">Presence</option>
                        <option value="Alteration">Alteration</option>
                        <option value="Creation">Creation</option>
                        <option value="Energy">Energy</option>
                        <option value="Entropy">Entropy</option>
                        <option value="Influence">Influence</option>
                        <option value="Movement">Movement</option>
                        <option value="Prescience">Prescience</option>
                        <option value="Protection">Protection</option>
                    </select>
                </div>
                <input type="hidden" name="attr_logic_substitution" value=0 />
                <div class="column width100 bold italic">For Tier II of Attribute Substituation</div>
				<div class="column width100 italic">In the ACTIONS SECTION(s), select the substituted attribute instead of Fortitude.</div>
            </div>
        </div>
      <!-- Perception -->
        <div class="row width100">
            <div class="width6 inlineBlock vertBottom"><input class="settings" type="checkbox" name="attr_perception_settings_flag" value="on" /><span>y</span></div>
            <input type="hidden" class="perception_display_sub_flag" name="attr_perception_display_sub_flag" value="hide" />
            <div class="column width39 inlineBlock textLeft textLarge bold italic attributeButton sub">
                <button type="roll" value="&{template:openLegend} {{title= Perception Roll}} {{subTitle= @{character_name}}} {{roll= @{perception_dice_roll}}}">Perception</button>
            </div>
            <div class="width55 inlineBlock">
                <div class="column width1of3 inlineBlock textCenter inputNumber"><input type="number" name="attr_perception_score" value=0 /></div>
                <div class="column width1of3 inlineBlock textCenter inputNumber"><input type="number" name="attr_show_perception_cost" value="@{perception_cost}" disabled="disabled" /></div>
                <input type="hidden" name="attr_perception_dice_roll" value=0 />     <!-- hidden value of the roll button string -->
                <div class="column width1of3 inlineBlock textCenter inputDice"><input type="text" style="text-align: center;" name="attr_perception_dice" value=0 /></div>
            </div>
            <input type="hidden" class="perception_display_settings_flag" name="attr_perception_display_settings_flag" value="hide" />
            <div class="width100 displaySettings padBottom">
                <div class="column width95 inlineBlock boxShadow textSmall">Sense ulterior motives, track someone, catch a gut feeling, spot a hidden foe, find a secret door</div>
                <div class="column width75 inlineBlock">Attribute Dice Bonus/Penalty:</div>
                <div class="column width25 inlineBlock inputNumber30"><input type="number" name="attr_perception_dice_modifier" value=0 /></div>
                <div class="column width75 inlineBlock">Increase/Decrease cost in levels:</div>
                <div class="column width25 inlineBlock inputNumber30"><input type="number" name="attr_perception_cost_modifier" value=0 /></div>
                <div class="column width60 inlineBlock">Your d20 (non-combat rolls):</div>
                <div class="column width40 inlineBlock inputSelect">
                    <select name="attr_perception_dice_d20">
                        <option value="1d20!!" selected="selected">Normal</option>
                        <option value="2d20!!kh1">Advantage</option>
                        <option value="2d20!!kl1">Disadvantage</option>
                    </select>
                </div>
                <div class="column width60 inlineBlock">Attribute Substitution:</div>
                <div class="column width40 inlineBlock inputSelect">
                    <select name="attr_perception_substitution_select">
                        <option value="None" selected="selected">None</option>
                        <option value="Agility">Agility</option>
                        <option value="Fortitude">Fortitude</option>
                        <option value="Might">Might</option>
                        <option value="Learning">Learning</option>
                        <option value="Logic">Logic</option>
                        <option value="Will">Will</option>
                        <option value="Deception">Deception</option>
                        <option value="Persuasion">Persuasion</option>
                        <option value="Presence">Presence</option>
                        <option value="Alteration">Alteration</option>
                        <option value="Creation">Creation</option>
                        <option value="Energy">Energy</option>
                        <option value="Entropy">Entropy</option>
                        <option value="Influence">Influence</option>
                        <option value="Movement">Movement</option>
                        <option value="Prescience">Prescience</option>
                        <option value="Protection">Protection</option>
                    </select>
                </div>
                <input type="hidden" name="attr_perception_substitution" value=0 />
                <div class="column width100 bold italic">For Tier II of Attribute Substituation</div>
				<div class="column width100 italic">In the ACTIONS SECTION(s), select the substituted attribute instead of Fortitude.</div>
            </div>
        </div>
      <!-- Will -->
        <div class="row width100">
            <div class="width6 inlineBlock vertBottom"><input class="settings" type="checkbox" name="attr_will_settings_flag" value="on" /><span>y</span></div>
            <input type="hidden" class="will_display_sub_flag" name="attr_will_display_sub_flag" value="hide" />
            <div class="column width39 inlineBlock textLeft textLarge bold italic attributeButton sub">
                <button type="roll" value="&{template:openLegend} {{title= Will Roll}} {{subTitle= @{character_name}}} {{roll= @{will_dice_roll}}}">Will</button>
            </div>
            <div class="width55 inlineBlock">
                <div class="column width1of3 inlineBlock textCenter inputNumber"><input type="number" name="attr_will_score" value=0 /></div>
                <div class="column width1of3 inlineBlock textCenter inputNumber"><input type="number" name="attr_show_will_cost" value="@{will_cost}" disabled="disabled" /></div>
                <input type="hidden" name="attr_will_dice_roll" value=0 />     <!-- hidden value of the roll button string -->
                <div class="column width1of3 inlineBlock textCenter inputDice"><input type="text" style="text-align: center;" name="attr_will_dice" value=0 /></div>
            </div>
            <input type="hidden" class="will_display_settings_flag" name="attr_will_display_settings_flag" value="hide" />
            <div class="width100 displaySettings padBottom">
                <div class="column width95 inlineBlock boxShadow textSmall">Maintain your resolve, overcome adversity, resist torture, stay awake on watch, stave off insanity</div>
                <div class="column width75 inlineBlock">Attribute Dice Bonus/Penalty:</div>
                <div class="column width25 inlineBlock inputNumber30"><input type="number" name="attr_will_dice_modifier" value=0 /></div>
                <div class="column width75 inlineBlock">Increase/Decrease cost in levels:</div>
                <div class="column width25 inlineBlock inputNumber30"><input type="number" name="attr_will_cost_modifier" value=0 /></div>
                <div class="column width60 inlineBlock">Your d20 (non-combat rolls):</div>
                <div class="column width40 inlineBlock inputSelect">
                    <select name="attr_will_dice_d20">
                        <option value="1d20!!" selected="selected">Normal</option>
                        <option value="2d20!!kh1">Advantage</option>
                        <option value="2d20!!kl1">Disadvantage</option>
                    </select>
                </div>
                <div class="column width60 inlineBlock">Attribute Substitution:</div>
                <div class="column width40 inlineBlock inputSelect">
                    <select name="attr_will_substitution_select">
                        <option value="None" selected="selected">None</option>
                        <option value="Agility">Agility</option>
                        <option value="Fortitude">Fortitude</option>
                        <option value="Might">Might</option>
                        <option value="Learning">Learning</option>
                        <option value="Logic">Logic</option>
                        <option value="Perception">Perception</option>
                        <option value="Deception">Deception</option>
                        <option value="Persuasion">Persuasion</option>
                        <option value="Presence">Presence</option>
                        <option value="Alteration">Alteration</option>
                        <option value="Creation">Creation</option>
                        <option value="Energy">Energy</option>
                        <option value="Entropy">Entropy</option>
                        <option value="Influence">Influence</option>
                        <option value="Movement">Movement</option>
                        <option value="Prescience">Prescience</option>
                        <option value="Protection">Protection</option>
                    </select>
                </div>
                <input type="hidden" name="attr_will_substitution" value=0 />
                <div class="column width100 bold italic">For Tier II of Attribute Substituation</div>
				<div class="column width100 italic">In the ACTIONS SECTION(s), select the substituted attribute instead of Fortitude.</div>
            </div>
        </div>
    <!-- end mental attributes -->
    <!-- Extraordinary Attributes -->
        <div class="column width100 textLeft bold textLarger gray">EXTRAORDINARY</div>
      <!-- Header Area -->
        <div class="row width100">
            <div class="column width45 inlineBlock textSmall textLeft bold italic">Click name to Roll</div>
            <div class="width55 inlineBlock">
                <div class="column width1of3 inlineBlock textCenter bold italic">Score</div>
                <div class="column width1of3 inlineBlock textCenter bold italic">Cost</div>
                <div class="column width1of3 inlineBlock textCenter bold italic">Dice</div>
            </div>
        </div>
      <!-- Alteration -->
        <div class="row width100">
            <div class="width6 inlineBlock vertBottom"><input class="settings" type="checkbox" name="attr_alteration_settings_flag" value="on" /><span>y</span></div>
            <input type="hidden" class="alteration_display_sub_flag" name="attr_alteration_display_sub_flag" value="hide" />
            <div class="column width39 inlineBlock textLeft textLarge bold italic attributeButton sub">
                <button type="roll" value="&{template:openLegend} {{title= Alteration Roll}} {{subTitle= @{character_name}}} {{roll= @{alteration_dice_roll}}}">Alteration</button>
            </div>
            <div class="width55 inlineBlock">
                <div class="column width1of3 inlineBlock textCenter inputNumber"><input type="number" name="attr_alteration_score" value=0 /></div>
                <div class="column width1of3 inlineBlock textCenter inputNumber"><input type="number" name="attr_show_alteration_cost" value="@{alteration_cost}" disabled="disabled" /></div>
                <input type="hidden" name="attr_alteration_dice_roll" value=0 />     <!-- hidden value of the roll button string -->
                <div class="column width1of3 inlineBlock textCenter inputDice"><input type="text" style="text-align: center;" name="attr_alteration_dice" value=0 /></div>
            </div>
            <input type="hidden" class="alteration_display_settings_flag" name="attr_alteration_display_settings_flag" value="hide" />
            <div class="width100 displaySettings padBottom">
                <div class="column width95 inlineBlock boxShadow textSmall">Change shape, alter molecular structures, transmute one material into another</div>
                <div class="column width75 inlineBlock">Attribute Dice Bonus/Penalty:</div>
                <div class="column width25 inlineBlock inputNumber30"><input type="number" name="attr_alteration_dice_modifier" value=0 /></div>
                <div class="column width75 inlineBlock">Increase/Decrease cost in levels:</div>
                <div class="column width25 inlineBlock inputNumber30"><input type="number" name="attr_alteration_cost_modifier" value=0 /></div>
                <div class="column width60 inlineBlock">Your d20 (non-combat rolls):</div>
                <div class="column width40 inlineBlock inputSelect">
                    <select name="attr_alteration_dice_d20">
                        <option value="1d20!!" selected="selected">Normal</option>
                        <option value="2d20!!kh1">Advantage</option>
                        <option value="2d20!!kl1">Disadvantage</option>
                    </select>
                </div>
                <div class="column width60 inlineBlock">Attribute Substitution:</div>
                <div class="column width40 inlineBlock inputSelect">
                    <select name="attr_alteration_substitution_select">
                        <option value="None" selected="selected">None</option>
                        <option value="Agility">Agility</option>
                        <option value="Fortitude">Fortitude</option>
                        <option value="Might">Might</option>
                        <option value="Learning">Learning</option>
                        <option value="Logic">Logic</option>
                        <option value="Perception">Perception</option>
                        <option value="Will">Will</option>
                        <option value="Deception">Deception</option>
                        <option value="Persuasion">Persuasion</option>
                        <option value="Presence">Presence</option>
                        <option value="Creation">Creation</option>
                        <option value="Energy">Energy</option>
                        <option value="Entropy">Entropy</option>
                        <option value="Influence">Influence</option>
                        <option value="Movement">Movement</option>
                        <option value="Prescience">Prescience</option>
                        <option value="Protection">Protection</option>
                    </select>
                </div>
                <input type="hidden" name="attr_alteration_substitution" value=0 />
                <div class="column width100 bold italic">For Tier II of Attribute Substituation</div>
				<div class="column width100 italic">In the ACTIONS SECTION(s), select the substituted attribute instead of Fortitude.</div>
            </div>
        </div>
      <!-- Creation -->
        <div class="row width100">
            <div class="width6 inlineBlock vertBottom"><input class="settings" type="checkbox" name="attr_creation_settings_flag" value="on" /><span>y</span></div>
            <input type="hidden" class="creation_display_sub_flag" name="attr_creation_display_sub_flag" value="hide" />
            <div class="column width39 inlineBlock textLeft textLarge bold italic attributeButton sub">
                <button type="roll" value="&{template:openLegend} {{title= Creation Roll}} {{subTitle= @{character_name}}} {{roll= @{creation_dice_roll}}}">Creation</button>
            </div>
            <div class="width55 inlineBlock">
                <div class="column width1of3 inlineBlock textCenter inputNumber"><input type="number" name="attr_creation_score" value=0 /></div>
                <div class="column width1of3 inlineBlock textCenter inputNumber"><input type="number" name="attr_show_creation_cost" value="@{creation_cost}" disabled="disabled" /></div>
                <input type="hidden" name="attr_creation_dice_roll" value=0 />     <!-- hidden value of the roll button string -->
                <div class="column width1of3 inlineBlock textCenter inputDice"><input type="text" style="text-align: center;" name="attr_creation_dice" value=0 /></div>
            </div>
            <input type="hidden" class="creation_display_settings_flag" name="attr_creation_display_settings_flag" value="hide" />
            <div class="width100 displaySettings padBottom">
                <div class="column width95 inlineBlock boxShadow textSmall">Channeling higher powers for healing, creation, resurrection, divine might, etc.</div>
                <div class="column width75 inlineBlock">Attribute Dice Bonus/Penalty:</div>
                <div class="column width25 inlineBlock inputNumber30"><input type="number" name="attr_creation_dice_modifier" value=0 /></div>
                <div class="column width75 inlineBlock">Increase/Decrease cost in levels:</div>
                <div class="column width25 inlineBlock inputNumber30"><input type="number" name="attr_creation_cost_modifier" value=0 /></div>
                <div class="column width60 inlineBlock">Your d20 (non-combat rolls):</div>
                <div class="column width40 inlineBlock inputSelect">
                    <select name="attr_creation_dice_d20">
                        <option value="1d20!!" selected="selected">Normal</option>
                        <option value="2d20!!kh1">Advantage</option>
                        <option value="2d20!!kl1">Disadvantage</option>
                    </select>
                </div>
                <div class="column width60 inlineBlock">Attribute Substitution:</div>
                <div class="column width40 inlineBlock inputSelect">
                    <select name="attr_creation_substitution_select">
                        <option value="None" selected="selected">None</option>
                        <option value="Agility">Agility</option>
                        <option value="Fortitude">Fortitude</option>
                        <option value="Might">Might</option>
                        <option value="Learning">Learning</option>
                        <option value="Logic">Logic</option>
                        <option value="Perception">Perception</option>
                        <option value="Will">Will</option>
                        <option value="Deception">Deception</option>
                        <option value="Persuasion">Persuasion</option>
                        <option value="Presence">Presence</option>
                        <option value="Alteration">Alteration</option>
                        <option value="Energy">Energy</option>
                        <option value="Entropy">Entropy</option>
                        <option value="Influence">Influence</option>
                        <option value="Movement">Movement</option>
                        <option value="Prescience">Prescience</option>
                        <option value="Protection">Protection</option>
                    </select>
                </div>
                <input type="hidden" name="attr_creation_substitution" value=0 />
                <div class="column width100 bold italic">For Tier II of Attribute Substituation</div>
				<div class="column width100 italic">In the ACTIONS SECTION(s), select the substituted attribute instead of Fortitude.</div>
            </div>
        </div>
      <!-- Energy -->
        <div class="row width100">
            <div class="width6 inlineBlock vertBottom"><input class="settings" type="checkbox" name="attr_energy_settings_flag" value="on" /><span>y</span></div>
            <input type="hidden" class="energy_display_sub_flag" name="attr_energy_display_sub_flag" value="hide" />
            <div class="column width39 inlineBlock textLeft textLarge bold italic attributeButton sub">
                <button type="roll" value="&{template:openLegend} {{title= Energy Roll}} {{subTitle= @{character_name}}} {{roll= @{energy_dice_roll}}}">Energy</button>
            </div>
            <div class="width55 inlineBlock">
                <div class="column width1of3 inlineBlock textCenter inputNumber"><input type="number" name="attr_energy_score" value=0 /></div>
                <div class="column width1of3 inlineBlock textCenter inputNumber"><input type="number" name="attr_show_energy_cost" value="@{energy_cost}" disabled="disabled" /></div>
                <input type="hidden" name="attr_energy_dice_roll" value=0 />     <!-- hidden value of the roll button string -->
                <div class="column width1of3 inlineBlock textCenter inputDice"><input type="text" style="text-align: center;" name="attr_energy_dice" value=0 /></div>
            </div>
            <input type="hidden" class="energy_display_settings_flag" name="attr_energy_display_settings_flag" value="hide" />
            <div class="width100 displaySettings padBottom">
                <div class="column width95 inlineBlock boxShadow textSmall">Create and control the elements–fire, cold, electricity, etc.</div>
                <div class="column width75 inlineBlock">Attribute Dice Bonus/Penalty:</div>
                <div class="column width25 inlineBlock inputNumber30"><input type="number" name="attr_energy_dice_modifier" value=0 /></div>
                <div class="column width75 inlineBlock">Increase/Decrease cost in levels:</div>
                <div class="column width25 inlineBlock inputNumber30"><input type="number" name="attr_energy_cost_modifier" value=0 /></div>
                <div class="column width60 inlineBlock">Your d20 (non-combat rolls):</div>
                <div class="column width40 inlineBlock inputSelect">
                    <select name="attr_energy_dice_d20">
                        <option value="1d20!!" selected="selected">Normal</option>
                        <option value="2d20!!kh1">Advantage</option>
                        <option value="2d20!!kl1">Disadvantage</option>
                    </select>
                </div>
                <div class="column width60 inlineBlock">Attribute Substitution:</div>
                <div class="column width40 inlineBlock inputSelect">
                    <select name="attr_energy_substitution_select">
                        <option value="None" selected="selected">None</option>
                        <option value="Agility">Agility</option>
                        <option value="Fortitude">Fortitude</option>
                        <option value="Might">Might</option>
                        <option value="Learning">Learning</option>
                        <option value="Logic">Logic</option>
                        <option value="Perception">Perception</option>
                        <option value="Will">Will</option>
                        <option value="Deception">Deception</option>
                        <option value="Persuasion">Persuasion</option>
                        <option value="Presence">Presence</option>
                        <option value="Alteration">Alteration</option>
                        <option value="Creation">Creation</option>
                        <option value="Entropy">Entropy</option>
                        <option value="Influence">Influence</option>
                        <option value="Movement">Movement</option>
                        <option value="Prescience">Prescience</option>
                        <option value="Protection">Protection</option>
                    </select>
                </div>
                <input type="hidden" name="attr_energy_substitution" value=0 />
                <div class="column width100 bold italic">For Tier II of Attribute Substituation</div>
				<div class="column width100 italic">In the ACTIONS SECTION(s), select the substituted attribute instead of Fortitude.</div>
            </div>
        </div>
      <!-- Entropy -->
        <div class="row width100">
            <div class="width6 inlineBlock vertBottom"><input class="settings" type="checkbox" name="attr_entropy_settings_flag" value="on" /><span>y</span></div>
            <input type="hidden" class="entropy_display_sub_flag" name="attr_entropy_display_sub_flag" value="hide" />
            <div class="column width39 inlineBlock textLeft textLarge bold italic attributeButton sub">
                <button type="roll" value="&{template:openLegend} {{title= Entropy Roll}} {{subTitle= @{character_name}}} {{roll= @{entropy_dice_roll}}}">Entropy</button>
            </div>
            <div class="width55 inlineBlock">
                <div class="column width1of3 inlineBlock textCenter inputNumber"><input type="number" name="attr_entropy_score" value=0 /></div>
                <div class="column width1of3 inlineBlock textCenter inputNumber"><input type="number" name="attr_show_entropy_cost" value="@{entropy_cost}" disabled="disabled" /></div>
                <input type="hidden" name="attr_entropy_dice_roll" value=0 />     <!-- hidden value of the roll button string -->
                <div class="column width1of3 inlineBlock textCenter inputDice"><input type="text" style="text-align: center;" name="attr_entropy_dice" value=0 /></div>
            </div>
            <input type="hidden" class="entropy_display_settings_flag" name="attr_entropy_display_settings_flag" value="hide" />
            <div class="width100 displaySettings padBottom">
                <div class="column width95 inlineBlock boxShadow textSmall">Disintegrate matter, kill with a word, create undead, sicken others</div>
                <div class="column width75 inlineBlock">Attribute Dice Bonus/Penalty:</div>
                <div class="column width25 inlineBlock inputNumber30"><input type="number" name="attr_entropy_dice_modifier" value=0 /></div>
                <div class="column width75 inlineBlock">Increase/Decrease cost in levels:</div>
                <div class="column width25 inlineBlock inputNumber30"><input type="number" name="attr_entropy_cost_modifier" value=0 /></div>
                <div class="column width60 inlineBlock">Your d20 (non-combat rolls):</div>
                <div class="column width40 inlineBlock inputSelect">
                    <select name="attr_entropy_dice_d20">
                        <option value="1d20!!" selected="selected">Normal</option>
                        <option value="2d20!!kh1">Advantage</option>
                        <option value="2d20!!kl1">Disadvantage</option>
                    </select>
                </div>
                <div class="column width60 inlineBlock">Attribute Substitution:</div>
                <div class="column width40 inlineBlock inputSelect">
                    <select name="attr_entropy_substitution_select">
                        <option value="None" selected="selected">None</option>
                        <option value="Agility">Agility</option>
                        <option value="Fortitude">Fortitude</option>
                        <option value="Might">Might</option>
                        <option value="Learning">Learning</option>
                        <option value="Logic">Logic</option>
                        <option value="Perception">Perception</option>
                        <option value="Will">Will</option>
                        <option value="Deception">Deception</option>
                        <option value="Persuasion">Persuasion</option>
                        <option value="Presence">Presence</option>
                        <option value="Alteration">Alteration</option>
                        <option value="Creation">Creation</option>
                        <option value="Energy">Energy</option>
                        <option value="Influence">Influence</option>
                        <option value="Movement">Movement</option>
                        <option value="Prescience">Prescience</option>
                        <option value="Protection">Protection</option>
                    </select>
                </div>
                <input type="hidden" name="attr_entropy_substitution" value=0 />
                <div class="column width100 bold italic">For Tier II of Attribute Substituation</div>
				<div class="column width100 italic">In the ACTIONS SECTION(s), select the substituted attribute instead of Fortitude.</div>
            </div>
        </div>
      <!-- Influence -->
        <div class="row width100">
            <div class="width6 inlineBlock vertBottom"><input class="settings" type="checkbox" name="attr_influence_settings_flag" value="on" /><span>y</span></div>
            <input type="hidden" class="influence_display_sub_flag" name="attr_influence_display_sub_flag" value="hide" />
            <div class="column width39 inlineBlock textLeft textLarge bold italic attributeButton sub">
                <button type="roll" value="&{template:openLegend} {{title= Influence Roll}} {{subTitle= @{character_name}}} {{roll= @{influence_dice_roll}}}">Influence</button>
            </div>
            <div class="width55 inlineBlock">
                <div class="column width1of3 inlineBlock textCenter inputNumber"><input type="number" name="attr_influence_score" value=0 /></div>
                <div class="column width1of3 inlineBlock textCenter inputNumber"><input type="number" name="attr_show_influence_cost" value="@{influence_cost}" disabled="disabled" /></div>
                <input type="hidden" name="attr_influence_dice_roll" value=0 />     <!-- hidden value of the roll button string -->
                <div class="column width1of3 inlineBlock textCenter inputDice"><input type="text" style="text-align: center;" name="attr_influence_dice" value=0 /></div>
            </div>
            <input type="hidden" class="influence_display_settings_flag" name="attr_influence_display_settings_flag" value="hide" />
            <div class="width100 displaySettings padBottom">
                <div class="column width95 inlineBlock boxShadow textSmall">Control the minds of others, speak telepathically, instill supernatural fear, create illusory figments, cloak with invisibility</div>
                <div class="column width75 inlineBlock">Attribute Dice Bonus/Penalty:</div>
                <div class="column width25 inlineBlock inputNumber30"><input type="number" name="attr_influence_dice_modifier" value=0 /></div>
                <div class="column width75 inlineBlock">Increase/Decrease cost in levels:</div>
                <div class="column width25 inlineBlock inputNumber30"><input type="number" name="attr_influence_cost_modifier" value=0 /></div>
                <div class="column width60 inlineBlock">Your d20 (non-combat rolls):</div>
                <div class="column width40 inlineBlock inputSelect">
                    <select name="attr_influence_dice_d20">
                        <option value="1d20!!" selected="selected">Normal</option>
                        <option value="2d20!!kh1">Advantage</option>
                        <option value="2d20!!kl1">Disadvantage</option>
                    </select>
                </div>
                <div class="column width60 inlineBlock">Attribute Substitution:</div>
                <div class="column width40 inlineBlock inputSelect">
                    <select name="attr_influence_substitution_select">
                        <option value="None" selected="selected">None</option>
                        <option value="Agility">Agility</option>
                        <option value="Fortitude">Fortitude</option>
                        <option value="Might">Might</option>
                        <option value="Learning">Learning</option>
                        <option value="Logic">Logic</option>
                        <option value="Perception">Perception</option>
                        <option value="Will">Will</option>
                        <option value="Deception">Deception</option>
                        <option value="Persuasion">Persuasion</option>
                        <option value="Presence">Presence</option>
                        <option value="Alteration">Alteration</option>
                        <option value="Creation">Creation</option>
                        <option value="Energy">Energy</option>
                        <option value="Entropy">Entropy</option>
                        <option value="Movement">Movement</option>
                        <option value="Prescience">Prescience</option>
                        <option value="Protection">Protection</option>
                    </select>
                </div>
                <input type="hidden" name="attr_influence_substitution" value=0 />
                <div class="column width100 bold italic">For Tier II of Attribute Substituation</div>
				<div class="column width100 italic">In the ACTIONS SECTION(s), select the substituted attribute instead of Fortitude.</div>
            </div>
        </div>
      <!-- Movement -->
        <div class="row width100">
            <div class="width6 inlineBlock vertBottom"><input class="settings" type="checkbox" name="attr_movement_settings_flag" value="on" /><span>y</span></div>
            <input type="hidden" class="movement_display_sub_flag" name="attr_movement_display_sub_flag" value="hide" />
            <div class="column width39 inlineBlock textLeft textLarge bold italic attributeButton sub">
                <button type="roll" value="&{template:openLegend} {{title= Movement Roll}} {{subTitle= @{character_name}}} {{roll= @{movement_dice_roll}}}">Movement</button>
            </div>
            <div class="width55 inlineBlock">
                <div class="column width1of3 inlineBlock textCenter inputNumber"><input type="number" name="attr_movement_score" value=0 /></div>
                <div class="column width1of3 inlineBlock textCenter inputNumber"><input type="number" name="attr_show_movement_cost" value="@{movement_cost}" disabled="disabled" /></div>
                <input type="hidden" name="attr_movement_dice_roll" value=0 />     <!-- hidden value of the roll button string -->
                <div class="column width1of3 inlineBlock textCenter inputDice"><input type="text" style="text-align: center;" name="attr_movement_dice" value=0 /></div>
            </div>
            <input type="hidden" class="movement_display_settings_flag" name="attr_movement_display_settings_flag" value="hide" />
            <div class="width100 displaySettings padBottom">
                <div class="column width95 inlineBlock boxShadow textSmall">Teleport, fly, hasten, slow</div>
                <div class="column width75 inlineBlock">Attribute Dice Bonus/Penalty:</div>
                <div class="column width25 inlineBlock inputNumber30"><input type="number" name="attr_movement_dice_modifier" value=0 /></div>
                <div class="column width75 inlineBlock">Increase/Decrease cost in levels:</div>
                <div class="column width25 inlineBlock inputNumber30"><input type="number" name="attr_movement_cost_modifier" value=0 /></div>
                <div class="column width60 inlineBlock">Your d20 (non-combat rolls):</div>
                <div class="column width40 inlineBlock inputSelect">
                    <select name="attr_movement_dice_d20">
                        <option value="1d20!!" selected="selected">Normal</option>
                        <option value="2d20!!kh1">Advantage</option>
                        <option value="2d20!!kl1">Disadvantage</option>
                    </select>
                </div>
                <div class="column width60 inlineBlock">Attribute Substitution:</div>
                <div class="column width40 inlineBlock inputSelect">
                    <select name="attr_movement_substitution_select">
                        <option value="None" selected="selected">None</option>
                        <option value="Agility">Agility</option>
                        <option value="Fortitude">Fortitude</option>
                        <option value="Might">Might</option>
                        <option value="Learning">Learning</option>
                        <option value="Logic">Logic</option>
                        <option value="Perception">Perception</option>
                        <option value="Will">Will</option>
                        <option value="Deception">Deception</option>
                        <option value="Persuasion">Persuasion</option>
                        <option value="Presence">Presence</option>
                        <option value="Alteration">Alteration</option>
                        <option value="Creation">Creation</option>
                        <option value="Energy">Energy</option>
                        <option value="Entropy">Entropy</option>
                        <option value="Influence">Influence</option>
                        <option value="Prescience">Prescience</option>
                        <option value="Protection">Protection</option>
                    </select>
                </div>
                <input type="hidden" name="attr_movement_substitution" value=0 />
                <div class="column width100 bold italic">For Tier II of Attribute Substituation</div>
				<div class="column width100 italic">In the ACTIONS SECTION(s), select the substituted attribute instead of Fortitude.</div>
            </div>
        </div>
      <!-- Prescience -->
        <div class="row width100">
            <div class="width6 inlineBlock vertBottom"><input class="settings" type="checkbox" name="attr_prescience_settings_flag" value="on" /><span>y</span></div>
            <input type="hidden" class="prescience_display_sub_flag" name="attr_prescience_display_sub_flag" value="hide" />
            <div class="column width39 inlineBlock textLeft textLarge bold italic attributeButton sub">
                <button type="roll" value="&{template:openLegend} {{title= Prescience Roll}} {{subTitle= @{character_name}}} {{roll= @{prescience_dice_roll}}}">Prescience</button>
            </div>
            <div class="width55 inlineBlock">
                <div class="column width1of3 inlineBlock textCenter inputNumber"><input type="number" name="attr_prescience_score" value=0 /></div>
                <div class="column width1of3 inlineBlock textCenter inputNumber"><input type="number" name="attr_show_prescience_cost" value="@{prescience_cost}" disabled="disabled" /></div>
                <input type="hidden" name="attr_prescience_dice_roll" value=0 />     <!-- hidden value of the roll button string -->
                <div class="column width1of3 inlineBlock textCenter inputDice"><input type="text" style="text-align: center;" name="attr_prescience_dice" value=0 /></div>
            </div>
            <input type="hidden" class="prescience_display_settings_flag" name="attr_prescience_display_settings_flag" value="hide" />
            <div class="width100 displaySettings padBottom">
                <div class="column width95 inlineBlock boxShadow textSmall">See the future, read minds or auras, detect magic or evil, scry, communicate with extraplanar entities</div>
                <div class="column width75 inlineBlock">Attribute Dice Bonus/Penalty:</div>
                <div class="column width25 inlineBlock inputNumber30"><input type="number" name="attr_prescience_dice_modifier" value=0 /></div>
                <div class="column width75 inlineBlock">Increase/Decrease cost in levels:</div>
                <div class="column width25 inlineBlock inputNumber30"><input type="number" name="attr_prescience_cost_modifier" value=0 /></div>
                <div class="column width60 inlineBlock">Your d20 (non-combat rolls):</div>
                <div class="column width40 inlineBlock inputSelect">
                    <select name="attr_prescience_dice_d20">
                        <option value="1d20!!" selected="selected">Normal</option>
                        <option value="2d20!!kh1">Advantage</option>
                        <option value="2d20!!kl1">Disadvantage</option>
                    </select>
                </div>
                <div class="column width60 inlineBlock">Attribute Substitution:</div>
                <div class="column width40 inlineBlock inputSelect">
                    <select name="attr_prescience_substitution_select">
                        <option value="None" selected="selected">None</option>
                        <option value="Agility">Agility</option>
                        <option value="Fortitude">Fortitude</option>
                        <option value="Might">Might</option>
                        <option value="Learning">Learning</option>
                        <option value="Logic">Logic</option>
                        <option value="Perception">Perception</option>
                        <option value="Will">Will</option>
                        <option value="Deception">Deception</option>
                        <option value="Persuasion">Persuasion</option>
                        <option value="Presence">Presence</option>
                        <option value="Alteration">Alteration</option>
                        <option value="Creation">Creation</option>
                        <option value="Energy">Energy</option>
                        <option value="Entropy">Entropy</option>
                        <option value="Influence">Influence</option>
                        <option value="Movement">Movement</option>
                        <option value="Protection">Protection</option>
                    </select>
                </div>
                <input type="hidden" name="attr_prescience_substitution" value=0 />
                <div class="column width100 bold italic">For Tier II of Attribute Substituation</div>
				<div class="column width100 italic">In the ACTIONS SECTION(s), select the substituted attribute instead of Fortitude.</div>
            </div>
        </div>
      <!-- Protection -->
        <div class="row width100">
            <div class="width6 inlineBlock vertBottom"><input class="settings" type="checkbox" name="attr_protection_settings_flag" value="on" /><span>y</span></div>
            <input type="hidden" class="protection_display_sub_flag" name="attr_protection_display_sub_flag" value="hide" />
            <div class="column width39 inlineBlock textLeft textLarge bold italic attributeButton sub">
                <button type="roll" value="&{template:openLegend} {{title= Protection Roll}} {{subTitle= @{character_name}}} {{roll= @{protection_dice_roll}}}">Protection</button>
            </div>
            <div class="width55 inlineBlock">
                <div class="column width1of3 inlineBlock textCenter inputNumber"><input type="number" name="attr_protection_score" value=0 /></div>
                <div class="column width1of3 inlineBlock textCenter inputNumber"><input type="number" name="attr_show_protection_cost" value="@{protection_cost}" disabled="disabled" /></div>
                <input type="hidden" name="attr_protection_dice_roll" value=0 />     <!-- hidden value of the roll button string -->
                <div class="column width1of3 inlineBlock textCenter inputDice"><input type="text" style="text-align: center;" name="attr_protection_dice" value=0 /></div>
            </div>
            <input type="hidden" class="protection_display_settings_flag" name="attr_protection_display_settings_flag" value="hide" />
            <div class="width100 displaySettings padBottom">
                <div class="column width95 inlineBlock boxShadow textSmall">Protect from damage, break supernatural influence, dispel magic, bind demons</div>
                <div class="column width75 inlineBlock">Attribute Dice Bonus/Penalty:</div>
                <div class="column width25 inlineBlock inputNumber30"><input type="number" name="attr_protection_dice_modifier" value=0 /></div>
                <div class="column width75 inlineBlock">Increase/Decrease cost in levels:</div>
                <div class="column width25 inlineBlock inputNumber30"><input type="number" name="attr_protection_cost_modifier" value=0 /></div>
                <div class="column width60 inlineBlock">Your d20 (non-combat rolls):</div>
                <div class="column width40 inlineBlock inputSelect">
                    <select name="attr_protection_dice_d20">
                        <option value="1d20!!" selected="selected">Normal</option>
                        <option value="2d20!!kh1">Advantage</option>
                        <option value="2d20!!kl1">Disadvantage</option>
                    </select>
                </div>
                <div class="column width60 inlineBlock">Attribute Substitution:</div>
                <div class="column width40 inlineBlock inputSelect">
                    <select name="attr_protection_substitution_select">
                        <option value="None" selected="selected">None</option>
                        <option value="Agility">Agility</option>
                        <option value="Fortitude">Fortitude</option>
                        <option value="Might">Might</option>
                        <option value="Learning">Learning</option>
                        <option value="Logic">Logic</option>
                        <option value="Perception">Perception</option>
                        <option value="Will">Will</option>
                        <option value="Deception">Deception</option>
                        <option value="Persuasion">Persuasion</option>
                        <option value="Presence">Presence</option>
                        <option value="Alteration">Alteration</option>
                        <option value="Creation">Creation</option>
                        <option value="Energy">Energy</option>
                        <option value="Entropy">Entropy</option>
                        <option value="Influence">Influence</option>
                        <option value="Movement">Movement</option>
                        <option value="Prescience">Prescience</option>
                    </select>
                </div>
                <input type="hidden" name="attr_protection_substitution" value=0 />
                <div class="column width100 bold italic">For Tier II of Attribute Substituation</div>
				<div class="column width100 italic">In the ACTIONS SECTION(s), select the substituted attribute instead of Fortitude.</div>
            </div>
        </div>
    <!-- end of EXTRAORDINARY attributes -->
    </div>
 <!-- end of left column for Attributes -->
<div class="twoThird inlineBlock">
 <!-- Middle column for defenses & actions -->
    <input type="hidden" class="display_defenses_flag" name="attr_display_defenses_flag" value="show" />
    <div class="third inlineBlock vertTop displayDefenses">
   <!-- Guard information -->
        <div class="width100 padAll">
            <div class="evasion vertTop padTop">
                <div class="inlineBlock vertTop padTop" style="width: 155px;">
                    <div class="column width100 textCenter resistButton">
                        <button type="roll" name="roll_resist_bane" value="&{template:openLegend} {{title= Resist Bane Roll}} {{subTitle= @{character_name}}} {{roll= [[1d20]]}} {{target= 10+ bane is removed}}">Guard</button>
                    </div>
                    <div class="column width100 inputNumberLarge padTop"><input type="number" name="attr_evasion" value=0 /></div>
                </div>
                <div class="inlineBlock vertTop" style="width: 120px;">
                    <div class="width100">
                        <div class="column width100 height5"></div>
						<input type="hidden" name="attr_agility_display" value=0 />
                        <div class="column width1of3 inputNumber30 inlineBlock"><input type="number" name="attr_show_agility_score" value="@{agility_display}" disabled="disabled" /></div>
                        <div class="column width2of3 italic bold textLarge textLeft inlineBlock">Agility</div>
						<input type="hidden" name="attr_might_display" value=0 />
                        <div class="column width1of3 inputNumber30 inlineBlock"><input type="number" name="attr_show_might_score" value="@{might_display}" disabled="disabled" /></div>
                        <div class="column width2of3 italic bold textLarge padTop textLeft inlineBlock">Might</div>
                        <div class="column width1of3 inputNumber30 inlineBlock"><input type="number" name="attr_armor" value=0 /></div>
                        <div class="column width2of3 italic bold textLarge padTop textLeft inlineBlock">Armor</div>
<!--                        <div class="column width1of3 inputNumber30 inlineBlock"><input type="number" name="attr_shield" value=0 /></div>
                        <div class="column width2of3 italic bold textLarge padTop textLeft inlineBlock">Shield</div>
-->
                        <div class="column width1of3 inputNumber30 inlineBlock"><input type="number" name="attr_evasion_other" value="0" /></div>
                        <div class="column width2of3 italic bold textLarge padTop textLeft inlineBlock">Other</div>
                    </div>
                </div>
            </div>
        </div>
   <!-- End Guard -->
   <!-- Toughness information -->
        <div class="width100 padAll">
            <div class="toughness vertTop padTop">
                <div class="inlineBlock vertTop padTop" style="width: 155px;">
                    <div class="column width100 textCenter resistButton">
                        <button type="roll" name="roll_resist_bane" value="&{template:openLegend} {{title= Resist Bane Roll}} {{subTitle= @{character_name}}} {{roll= [[1d20]]}} {{target= 10+ bane is removed}}">Toughness</button>
                    </div>
                    <div class="column width100 inputNumberLarge padTop"><input type="number" name="attr_toughness" value=0 /></div>
                </div>
                <div class="inlineBlock vertTop" style="width: 120px;">
                    <div class="width100 padTop">
						<input type="hidden" name="attr_fortitude_display" value=0 />
                        <div class="column width1of3 inputNumber30 inlineBlock"><input type="number" name="attr_show_fortitude_score" value="@{fortitude_display}" disabled="true" /></div>
                        <div class="column width2of3 italic bold textLarge textLeft inlineBlock padTop">Fortitude</div>
						<input type="hidden" name="attr_will_display" value=0 />
                        <div class="column width1of3 inputNumber30 inlineBlock"><input type="number" name="attr_show_will_score" value="@{will_display}" disabled="true" /></div>
                        <div class="column width2of3 italic bold textLarge textLeft inlineBlock padTop">Will</div>
                        <div class="column width1of3 inputNumber30 inlineBlock"><input type="number" name="attr_toughness_other" value="0" /></div>
                        <div class="column width2of3 italic bold textLarge textLeft inlineBlock padTop">Other</div>
                    </div>
                </div>
            </div>
        </div>
   <!-- end toughness -->
   <!-- Resolve information -->
        <div class="width100 padAll">
            <div class="resolve vertTop padTop">
                <div class="inlineBlock vertTop padTop" style="width: 155px;">
                    <div class="column width100 textCenter resistButton">
                        <button type="roll" name="roll_resist_bane" value="&{template:openLegend} {{title= Resist Bane Roll}} {{subTitle= @{character_name}}} {{roll= [[1d20]]}} {{target= 10+ bane is removed}}">Resolve</button>
                    </div>
                    <div class="column width100 inputNumberLarge padTop"><input type="number" name="attr_resolve" value=0 /></div>
                </div>
                <div class="inlineBlock vertTop" style="width: 120px;">
                    <div class="width100 padTop">
						<input type="hidden" name="attr_presence_display" value=0 />
                        <div class="column width1of3 inputNumber30 inlineBlock"><input type="number" name="attr_show_presence_score" value="@{presence_display}" disabled="true" /></div>
                        <div class="column width2of3 italic bold textLarge textLeft inlineBlock padTop">Presence</div>
                        <div class="column width1of3 inputNumber30 inlineBlock"><input type="number" name="attr_show_will_score" value="@{will_display}" disabled="true" /></div>
                        <div class="column width2of3 italic bold textLarge textLeft inlineBlock padTop">Will</div>
                        <div class="column width1of3 inputNumber30 inlineBlock"><input type="number" name="attr_resolve_other" value="0" /></div>
                        <div class="column width2of3 italic bold textLarge textLeft inlineBlock padTop">Other</div>
                    </div>
                </div>
            </div>
        </div>
   <!-- end Resolve -->
    </div>
 <!-- end Middle column for defenses & actions -->
    <input type="hidden" class="display_healthspeed_flag" name="attr_display_healthspeed_flag" value="show" />
    <div class="third inlineBlock vertTop displayHealthSpeed">
 <!-- Right column for Health, speed, wealth, feats, perks, and flaws -->
     <!-- Hit Points Section -->
        <div class="hitPoints padTop padBottom">
            <div class="width100 height25"></div>
            <div class="column width100 textLargest bold padTop">Hit Points</div>
            <div class="column width100 textSmall italic bold">Fortitude, Presence, & Will</div>
            <div class="width100">
                <div class="column width50 inlineBlock borderRight textLarge italic bold">Current</div>
                <div class="column width50 inlineBlock borderLeft textLarge italic bold">Max</div>
                <div class="column width50 inlineBlock borderRight inputNumberLarge"><input type="number" name="attr_hit_point" value=0 /></div>
                <div class="column width50 inlineBlock borderLeft inputNumberLarge"><input type="number" name="attr_hit_point_max" value=0 /></div>
                <div class="width25 inlineBlock"></div>
                <div class="column width30 inlineBlock bold">From Feats</div>
                <div class="column width10 inlineBlock inputNumber30"><input type="number" name="attr_hit_point_feats" value=0 /></div>
                <div class="width35 inlineBlock"></div>
                <div class="width25 inlineBlock"></div>
                <div class="column width30 inlineBlock bold">From Other</div>
                <div class="column width10 inlineBlock inputNumber30"><input type="number" name="attr_hit_point_other" value=0 /></div>
                <div class="width35 inlineBlock"></div>
            </div>
        </div>
     <!-- End Hit Points Section -->
        <input type="hidden" class="display_sanity_flag" name="attr_display_sanity_flag" value="hide" />
     <!-- Sanity -->
        <div class="third inlineBlock vertTop displaySanity">
         <!-- Sanity Points Section -->
            <div class="hitPoints padTop padBottom black">
                <div class="width100 height25"></div>
                <div class="column width100 textLargest bold padTop">Sanity Points</div>
                <div class="column width100 textSmall italic bold">Suggested: 2x(Logic + Presence + Will) + 40</div>
                <div class="width100">
                    <div class="column width50 inlineBlock borderRight textLarge italic bold">Current</div>
                    <div class="column width50 inlineBlock borderLeft textLarge italic bold">Max</div>
                    <div class="column width50 inlineBlock borderRight inputNumberLarge"><input type="number" name="attr_sanity_point" value=0 /></div>
                    <div class="column width50 inlineBlock borderLeft inputNumberLarge"><input type="number" name="attr_sanity_point_max" value=0 /></div>
                    <div class="column width90 inlineBlock bold">This is Homebrew;<br />NOT officially Core Rules</div>
                </div>
            </div>
         <!-- End Sanity Points Section -->
        </div>
     <!-- Legend Points & Speed Section -->
        <div class="speedLethalDamage">
            <div class="width50 inlineBlock vertTop">
                <div class="column width100 height5"></div>
                <input type="hidden" name="attr_agility_initiative" value=0 />
                <div class="column width100 textCenter textLarge speedButton"><button type="roll" name="roll_initiative" value="&{template:openLegend} {{title= Initiative Roll}} {{subTitle= @{character_name}}} {{subTitleAdd= Agility}} {{roll= @{agility_initiative}}} {{description= Make sure to you selected your token to have it automatically added to the turn order.}}">Speed</span></button></div>
                <div class="column width100 textCenter textSmall" style="line-height: 10px;">Click to roll Initiative</div>
                <div class="column width100 vertTop inputNumber30 textSmall bold">Base <input type="number" name="attr_base_speed" value=30 /></div>
                <div class="column width100 inputNumberLarge"><input type="number" name="attr_speed" value=0 /></div>
                <div class="width100 column inputNumber30 textSmall bold">Armor Penalty(ft) <input type="number" name="attr_armor_penalty" value=0 /></div>
                <div class="width100 column  inputNumber30 textSmall bold">Armor Feat(ft) <input type="number" name="attr_armor_training" value=0 /></div>
            </div>
            <div class="width50 inlineBlock vertTop">
                <div class="column width100 height10"></div>
                <div class="column width5 inlineBlock"></div>
                <div class="column width90 inlineBlock textCenter bold textLarge black">Lethal Damage</div>
                <div class="column width5 inlineBlock"></div>
                <div class="column width100" style="height: 29px;"></div>
                <div class="column width100 inlineBlock inputNumberLarge"><input type="number" name="attr_lethal_damage" value=0 /></div>
            </div>
        </div>
     <!-- End Legend Points & Speed Section -->
     <!-- Wealth Level Information -->
        <div class="column width100 textLargest bold padTop">Wealth Level</div>
        <div class="wealth">
            <div class="width100 height15"></div>
            <div class="column width100 inputNumber60 padTop"><input type="number" name="attr_wealth_level" value=2 /></div>
        </div>
     <!-- End Wealth Level Information -->
    </div>
    <input type="hidden" class="display_favoredactions_flag" name="attr_display_favoredactions_flag" value="show" />
    <div class="third inlineBlock vertTop displayFavoredActions">
   <!-- Actions Area -->
        <div class="actionsTop padTop padLeft">
            <div class="column width100 textLargest bold textShadow padTop">Favored Actions</div>
            <div class="column width100 italic marginTop">Attacks, Boons, & Banes</div>
        </div>
        <div class="actionsMiddle padTop padRight">
        <!-- Headings for the actions -->
            <div class="column width25 bold italic inlineBlock textCenter padLeft">Settings</div>
            <div class="column width75 bold italic inlineBlock textCenter">Name (click to roll)</div>
        <!-- Add actions as needed Section (repeating fields) -->
            <div class="column width100 vertTop padRight">
                <fieldset class="repeating_actions">
                    <div class="row">   <!-- Fix for Mozilla squishing +Add & Modify buttons -->
                        <div class="width15 inlineBlock vertTop padLeft"><input class="settings" type="checkbox" name="attr_settingsFlag" value="on" checked="checked" /><span>y</span></div>
                        <div class="width85 inlineBlock vertTop inputNameShort attributeButton teal"><button type="roll" name="roll_action" value="&{template:openLegend} {{title= @{action_name}}} {{subTitle= @{character_name}}} {{subTitleAdd= @{action_attribute}}} {{target= @{action_target}}} {{roll= @{dice_roll}}} {{powertarget=@{power_target}}} {{powerlevel= @{power_level}}} {{powertargetmax= @{power_target_max}}} {{powerlevelmax= @{power_level_max}}} {{description= @{action_special}}}"><input type="text" style="text-align: center;" name="attr_action_name" /></button></div>
                        <input type="hidden" class="displaySettingsFlag" name="attr_displaySettingsFlag" />
                        <div class="width100 displaySettings padLeft">
                            <div class="column width25 inlineBlock bold">Name: </div>
                            <div class="column width75 inlineBlock inputNameShort"><input type="text" name="attr_action_name" /></div>
                            <div class="column width45 inlineBlock bold textSmall">Attribute</div>
                            <div class="column width10 inlineBlock bold textSmall">vs</div>
                            <div class="column width45 inlineBlock bold textSmall">Target</div>
                            <div class="column width45 inlineBlock inputSelect">
                                <select name="attr_action_attribute">
                                    <option value="None" selected="selected">None</option>
                                    <option value="Agility">Agility</option>
                                    <option value="Fortitude">Fortitude</option>
                                    <option value="Might">Might</option>
                                    <option value="Deception">Deception</option>
                                    <option value="Presence">Presence</option>
                                    <option value="Persuasion">Persuasion</option>
                                    <option value="Learning">Learning</option>
                                    <option value="Logic">Logic</option>
                                    <option value="Perception">Perception</option>
                                    <option value="Will">Will</option>
                                    <option value="Alteration">Alteration</option>
                                    <option value="Creation">Creation</option>
                                    <option value="Energy">Energy</option>
                                    <option value="Entropy">Entropy</option>
                                    <option value="Influence">Influence</option>
                                    <option value="Movement">Movement</option>
                                    <option value="Prescience">Prescience</option>
                                    <option value="Protection">Protection</option>
                                </select>
                            </div>
                            <div class="column width10 inlineBlock bold italic textCenter">vs</div>
                            <div class="column width45 inlineBlock inputSelect">
                                <select name="attr_action_target">
                                    <option value="None" selected="selected">None</option>
                                    <option value="Guard">Guard</option>
                                    <option value="Toughness">Toughness</option>
                                    <option value="Resolve">Resolve</option>
                                </select>
                            </div>
                            <input type="hidden" name="attr_dice_roll" value=0 />
                            <div class="column width75 inlineBlock">Attribute Dice Bonus/Penalty:</div>
                            <div class="column width25 inlineBlock inputNumber30"><input type="number" name="attr_dice_modifier" value=0 /></div>
                            <div class="column width55 inlineBlock">d20 for this action is:</div>
                            <input type="hidden" name="attr_dice_d20" value="1d20!!" />
                            <div class="column width45 inlineBlock inputSelect">
                                <select name="attr_dice_d20">
                                    <option value="1d20!!" selected="selected">Normal</option>
                                    <option value="2d20!!kh1">Advantage</option>
                                    <option value="2d20!!kl1">Disadvantage</option>
                                </select>
                            </div>
                            <input type="hidden" name="attr_power_target" value="" />
                            <input type="hidden" name="attr_power_target_max" value=0 />
                            <div class="column width50 inlineBlock"></div>
                            <div class="column width25 inlineBlock textSmall bold">Minimum</div>
                            <div class="column width25 inlineBlock textSmall bold">Maximum</div>
                            <div class="column width50 inlineBlock"><input type="checkbox" class="checks25" name="attr_use_power_level" value="Yes" /> Use Power level</div>
                            <div class="column width25 inlineBlock inputNumber30"><input type="number" name="attr_power_level" value=0 /></div>
                            <div class="column width25 inlineBlock inputNumber30"><input type="number" name="attr_power_level_max" value=0 /></div>
                            <div class="column width100 bold textSmall">Description/Special/Flavor Text</div>
                            <div class="column width100 resizeVert vertTop"><textarea class="height50" name="attr_action_special"></textarea></div>
                        </div>
                    </div>
                </fieldset>
            </div>
        </div>
        <div class="actionsBottom"></div>
   <!-- End Actions Area -->
    </div>
    <input type="hidden" class="display_otheractions_flag" name="attr_display_otheractions_flag" value="show" />
    <div class="third inlineBlock vertTop displayOtherActions">
   <!-- Other Actions Area -->
        <div class="actionsTop padTop padLeft">
            <div class="column width100 textLargest bold textShadow padTop">Other Actions</div>
            <div class="column width100 italic marginTop">Attacks, Boons, & Banes</div>
        </div>
        <div class="actionsMiddle padTop padRight">
        <!-- Headings for the actions -->
            <div class="column width25 bold italic inlineBlock textCenter padLeft">Settings</div>
            <div class="column width75 bold italic inlineBlock textCenter">Name (click to roll)</div>
        <!-- Add actions as needed Section (repeating fields) -->
            <div class="column width100 vertTop padRight">
                <fieldset class="repeating_otheractions">
                    <div class="row">   <!-- Fix for Mozilla squishing +Add & Modify buttons -->
                        <div class="width15 inlineBlock vertTop padLeft"><input class="settings" type="checkbox" name="attr_settingsFlag" value="on" checked="checked" /><span>y</span></div>
                        <div class="width85 inlineBlock vertTop inputNameShort attributeButton teal"><button type="roll" name="roll_action_other" value="&{template:openLegend} {{title= @{action_name}}} {{subTitle= @{character_name}}} {{subTitleAdd= @{action_attribute}}} {{target= @{action_target}}} {{roll= @{dice_roll}}} {{powertarget=@{power_target}}} {{powerlevel= @{power_level}}} {{powertargetmax= @{power_target_max}}} {{description= @{action_special}}}"><input type="text" style="text-align: center;" name="attr_action_name" /></button></div>
                        <input type="hidden" class="displaySettingsFlag" name="attr_displaySettingsFlag" />
                        <div class="width100 displaySettings padLeft">
                            <div class="column width25 inlineBlock bold">Name: </div>
                            <div class="column width75 inlineBlock inputNameShort"><input type="text" name="attr_action_name" /></div>
                            <div class="column width45 inlineBlock bold textSmall">Attribute</div>
                            <div class="column width10 inlineBlock bold textSmall">vs</div>
                            <div class="column width45 inlineBlock bold textSmall">Target</div>
                            <div class="column width45 inlineBlock inputSelect">
                                <select name="attr_action_attribute">
                                    <option value="None" selected="selected">None</option>
                                    <option value="Agility">Agility</option>
                                    <option value="Fortitude">Fortitude</option>
                                    <option value="Might">Might</option>
                                    <option value="Deception">Deception</option>
                                    <option value="Presence">Presence</option>
                                    <option value="Persuasion">Persuasion</option>
                                    <option value="Learning">Learning</option>
                                    <option value="Logic">Logic</option>
                                    <option value="Perception">Perception</option>
                                    <option value="Will">Will</option>
                                    <option value="Alteration">Alteration</option>
                                    <option value="Creation">Creation</option>
                                    <option value="Energy">Energy</option>
                                    <option value="Entropy">Entropy</option>
                                    <option value="Influence">Influence</option>
                                    <option value="Movement">Movement</option>
                                    <option value="Prescience">Prescience</option>
                                    <option value="Protection">Protection</option>
                                </select>
                            </div>
                            <div class="column width10 inlineBlock bold italic textCenter">vs</div>
                            <div class="column width45 inlineBlock inputSelect">
                                <select name="attr_action_target">
                                    <option value="None" selected="selected">None</option>
                                    <option value="Guard">Guard</option>
                                    <option value="Toughness">Toughness</option>
                                    <option value="Resolve">Resolve</option>
                                </select>
                            </div>
                            <input type="hidden" name="attr_dice_roll" value=0 />
                            <div class="column width75 inlineBlock">Attribute Dice Bonus/Penalty:</div>
                            <div class="column width25 inlineBlock inputNumber30"><input type="number" name="attr_dice_modifier" value=0 /></div>
                            <div class="column width55 inlineBlock">d20 for this action is:</div>
                            <input type="hidden" name="attr_dice_d20" value="1d20!!" />
                            <div class="column width45 inlineBlock inputSelect">
                                <select name="attr_dice_d20">
                                    <option value="1d20!!" selected="selected">Normal</option>
                                    <option value="2d20!!kh1">Advantage</option>
                                    <option value="2d20!!kl1">Disadvantage</option>
                                </select>
                            </div>
                            <input type="hidden" name="attr_power_target" value="" />
                            <input type="hidden" name="attr_power_target_max" value=0 />
                            <div class="column width50 inlineBlock"></div>
                            <div class="column width25 inlineBlock textSmall bold">Minimum</div>
                            <div class="column width25 inlineBlock textSmall bold">Maximum</div>
                            <div class="column width50 inlineBlock"><input type="checkbox" class="checks25" name="attr_use_power_level" value="Yes" /> Use Power level</div>
                            <div class="column width25 inlineBlock inputNumber30"><input type="number" name="attr_power_level" value=0 /></div>
                            <div class="column width25 inlineBlock inputNumber30"><input type="number" name="attr_power_level_max" value=0 /></div>
                            <div class="column width100 bold textSmall">Description/Special/Flavor Text</div>
                            <div class="column width100 resizeVert vertTop"><textarea class="height50" name="attr_action_special"></textarea></div>
                        </div>
                    </div>
                </fieldset>
            </div>
        </div>
        <div class="actionsBottom"></div>
   <!-- End Other Actions Area -->
    </div>
    <input type="hidden" class="display_feats_flag" name="attr_display_feats_flag" value="show" />
    <div class="third inlineBlock vertTop displayFeats">
   <!-- Columns of Feats -->
        <div class="actionsTop padTop padLeft padRight">
            <div class="column width100 textCenter bold textLargest textShadow vertTop padTop">Feats</div>
       <!-- sub sections for feat points spent and total -->
            <div class="width50 inlineBlock vertTop padLeft">
                <div class="column width2of3 inlineBlock textRight bold italic">Total Points</div>
                <div class="column width1of3 inlineBlock inputNumber"><input type="number" name="attr_feat_total_points" value=0 /></div>
            </div>
            <div class="width50 inlineBlock vertTop padRight">
                <div class="column width2of3 inlineBlock textRight bold italic">Points Used</div>
                <input type="hidden" name="attr_featLeft_points_spent" value=0 />
                <input type="hidden" name="attr_featRight_points_spent" value=0 />
                <div class="column width1of3 inlineBlock inputNumber"><input type="number" name="attr_feat_points_spent" value="@{featLeft_points_spent}+@{featRight_points_spent}" disabled="disabled" /></div>
            </div>
        </div>
        <div class="actionsMiddle padTop padLeft padRight">
            <div class="column width50 inlineBlock vertTop padTop">
                <fieldset class="repeating_featsLeft">
                    <div class="row">   <!-- Fix for Mozilla squishing the +Add & Modify button text -->
                        <div class="width15 inlineBlock vertTop"><input class="settings" type="checkbox" name="attr_settingsFlag" value="on" checked="checked" /><span>y</span></div>
                        <div class="width85 inlineBlock vertTop inputNameShort attributeButton teal"><button type="roll" value="&{template:openLegend} {{title= @{feat_left_name}}} {{subTitle= @{character_name}}} {{subTitleAdd= Feat}} {{description= @{feat_left_description}}}"><input type="text" style="text-align: center;" name="attr_feat_left_name" /></button></div>
                        <input type="hidden" class="displaySettingsFlag" name="attr_displaySettingsFlag" />
                        <div class="width100 displaySettings">
                            <div class="column width75 inlineBlock bold textSmall">Name</div>
                            <div class="column width25 inlineBlock bold textSmall">Cost</div>
                            <div class="column width75 inlineBlock inputNameShort"><input type="text" name="attr_feat_left_name" /></div>
                            <div class="column width25 inlineBlock inputNumber30"><input type="number" name="attr_feat_left_cost" /></div>
                            <div class="column width100 bold textSmall">Description</div>
                            <div class="column width95 resizeVert vertTop"><textarea class="height50" name="attr_feat_left_description"></textarea></div>
                        </div>
                    </div>
                </fieldset>
            </div>
            <div class="column width50 inlineBlock vertTop padTop">
                <fieldset class="repeating_featsRight">
                    <div class="row">   <!-- Fix for Mozilla squishing the +Add & Modify button text -->
                        <div class="width15 inlineBlock vertTop"><input class="settings" type="checkbox" name="attr_settingsFlag" value="on" checked="checked" /><span>y</span></div>
                        <div class="width85 inlineBlock vertTop inputNameShort attributeButton teal"><button type="roll" value="&{template:openLegend} {{title= @{feat_right_name}}} {{subTitle= @{character_name}}} {{subTitleAdd= Feat}} {{description= @{feat_right_description}}}"><input type="text" style="text-align: center;" name="attr_feat_right_name" /></button></div>
                        <input type="hidden" class="displaySettingsFlag" name="attr_displaySettingsFlag" />
                        <div class="width100 displaySettings">
                            <div class="column width75 inlineBlock bold textSmall">Name</div>
                            <div class="column width25 inlineBlock bold textSmall">Cost</div>
                            <div class="column width75 inlineBlock inputNameShort"><input type="text" name="attr_feat_right_name" /></div>
                            <div class="column width25 inlineBlock inputNumber30"><input type="number" name="attr_feat_right_cost" /></div>
                            <div class="column width100 bold textSmall">Description</div>
                            <div class="column width95 resizeVert vertTop"><textarea class="height50" name="attr_feat_right_description"></textarea></div>
                        </div>
                    </div>
                </fieldset>
            </div>
   <!-- End Columns of Feats -->
        </div>
        <div class="actionsBottom"></div>
   <!-- End Feats, Perks, Flaws Area -->
    </div>
    <input type="hidden" class="display_perksflaws_flag" name="attr_display_perksflaws_flag" value="show" />
    <div class="third inlineBlock vertTop displayPerksFlaws">
   <!-- Columns of Feats -->
        <div class="actionsTop padTop padLeft padRight">
   <!-- Column for Perks -->
            <div class="column width100 textCenter bold textLargest textShadow vertTop padTop padBottom">Perks</div>
        </div>
        <div class="actionsMiddle padTop padLeft padRight">
            <div class="column width50 inlineBlock vertTop">
                <fieldset class="repeating_perks">
                    <div class="row">   <!-- Fix for Mozilla squishing the +Add & Modify button text -->
                        <div class="width15 inlineBlock vertTop"><input class="settings" type="checkbox" name="attr_settingsFlag" value="on" checked="checked" /><span>y</span></div>
                        <div class="width85 inlineBlock vertTop inputNameShort attributeButton teal"><button type="roll" value="&{template:openLegend} {{title= @{perks_name}}} {{subTitle= @{character_name}}} {{subTitleAdd= Perk}} {{description= @{perks_description}}}"><input type="text" style="text-align: center;" name="attr_perks_name" /></button></div>
                        <input type="hidden" class="displaySettingsFlag" name="attr_displaySettingsFlag" />
                        <div class="width100 displaySettings">
                            <div class="column width100 bold textSmall">Name</div>
                            <div class="column width100 inputNameShort"><input type="text" name="attr_perks_name" /></div>
                            <div class="column width100 bold textSmall">Description</div>
                            <div class="column width95 resizeVert vertTop"><textarea class="height50" name="attr_perks_description"></textarea></div>
                        </div>
                    </div>
                </fieldset>
            </div>
            <div class="column width50 inlineBlock vertTop">
                <fieldset class="repeating_perksRight">
                    <div class="row">   <!-- Fix for Mozilla squishing the +Add & Modify button text -->
                        <div class="width15 inlineBlock vertTop"><input class="settings" type="checkbox" name="attr_settingsFlag" value="on" checked="checked" /><span>y</span></div>
                        <div class="width85 inlineBlock vertTop inputNameShort attributeButton teal"><button type="roll" value="&{template:openLegend} {{title= @{perksRight_name}}} {{subTitle= @{character_name}}} {{subTitleAdd= Perk}} {{description= @{perksRight_description}}}"><input type="text" style="text-align: center;" name="attr_perksRight_name" /></button></div>
                        <input type="hidden" class="displaySettingsFlag" name="attr_displaySettingsFlag" />
                        <div class="width100 displaySettings">
                            <div class="column width100 bold textSmall">Name</div>
                            <div class="column width100 inputNameShort"><input type="text" name="attr_perksRight_name" /></div>
                            <div class="column width100 bold textSmall">Description</div>
                            <div class="column width95 resizeVert vertTop"><textarea class="height50" name="attr_perksRight_description"></textarea></div>
                        </div>
                    </div>
                </fieldset>
            </div>
   <!-- end Column for Perks -->
   <!-- Column for Flaws -->
            <div class="column width100 textCenter bold textLargest textShadow vertTop padTop padBottom">Flaws</div>
            <div class="column width50 inlineBlock vertTop">
                <fieldset class="repeating_flaws">
                    <div class="row">   <!-- Fix for Mozilla squishing the +Add & Modify button text -->
                        <div class="width15 inlineBlock vertTop"><input class="settings" type="checkbox" name="attr_settingsFlag" value="on" checked="checked" /><span>y</span></div>
                        <div class="width85 inlineBlock vertTop inputNameShort attributeButton teal"><button type="roll" value="&{template:openLegend} {{title= @{flaws_name}}} {{subTitle= @{character_name}}} {{subTitleAdd= Flaw}} {{description= @{flaws_description}}}"><input type="text" style="text-align: center;" name="attr_flaws_name" /></button></div>
                        <input type="hidden" class="displaySettingsFlag" name="attr_displaySettingsFlag" />
                        <div class="width100 displaySettings">
                            <div class="column width100 bold textSmall">Name</div>
                            <div class="column width100 inputNameShort"><input type="text" name="attr_flaws_name" /></div>
                            <div class="column width100 bold textSmall">Description</div>
                            <div class="column width95 resizeVert vertTop"><textarea class="height50" name="attr_flaws_description"></textarea></div>
                        </div>
                    </div>
                </fieldset>
            </div>
            <div class="column width50 inlineBlock vertTop">
                <fieldset class="repeating_flawsRight">
                    <div class="row">   <!-- Fix for Mozilla squishing the +Add & Modify button text -->
                        <div class="width15 inlineBlock vertTop"><input class="settings" type="checkbox" name="attr_settingsFlag" value="on" checked="checked" /><span>y</span></div>
                        <div class="width85 inlineBlock vertTop inputNameShort attributeButton teal"><button type="roll" value="&{template:openLegend} {{title= @{flawsRight_name}}} {{subTitle= @{character_name}}} {{subTitleAdd= Flaw}} {{description= @{flawsRight_description}}}"><input type="text" style="text-align: center;" name="attr_flawsRight_name" /></button></div>
                        <input type="hidden" class="displaySettingsFlag" name="attr_displaySettingsFlag" />
                        <div class="width100 displaySettings">
                            <div class="column width100 bold textSmall">Name</div>
                            <div class="column width100 inputNameShort"><input type="text" name="attr_flawsRight_name" /></div>
                            <div class="column width100 bold textSmall">Description</div>
                            <div class="column width95 resizeVert vertTop"><textarea class="height50" name="attr_flawsRight_description"></textarea></div>
                        </div>
                    </div>
                </fieldset>
            </div>
   <!-- end Column for Flaws -->
        </div>
        <div class="actionsBottom"></div>
   <!-- End Feats, Perks, Flaws Area -->
    </div>
</div>
 <!-- end Right column for Health, speed, wealth, feats, perks, and flaws -->
 <!-- Equipment section -->
  <input type="hidden" class="display_inventory_flag" name="attr_display_inventory_flag" value="show" />
  <div class="row inlineBlock displayInventory"
   <!-- container 1st column of items -->
    <div class="fifth inlineBlock vertTop">
        <div class="equipmentTop"></div>
        <div class="equipmentMiddle padLeft padRight">
      <!-- Item 1 -->
            <div class="column width100 bold textLarge">Item 1</div>
            <div class="column width100 inputName marginBottom"><input type="text" name="attr_item_1" /></div>
            <div class="column width25 inlineBlock textSmall bold">Heavy</div>
            <div class="column width25 inlineBlock"><input type="checkbox" class="checks25" name="attr_item_1_heavy" value="heavy" /></div>
            <div class="column width25 inlineBlock textSmall bold">Bulky</div>
            <div class="column width25 inlineBlock"><input type="checkbox" class="checks25" name="attr_item_1_bulky" value="bulky" /></div>
            <div class="column width100 bold textSmall">More/Descriptions</div>
            <div class="column width100 vertTop">
                <fieldset class="repeating_items24">
                    <div class="width100 resizeVert vertTop"><textarea class="height25" name="attr_item_1_additional"></textarea></div>
                </fieldset>
            </div>
      <!-- Item 6 -->
          <div class="silver">
            <div class="column width100 bold textLarge">Item 6</div>
            <div class="column width100 inputName marginBottom"><input type="text" name="attr_item_6" /></div>
            <div class="column width25 inlineBlock textSmall bold">Heavy</div>
            <div class="column width25 inlineBlock"><input type="checkbox" class="checks25" name="attr_item_6_heavy" value="heavy" /></div>
            <div class="column width25 inlineBlock textSmall bold">Bulky</div>
            <div class="column width25 inlineBlock"><input type="checkbox" class="checks25" name="attr_item_6_bulky" value="bulky" /></div>
            <div class="column width100 bold textSmall">More/Descriptions</div>
            <div class="column width100 vertTop">
                <fieldset class="repeating_items24">
                    <div class="width100 resizeVert vertTop"><textarea class="height25" name="attr_item_6_additional"></textarea></div>
                </fieldset>
            </div>
          </div>
      <!-- Item 11 -->
            <div class="column width100 bold textLarge">Item 11</div>
            <div class="column width100 inputName marginBottom"><input type="text" name="attr_item_11" /></div>
            <div class="column width25 inlineBlock textSmall bold">Heavy</div>
            <div class="column width25 inlineBlock"><input type="checkbox" class="checks25" name="attr_item_11_heavy" value="heavy" /></div>
            <div class="column width25 inlineBlock textSmall bold">Bulky</div>
            <div class="column width25 inlineBlock"><input type="checkbox" class="checks25" name="attr_item_11_bulky" value="bulky" /></div>
            <div class="column width100 bold textSmall">More/Descriptions</div>
            <div class="column width100 vertTop">
                <fieldset class="repeating_items24">
                    <div class="width100 resizeVert vertTop"><textarea class="height25" name="attr_item_11_additional"></textarea></div>
                </fieldset>
            </div>
      <!-- Item 16 -->
          <div class="silver">
            <div class="column width100 bold textLarge">Item 16</div>
            <div class="column width100 inputName marginBottom"><input type="text" name="attr_item_16" /></div>
            <div class="column width25 inlineBlock textSmall bold">Heavy</div>
            <div class="column width25 inlineBlock"><input type="checkbox" class="checks25" name="attr_item_16_heavy" value="heavy" /></div>
            <div class="column width25 inlineBlock textSmall bold">Bulky</div>
            <div class="column width25 inlineBlock"><input type="checkbox" class="checks25" name="attr_item_16_bulky" value="bulky" /></div>
            <div class="column width100 bold textSmall">More/Descriptions</div>
            <div class="column width100 vertTop">
                <fieldset class="repeating_items24">
                    <div class="width100 resizeVert vertTop"><textarea class="height25" name="attr_item_16_additional"></textarea></div>
                </fieldset>
            </div>
          </div>
        </div>
        <div class="equipmentBottom"></div>
    </div>
  <!-- end 1st column of equipment -->
   <!-- container 2nd column of items -->
    <div class="fifth inlineBlock vertTop">
        <div class="equipmentTop"></div>
        <div class="equipmentMiddle padLeft padRight">
      <!-- Item 1 -->
          <div class="silver">
            <div class="column width100 bold textLarge">Item 2</div>
            <div class="column width100 inputName marginBottom"><input type="text" name="attr_item_2" /></div>
            <div class="column width25 inlineBlock textSmall bold">Heavy</div>
            <div class="column width25 inlineBlock"><input type="checkbox" class="checks25" name="attr_item_2_heavy" value="heavy" /></div>
            <div class="column width25 inlineBlock textSmall bold">Bulky</div>
            <div class="column width25 inlineBlock"><input type="checkbox" class="checks25" name="attr_item_2_bulky" value="bulky" /></div>
            <div class="column width100 bold textSmall">More/Descriptions</div>
            <div class="column width100 vertTop">
                <fieldset class="repeating_items24">
                    <div class="width100 resizeVert vertTop"><textarea class="height25" name="attr_item_2_additional"></textarea></div>
                </fieldset>
            </div>
          </div>
      <!-- Item 6 -->
            <div class="column width100 bold textLarge">Item 7</div>
            <div class="column width100 inputName marginBottom"><input type="text" name="attr_item_7" /></div>
            <div class="column width25 inlineBlock textSmall bold">Heavy</div>
            <div class="column width25 inlineBlock"><input type="checkbox" class="checks25" name="attr_item_7_heavy" value="heavy" /></div>
            <div class="column width25 inlineBlock textSmall bold">Bulky</div>
            <div class="column width25 inlineBlock"><input type="checkbox" class="checks25" name="attr_item_7_bulky" value="bulky" /></div>
            <div class="column width100 bold textSmall">More/Descriptions</div>
            <div class="column width100 vertTop">
                <fieldset class="repeating_items24">
                    <div class="width100 resizeVert vertTop"><textarea class="height25" name="attr_item_7_additional"></textarea></div>
                </fieldset>
            </div>
      <!-- Item 11 -->
          <div class="silver">
            <div class="column width100 bold textLarge">Item 12</div>
            <div class="column width100 inputName marginBottom"><input type="text" name="attr_item_12" /></div>
            <div class="column width25 inlineBlock textSmall bold">Heavy</div>
            <div class="column width25 inlineBlock"><input type="checkbox" class="checks25" name="attr_item_12_heavy" value="heavy" /></div>
            <div class="column width25 inlineBlock textSmall bold">Bulky</div>
            <div class="column width25 inlineBlock"><input type="checkbox" class="checks25" name="attr_item_12_bulky" value="bulky" /></div>
            <div class="column width100 bold textSmall">More/Descriptions</div>
            <div class="column width100 vertTop">
                <fieldset class="repeating_items24">
                    <div class="width100 resizeVert vertTop"><textarea class="height25" name="attr_item_12_additional"></textarea></div>
                </fieldset>
            </div>
          </div>
      <!-- Item 16 -->
            <div class="column width100 bold textLarge">Item 17</div>
            <div class="column width100 inputName marginBottom"><input type="text" name="attr_item_17" /></div>
            <div class="column width25 inlineBlock textSmall bold">Heavy</div>
            <div class="column width25 inlineBlock"><input type="checkbox" class="checks25" name="attr_item_17_heavy" value="heavy" /></div>
            <div class="column width25 inlineBlock textSmall bold">Bulky</div>
            <div class="column width25 inlineBlock"><input type="checkbox" class="checks25" name="attr_item_17_bulky" value="bulky" /></div>
            <div class="column width100 bold textSmall">More/Descriptions</div>
            <div class="column width100 vertTop">
                <fieldset class="repeating_items24">
                    <div class="width100 resizeVert vertTop"><textarea class="height25" name="attr_item_17_additional"></textarea></div>
                </fieldset>
            </div>
        </div>
        <div class="equipmentBottom"></div>
    </div>
  <!-- end 2nd column of equipment -->
   <!-- container 3rd column of items -->
    <div class="fifth inlineBlock vertTop">
        <div class="equipmentTop"></div>
        <div class="equipmentMiddle padLeft padRight">
      <!-- Item 1 -->
            <div class="column width100 bold textLarge">Item 3</div>
            <div class="column width100 inputName marginBottom"><input type="text" name="attr_item_3" /></div>
            <div class="column width25 inlineBlock textSmall bold">Heavy</div>
            <div class="column width25 inlineBlock"><input type="checkbox" class="checks25" name="attr_item_3_heavy" value="heavy" /></div>
            <div class="column width25 inlineBlock textSmall bold">Bulky</div>
            <div class="column width25 inlineBlock"><input type="checkbox" class="checks25" name="attr_item_3_bulky" value="bulky" /></div>
            <div class="column width100 bold textSmall">More/Descriptions</div>
            <div class="column width100 vertTop">
                <fieldset class="repeating_items24">
                    <div class="width100 resizeVert vertTop"><textarea class="height25" name="attr_item_3_additional"></textarea></div>
                </fieldset>
            </div>
      <!-- Item 6 -->
          <div class="silver">
            <div class="column width100 bold textLarge">Item 8</div>
            <div class="column width100 inputName marginBottom"><input type="text" name="attr_item_8" /></div>
            <div class="column width25 inlineBlock textSmall bold">Heavy</div>
            <div class="column width25 inlineBlock"><input type="checkbox" class="checks25" name="attr_item_8_heavy" value="heavy" /></div>
            <div class="column width25 inlineBlock textSmall bold">Bulky</div>
            <div class="column width25 inlineBlock"><input type="checkbox" class="checks25" name="attr_item_8_bulky" value="bulky" /></div>
            <div class="column width100 bold textSmall">More/Descriptions</div>
            <div class="column width100 vertTop">
                <fieldset class="repeating_items24">
                    <div class="width100 resizeVert vertTop"><textarea class="height25" name="attr_item_8_additional"></textarea></div>
                </fieldset>
            </div>
          </div>
      <!-- Item 11 -->
            <div class="column width100 bold textLarge">Item 13</div>
            <div class="column width100 inputName marginBottom"><input type="text" name="attr_item_13" /></div>
            <div class="column width25 inlineBlock textSmall bold">Heavy</div>
            <div class="column width25 inlineBlock"><input type="checkbox" class="checks25" name="attr_item_13_heavy" value="heavy" /></div>
            <div class="column width25 inlineBlock textSmall bold">Bulky</div>
            <div class="column width25 inlineBlock"><input type="checkbox" class="checks25" name="attr_item_13_bulky" value="bulky" /></div>
            <div class="column width100 bold textSmall">More/Descriptions</div>
            <div class="column width100 vertTop">
                <fieldset class="repeating_items24">
                    <div class="width100 resizeVert vertTop"><textarea class="height25" name="attr_item_13_additional"></textarea></div>
                </fieldset>
            </div>
      <!-- Item 16 -->
          <div class="silver">
            <div class="column width100 bold textLarge">Item 18</div>
            <div class="column width100 inputName marginBottom"><input type="text" name="attr_item_18" /></div>
            <div class="column width25 inlineBlock textSmall bold">Heavy</div>
            <div class="column width25 inlineBlock"><input type="checkbox" class="checks25" name="attr_item_18_heavy" value="heavy" /></div>
            <div class="column width25 inlineBlock textSmall bold">Bulky</div>
            <div class="column width25 inlineBlock"><input type="checkbox" class="checks25" name="attr_item_18_bulky" value="bulky" /></div>
            <div class="column width100 bold textSmall">More/Descriptions</div>
            <div class="column width100 vertTop">
                <fieldset class="repeating_items24">
                    <div class="width100 resizeVert vertTop"><textarea class="height25" name="attr_item_18_additional"></textarea></div>
                </fieldset>
            </div>
          </div>
        </div>
        <div class="equipmentBottom"></div>
    </div>
  <!-- end 3rd column of equipment -->
   <!-- container 4th column of items -->
    <div class="fifth inlineBlock vertTop">
        <div class="equipmentTop"></div>
        <div class="equipmentMiddle padLeft padRight">
      <!-- Item 1 -->
          <div class="silver">
            <div class="column width100 bold textLarge">Item 4</div>
            <div class="column width100 inputName marginBottom"><input type="text" name="attr_item_4" /></div>
            <div class="column width25 inlineBlock textSmall bold">Heavy</div>
            <div class="column width25 inlineBlock"><input type="checkbox" class="checks25" name="attr_item_4_heavy" value="heavy" /></div>
            <div class="column width25 inlineBlock textSmall bold">Bulky</div>
            <div class="column width25 inlineBlock"><input type="checkbox" class="checks25" name="attr_item_4_bulky" value="bulky" /></div>
            <div class="column width100 bold textSmall">More/Descriptions</div>
            <div class="column width100 vertTop">
                <fieldset class="repeating_items24">
                    <div class="width100 resizeVert vertTop"><textarea class="height25" name="attr_item_4_additional"></textarea></div>
                </fieldset>
            </div>
          </div>
      <!-- Item 6 -->
            <div class="column width100 bold textLarge">Item 9</div>
            <div class="column width100 inputName marginBottom"><input type="text" name="attr_item_9" /></div>
            <div class="column width25 inlineBlock textSmall bold">Heavy</div>
            <div class="column width25 inlineBlock"><input type="checkbox" class="checks25" name="attr_item_9_heavy" value="heavy" /></div>
            <div class="column width25 inlineBlock textSmall bold">Bulky</div>
            <div class="column width25 inlineBlock"><input type="checkbox" class="checks25" name="attr_item_9_bulky" value="bulky" /></div>
            <div class="column width100 bold textSmall">More/Descriptions</div>
            <div class="column width100 vertTop">
                <fieldset class="repeating_items24">
                    <div class="width100 resizeVert vertTop"><textarea class="height25" name="attr_item_9_additional"></textarea></div>
                </fieldset>
            </div>
      <!-- Item 11 -->
          <div class="silver">
            <div class="column width100 bold textLarge">Item 14</div>
            <div class="column width100 inputName marginBottom"><input type="text" name="attr_item_14" /></div>
            <div class="column width25 inlineBlock textSmall bold">Heavy</div>
            <div class="column width25 inlineBlock"><input type="checkbox" class="checks25" name="attr_item_14_heavy" value="heavy" /></div>
            <div class="column width25 inlineBlock textSmall bold">Bulky</div>
            <div class="column width25 inlineBlock"><input type="checkbox" class="checks25" name="attr_item_14_bulky" value="bulky" /></div>
            <div class="column width100 bold textSmall">More/Descriptions</div>
            <div class="column width100 vertTop">
                <fieldset class="repeating_items24">
                    <div class="width100 resizeVert vertTop"><textarea class="height25" name="attr_item_14_additional"></textarea></div>
                </fieldset>
            </div>
          </div>
      <!-- Item 16 -->
            <div class="column width100 bold textLarge">Item 19</div>
            <div class="column width100 inputName marginBottom"><input type="text" name="attr_item_19" /></div>
            <div class="column width25 inlineBlock textSmall bold">Heavy</div>
            <div class="column width25 inlineBlock"><input type="checkbox" class="checks25" name="attr_item_19_heavy" value="heavy" /></div>
            <div class="column width25 inlineBlock textSmall bold">Bulky</div>
            <div class="column width25 inlineBlock"><input type="checkbox" class="checks25" name="attr_item_19_bulky" value="bulky" /></div>
            <div class="column width100 bold textSmall">More/Descriptions</div>
            <div class="column width100 vertTop">
                <fieldset class="repeating_items24">
                    <div class="width100 resizeVert vertTop"><textarea class="height25" name="attr_item_19_additional"></textarea></div>
                </fieldset>
            </div>
        </div>
        <div class="equipmentBottom"></div>
    </div>
  <!-- end 4th column of equipment -->
   <!-- container 5th column of items -->
    <div class="fifth inlineBlock vertTop">
        <div class="equipmentTop"></div>
        <div class="equipmentMiddle padLeft padRight">
      <!-- Item 1 -->
            <div class="column width100 bold textLarge">Item 5</div>
            <div class="column width100 inputName marginBottom"><input type="text" name="attr_item_5" /></div>
            <div class="column width25 inlineBlock textSmall bold">Heavy</div>
            <div class="column width25 inlineBlock"><input type="checkbox" class="checks25" name="attr_item_5_heavy" value="heavy" /></div>
            <div class="column width25 inlineBlock textSmall bold">Bulky</div>
            <div class="column width25 inlineBlock"><input type="checkbox" class="checks25" name="attr_item_5_bulky" value="bulky" /></div>
            <div class="column width100 bold textSmall">More/Descriptions</div>
            <div class="column width100 vertTop">
                <fieldset class="repeating_items24">
                    <div class="width100 resizeVert vertTop"><textarea class="height25" name="attr_item_5_additional"></textarea></div>
                </fieldset>
            </div>
      <!-- Item 6 -->
          <div class="silver">
            <div class="column width100 bold textLarge">Item 10</div>
            <div class="column width100 inputName marginBottom"><input type="text" name="attr_item_10" /></div>
            <div class="column width25 inlineBlock textSmall bold">Heavy</div>
            <div class="column width25 inlineBlock"><input type="checkbox" class="checks25" name="attr_item_10_heavy" value="heavy" /></div>
            <div class="column width25 inlineBlock textSmall bold">Bulky</div>
            <div class="column width25 inlineBlock"><input type="checkbox" class="checks25" name="attr_item_10_bulky" value="bulky" /></div>
            <div class="column width100 bold textSmall">More/Descriptions</div>
            <div class="column width100 vertTop">
                <fieldset class="repeating_items24">
                    <div class="width100 resizeVert vertTop"><textarea class="height25" name="attr_item_10_additional"></textarea></div>
                </fieldset>
            </div>
          </div>
      <!-- Item 11 -->
            <div class="column width100 bold textLarge">Item 15</div>
            <div class="column width100 inputName marginBottom"><input type="text" name="attr_item_15" /></div>
            <div class="column width25 inlineBlock textSmall bold">Heavy</div>
            <div class="column width25 inlineBlock"><input type="checkbox" class="checks25" name="attr_item_15_heavy" value="heavy" /></div>
            <div class="column width25 inlineBlock textSmall bold">Bulky</div>
            <div class="column width25 inlineBlock"><input type="checkbox" class="checks25" name="attr_item_15_bulky" value="bulky" /></div>
            <div class="column width100 bold textSmall">More/Descriptions</div>
            <div class="column width100 vertTop">
                <fieldset class="repeating_items24">
                    <div class="width100 resizeVert vertTop"><textarea class="height25" name="attr_item_15_additional"></textarea></div>
                </fieldset>
            </div>
      <!-- Item 16 -->
          <div class="silver">
            <div class="column width100 bold textLarge">Item 20</div>
            <div class="column width100 inputName marginBottom"><input type="text" name="attr_item_20" /></div>
            <div class="column width25 inlineBlock textSmall bold">Heavy</div>
            <div class="column width25 inlineBlock"><input type="checkbox" class="checks25" name="attr_item_20_heavy" value="heavy" /></div>
            <div class="column width25 inlineBlock textSmall bold">Bulky</div>
            <div class="column width25 inlineBlock"><input type="checkbox" class="checks25" name="attr_item_20_bulky" value="bulky" /></div>
            <div class="column width100 bold textSmall">More/Descriptions</div>
            <div class="column width100 vertTop">
                <fieldset class="repeating_items24">
                    <div class="width100 resizeVert vertTop"><textarea class="height25" name="attr_item_20_additional"></textarea></div>
                </fieldset>
            </div>
          </div>
        </div>
        <div class="equipmentBottom"></div>
    </div>
  </div>
  <!-- end 5th column of equipment -->
<!-- end Equipment section -->
 <!-- section for Other Inventory & Notes information -->
    <input type="hidden" class="display_otherinventory_flag" name="attr_display_otherinventory_flag" value="hide" />
    <div class="row width825 marginBottom displayOtherInventory">
        <div class="column bold textLarge">Non-Essential Inventory or Notes</div>
       <!-- Other Area -->
        <div class="inlineBlock third vertTop">
    		<fieldset class="repeating_OtherOne">
    			<div class="actionsTop padTop">
    			<!-- Headings for the actions -->
    				<div class="column width100 bold italic textCenter">Title or Name</div>
    				<div class="column width100 textCenter padLeft inputName"><input type="text" name="attr_other_title" /></div>
    			</div>
    			<div class="actionsMiddle padLeft">
    			<!-- Add actions as needed Section (repeating fields) -->
    				<div class="column width100 bold italic textCenter">Content/Description</div>
                    <div class="column width90 resizeVert vertTop padLeft"><textarea class="height100" name="attr_other_contents"></textarea></div>
    			</div>
    			<div class="actionsBottom"></div>
    		</fieldset>
    	</div>
       <!-- End Other Area -->
       <!-- Other Area -->
        <div class="inlineBlock third vertTop">
    		<fieldset class="repeating_OtherTwo">
    			<div class="actionsTop padTop">
    			<!-- Headings for the actions -->
    				<div class="column width100 bold italic textCenter">Title or Name</div>
    				<div class="column width100 textCenter padLeft inputName"><input type="text" name="attr_other_title" /></div>
    			</div>
    			<div class="actionsMiddle padLeft">
    			<!-- Add actions as needed Section (repeating fields) -->
    				<div class="column width100 bold italic textCenter">Content/Description</div>
                    <div class="column width90 resizeVert vertTop padLeft"><textarea class="height100" name="attr_other_contents"></textarea></div>
    			</div>
    			<div class="actionsBottom"></div>
    		</fieldset>
    	</div>
       <!-- End Other Area -->
       <!-- Other Area -->
        <div class="inlineBlock third vertTop">
    		<fieldset class="repeating_OtherThree">
    			<div class="actionsTop padTop">
    			<!-- Headings for the actions -->
    				<div class="column width100 bold italic textCenter">Title or Name</div>
    				<div class="column width100 textCenter padLeft inputName"><input type="text" name="attr_other_title" /></div>
    			</div>
    			<div class="actionsMiddle padLeft">
    			<!-- Add actions as needed Section (repeating fields) -->
    				<div class="column width100 bold italic textCenter">Content/Description</div>
                    <div class="column width90 resizeVert vertTop padLeft"><textarea class="height100" name="attr_other_contents"></textarea></div>
    			</div>
    			<div class="actionsBottom"></div>
    		</fieldset>
    	</div>
       <!-- End Other Area -->
    </div>
 <!-- end section for Other Inventory & Notes information -->
</div>
<!-- End Main body of Character Sheet -->
<!-- Roll Templates Area -->
<rolltemplate class="sheet-rolltemplate-openLegend">
  <!-- Top of scroll graphic -->
    <div class="rollTop"></div>
  <!-- Middle of scroll graphic -->
    <div class="rollMiddle padLeft padRight">
      <!-- Display the title given -->
        <div class="row padBottom">
            <div class="column width100 textCenter textLarger bolder">{{title}}</div>
          <!-- Display any sub title given -->
            {{#subTitle}}
            <div class="column width100 textCenter textLarge italic">{{subTitle}}{{#subTitleAdd}} &bullet; {{subTitleAdd}}{{/subTitleAdd}}</div>
            {{/subTitle}}
          <!-- Display any sub title given -->
            {{#subTitle2}}
            <div class="column width100 textCenter textLarge italic">{{subTitle2}}{{#subTitle2Add}} &bullet; {{subTitle2Add}}{{/subTitle2Add}}</div>
            {{/subTitle2}}
          <!-- Display any sub title given -->
            {{#subTitle2}}
            <div class="column width100 textCenter textLarge italic">{{subTitle2}}{{#subTitle2Add}} &bullet; {{subTitle2Add}}{{/subTitle2Add}}</div>
            {{/subTitle2}}
        </div>
      <!-- Display emote if provided -->
        {{#emote}}
        <div class="row">
            <div class="column width95 inlineBlock textCenter borderAllDotted borderRound">{{emote}}</div>
        </div>
        {{/emote}}
      <!-- Display target plus the roll if target given -->
        {{#target}}
        <div class="row">
            <div class="column textCenter width30 inlineBlock">{{roll}}</div>
            <div class="column textCenter width10 inlineBlock">vs</div>
            <div class="column textCenter width60 inlineBlock bold">{{target}}</div>
        </div>
        {{/target}}
      <!-- Display just the roll if no target given -->
        {{^target}}{{#roll}}
        <div class="row">
            <div class="column textCenter width30 inlineBlock">{{roll}}</div>
            <div class="column textCenter width65 inlineBlock">Total Roll</div>
        </div>
        {{/roll}}{{/target}}
      <!-- Display power level if provided -->
        {{#powertarget}}
        <div class="row textCenter">
            {{#rollLess() roll powertarget}}
            <div class="column width90 inlineBlock red textLarge bold">Success with Twist<br />or Failure</div>
            {{/rollLess() roll powertarget}}
            {{#^rollLess() roll powertarget}}
            <div class="column width90 inlineBlock green textLarge bold">Success</div>
            {{/^rollLess() roll powertarget}}
            <div class="column width55 inlineBlock textCenter bold borderRight">Challenge Rating</div>
            <div class="column width40 inlineBlock textCenter bold">Power Level</div>
            <div class="column width15 inlineBlock textCenter bold textSmall">Min</div>
            <div class="column width40 inlineBlock textCenter borderRight">{{powertarget}}</div>
            <div class="column width40 inlineBlock textCenter">{{powerlevel}}</div>
            <div class="column width15 inlineBlock textCenter bold textSmall">Max</div>
            <div class="column width40 inlineBlock textCenter borderRight">{{powertargetmax}}</div>
            <div class="column width40 inlineBlock textCenter">{{powerlevelmax}}</div>
        </div>
        {{/powertarget}}
      <!-- Display description if provided -->
        {{#description}}
        <div class="row">
            <div class="column width100 textCenter bold borderBottom">Description/Flavor Text</div>
            <div class="column width100 textCenter">{{description}}</div>
        </div>
        {{/description}}
    </div>
  <!-- Bottom of scroll graphic -->
    <div class="rollBottom"></div>
</rolltemplate>
<!-- End Roll Templates Area -->